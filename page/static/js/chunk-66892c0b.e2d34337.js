(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-66892c0b"],{"07ac":function(t,e,o){var r=o("23e7"),a=o("6f53").values;r({target:"Object",stat:!0},{values:function(t){return a(t)}})},"17af":function(t,e,o){},"2c46":function(t,e,o){t.exports=o.p+"static/img/delete.76702a3e.svg"},"35fe":function(t,e,o){t.exports=o.p+"static/img/next.b23c6a6a.svg"},"40e1":function(t,e,o){"use strict";o("17af")},"51c7":function(t,e,o){t.exports=o.p+"static/img/check.6779301a.svg"},"5c04":function(t,e,o){"use strict";o("fa5a")},"6f53":function(t,e,o){var r=o("83ab"),a=o("df75"),i=o("fc6a"),n=o("d1e7").f,s=function(t){return function(e){var o,s=i(e),c=a(s),l=c.length,u=0,d=[];while(l>u)o=c[u++],r&&!n.call(s,o)||d.push(t?[o,s[o]]:s[o]);return d}};t.exports={entries:s(!0),values:s(!1)}},"8f82":function(t,e,o){"use strict";o.r(e);var r=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"FlowChart"}},[r("DialogFrom"),r("el-row",[r("el-col",{attrs:{span:24}},[r("div",{staticClass:"header-btn"},[r("el-button",{on:{click:t.goBack}},[t._v("返回")]),r("h3",[t._v(t._s("项目名:"+t.curItemVuex.name))]),r("el-button-group",[r("el-button",{on:{click:t.importProject}},[t._v("导出数据")]),r("el-button",{on:{click:t.isShow}},[t._v("项目基本信息")])],1)],1)])],1),r("el-row",{attrs:{type:"flex",justify:"start"}},[r("el-col",[r("div",{staticClass:"left-node"},[r("div",{attrs:{id:"stencil"}})])]),r("el-col",[r("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isControlGraphVuex,expression:"isControlGraphVuex"}],staticClass:"mid-work",staticStyle:{display:"flex"},attrs:{"element-loading-text":"节点参数填写有误","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.5)"}},[r("div",{staticClass:"edit-tools",attrs:{id:"tools-box"},on:{click:t.dragToolsBox}},[r("img",{staticClass:"tool-item",attrs:{src:o("c9a6")},on:{click:t.preStep}}),r("img",{staticClass:"tool-item",attrs:{src:o("35fe")},on:{click:t.nextStep}}),r("img",{staticClass:"tool-item",attrs:{src:o("a7c8")},on:{click:t.clearGraph}}),r("img",{staticClass:"tool-item",attrs:{src:o("f3f4")},on:{click:t.resetView}}),r("img",{staticClass:"tool-item",attrs:{src:o("2c46")},on:{click:t.delCell}}),r("img",{staticClass:"tool-item",attrs:{src:o("51c7")},on:{click:t.saveProject}})]),r("div",{staticClass:"main",attrs:{id:"container"}},[t._v("可拖动组件")])])]),r("el-col",[r("div",{staticClass:"right-param"},[r("div",{staticClass:"right-param-title"},[t._v("项目配置")]),r("div",{staticClass:"right-param-form"},[r("el-form",{ref:"form",attrs:{model:t.project_structure.running_config,"label-width":"80px"}},[r("el-form-item",{staticStyle:{"padding-right":"10px"},attrs:{label:"初始模块"}},[r("el-select",{attrs:{placeholder:"请选择",size:"small",disabled:t.isInitalModel},model:{value:t.project_structure.running_config.initial_module,callback:function(e){t.$set(t.project_structure.running_config,"initial_module",e)},expression:"project_structure.running_config.initial_module"}},t._l(t.graphNodes,(function(t){return r("el-option",{key:t.value,attrs:{label:t.attrs.label.textWrap.text,value:t.attrs.label.textWrap.text}})})),1)],1),r("el-form-item",{staticStyle:{"padding-right":"10px"},attrs:{label:"入口函数"}},[r("el-select",{attrs:{placeholder:"请选择",size:"small",disabled:t.isInitalFunction},model:{value:t.project_structure.running_config.initial_function,callback:function(e){t.$set(t.project_structure.running_config,"initial_function",e)},expression:"project_structure.running_config.initial_function"}},t._l(t.initial_function,(function(t){return r("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1)],1)],1),r("div",{staticClass:"right-param-title"},[t._v("参数配置")]),r("ParamList",{attrs:{noCurNodes:t.noCurNodes}})],1)])],1)],1)},a=[],i=o("5530"),n=(o("4de4"),o("b0c0"),o("b64b"),o("159b"),o("99af"),o("d81d"),o("bf19"),o("07ac"),o("d3b7"),o("3ca3"),o("ddb0"),o("5728")),s=(o("3e2f"),function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("el-form",{ref:"formName",attrs:{model:t.currentNodeData,rules:t.rules,"label-width":"100px",disabled:t.isdisabled}},t._l(t.nodeParams,(function(e,r){return o("el-form-item",{key:r+e.name,staticStyle:{"padding-right":"10px"},attrs:{prop:"local_name"===e.name?e.name:"other",label:e.name}},[o("el-autocomplete",{staticClass:"inline-input",attrs:{type:"textarea",autosize:{minRows:1,maxRows:4},size:"mini",placeholder:"请输入","fetch-suggestions":function(t,o){o(e.tips)}},on:{select:t.handleSelect},model:{value:t.currentNodeData[e["name"]],callback:function(o){t.$set(t.currentNodeData,e["name"],o)},expression:"currentNodeData[item['name']]"}})],1)})),1)],1)}),c=[],l=(o("c740"),{props:{noCurNodes:{default:function(){return[]}}},data:function(){var t=this.checkLocalName,e=this.checkOther;return{nodeParamsList:{default:[{name:"模型名称",value:"",trigger:"noShow",key:"modelName",tips:[{value:"100",otherData:{}},{value:"1000",otherData:{}},{value:"10000",otherData:{}}]},{name:"迭代次数",value:"",key:"iterationNumber",tips:[{value:"100",otherData:{}},{value:"1000",otherData:{}},{value:"10000",otherData:{}}]},{name:"批次大小",key:"pc",value:"",tips:[{value:"100",otherData:{}},{value:"1000",otherData:{}},{value:"10000",otherData:{}}]},{name:"初始模块",value:"",key:"mk",tips:[{value:"模型1",otherData:{}},{value:"模型2",otherData:{}},{value:"模型3",otherData:{}}]},{name:"入口函数",value:"",key:"rk",tips:[{value:"入口函数1",otherData:{}},{value:"入口函数2",otherData:{}},{value:"入口函数3",otherData:{}}]}]},rules:{local_name:[{validator:t,trigger:["change","blur"]}],other:[{validator:e,trigger:["change","blur"]}]},currentNodeData:{}}},computed:{nodeParams:function(){return this.$store.state.FlowChart.paramList.params},nodeDataVuex:function(){return this.$store.state.FlowChart.paramList.nodeData},isdisabled:function(){return this.$store.state.FlowChart.paramList.isdisabled}},watch:{nodeParams:{handler:function(t){var e={};this.currentNodeData={},t.forEach((function(t){e[t["name"]]=t.value})),this.currentNodeData=Object(i["a"])({},e)},deep:!0}},methods:{handleSelect:function(){console.log("ss")},checkLocalName:function(t,e,o){var r=this;if(!e)return o(new Error("参数不能为空"));console.log(this.noCurNodes),console.log(this.currentNodeData.local_name),setTimeout((function(){-1!==r.noCurNodes.findIndex((function(t){return t.data.local_name===r.currentNodeData.local_name}))?(r.$store.commit("FlowChart/setParamList",{key:"isControlGraph",value:!0}),o(new Error("名字已存在"))):(r.$store.commit("FlowChart/setParamList",{key:"isControlGraph",value:!1}),console.log(r.currentNodeData),r.$store.commit("FlowChart/setParamList",{key:"nodeData",value:Object(i["a"])({},r.currentNodeData)}),o())}),500)},checkOther:function(t,e,o){console.log(t),console.log(e);var r=Object.values(this.currentNodeData).every((function(t){return t}));return r?(this.$store.commit("FlowChart/setParamList",{key:"isControlGraph",value:!1}),console.log(this.currentNodeData),this.$store.commit("FlowChart/setParamList",{key:"nodeData",value:Object(i["a"])({},this.currentNodeData)}),o()):(this.$store.commit("FlowChart/setParamList",{key:"isControlGraph",value:!0}),o(new Error("参数不能为空")))}}}),u=l,d=(o("40e1"),o("2877")),m=Object(d["a"])(u,s,c,!1,null,"2cf51a2b",null),h=m.exports,g=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-Dialog",{attrs:{title:"项目信息",visible:t.dialogFormVisible,"close-on-click-modal":!1,"before-close":t.DialogClose},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[o("div",[o("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"100px"}},[o("el-form-item",{attrs:{label:"方案编号",prop:"project_id"}},[o("el-input",{attrs:{disabled:!0},model:{value:t.ruleForm.project_id,callback:function(e){t.$set(t.ruleForm,"project_id",e)},expression:"ruleForm.project_id"}})],1),o("el-form-item",{attrs:{label:"方案名称",prop:"project_name"}},[o("el-input",{model:{value:t.ruleForm.project_name,callback:function(e){t.$set(t.ruleForm,"project_name",e)},expression:"ruleForm.project_name"}})],1),o("el-form-item",{attrs:{label:"版本备注",prop:"project_desc"}},[o("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4}},model:{value:t.ruleForm.project_desc,callback:function(e){t.$set(t.ruleForm,"project_desc",e)},expression:"ruleForm.project_desc"}})],1),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("ruleForm")}}},[t._v("确定")]),o("el-button",{on:{click:function(e){return t.resetForm("ruleForm")}}},[t._v("取消")])],1)],1)],1)])},f=[],p={data:function(){return{dialogFormVisible:!1,ruleForm:{project_id:7,project_name:"",project_desc:""},rules:{project_name:[{required:!0,message:"请输入方案名称",trigger:"blur"},{min:3,max:90,message:"长度在 3 到 90 个字符",trigger:"blur"}],region:[{required:!0,message:"请选择算法类型",trigger:"change"}],type:[{type:"array",required:!0,message:"请至少选择一个活动性质",trigger:"change"}],resource:[{required:!0,message:"请选择创建方式",trigger:"change"}],project_desc:[{required:!0,message:"请填写版本备注",trigger:"blur"}],inherit:[{required:!0,message:"请选择继承方案",trigger:"change"}]}}},computed:{formVisibleVuex:function(){return this.$store.state.FlowChart.dialogFrom.dialogFormVisible},projectBasicInfoVuex:function(){return this.$store.state.FlowChart.dialogFrom.projectBasicInfo}},watch:{formVisibleVuex:function(t){this.dialogFormVisible=t},projectBasicInfoVuex:function(t){this.ruleForm=Object(i["a"])({},t)}},methods:{submitForm:function(t){var e=this,o=this;this.$refs[t].validate((function(r){if(!r)return console.log("error submit!!"),!1;o.$store.commit("FlowChart/setDialogFrom",{key:"projectBasicInfo",value:Object(i["a"])({},o.ruleForm)}),o.$store.commit("FlowChart/setDialogFrom",{key:"dialogFormVisible",value:!1}),e.$refs[t].resetFields()}))},resetForm:function(){this.$store.commit("FlowChart/setDialogFrom",{key:"dialogFormVisible",value:!1})},DialogClose:function(){this.$store.commit("FlowChart/setDialogFrom",{key:"dialogFormVisible",value:!1})}},created:function(){console.log("dialogFrom")},beforeDestroy:function(){console.log("dialogFrom,beforeDestroy ")}},b=p,v=Object(d["a"])(b,g,f,!1,null,"4225654d",null),_=v.exports,y={components:{ParamList:h,DialogFrom:_},data:function(){return{graph:"",curNode:"",curParams:"",stencil:"",graphNodes:[],project_structure:{running_config:{initial_module:"",initial_function:""},graph_config:[{position:{x:700,y:160},size:{width:80,height:34.285714285714285},attrs:{label:{text:"classifer_mnist_2"}},shape:"Classifier",ports:{groups:{top:{position:"top",attrs:{circle:{r:4,magnet:!0,stroke:"#5F95FF",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}}},right:{position:"right",attrs:{circle:{r:4,magnet:!0,stroke:"#5F95FF",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}}},bottom:{position:"bottom",attrs:{circle:{r:4,magnet:!0,stroke:"#5F95FF",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}}},left:{position:"left",attrs:{circle:{r:4,magnet:!0,stroke:"#5F95FF",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}}}},items:[{group:"top",id:"bd7a41e4-fc63-496b-9d5b-6bd2b3f09dbd"},{group:"right",id:"9ae12c09-2fdf-4bc9-8ee4-be3d9e196339"},{group:"bottom",id:"0d634f71-9db0-48b0-bfb8-6cedf89ab9fb"},{group:"left",id:"bd547318-939b-4536-8e3c-9fab96da6466"}]},id:"b0b95b26-b25e-4959-906d-b9342c8d5744",data:{name2:"MNIST_Classifier",layer:"3",learning_rate:"0.01",name:"classifer_mnist",local_name:"classifer_mnist_2"},zIndex:1}]},project_basic_info:{project_id:40,project_name:"功能测试",project_desc:"用来测试功能"},value:"",mapMsg:{},itemMsg:{counter:1,running_config:{initial_module:"picture_feature_extractor",initial_function:"train"},graph_config:[]},dialogFormVisible:!1,colorList:["#fc5c65","#fd9644","#fed330","#26de81","#2bcbba","#45aaf2","#4b6584","#d1d8e0","#b8e994","#60a3bc","#4a69bd","#f8c291"],shapeList:["polygon","circle","rect"],nodeShape:[{inherit:"polygon",width:70,height:30,attrs:{body:{fill:"#fc5c65",stroke:"#e77c8e",strokeWidth:1,refPoints:"5,0 50,0 45,20 0,20"},label:{color:"#262626",fontSize:10,textAnchor:"middle",textWrap:{text:"",width:-20,height:"90%",ellipsis:!0,breakWord:!0}}},ports:{}},{inherit:"rect",width:70,height:30,attrs:{body:{fill:"#fc5c65",stroke:"#e77c8e",strokeWidth:1,rx:20,ry:26},label:{color:"#262626",fontSize:10,textAnchor:"middle",textWrap:{text:"",width:-10,height:"90%",ellipsis:!0,breakWord:!0}}},ports:{}},{inherit:"rect",width:70,height:30,attrs:{body:{fill:"#fc5c65",stroke:"#e77c8e",strokeWidth:1},label:{color:"#262626",fontSize:10,textAnchor:"middle",textWrap:{text:"",width:-10,height:"90%",ellipsis:!0,breakWord:!0}}},ports:{}}],isChangeCurrentProject:!1}},computed:{nodeData:function(){return this.$store.state.FlowChart.paramList.nodeData},initial_function:function(){var t=this,e=this.graphNodes.filter((function(e){return e.attrs.label.textWrap.text===t.project_structure.running_config.initial_module}))[0];if(e&&e.data["name"]){var o=e["shape"],r=e.data["name"];return this.mapMsg[o].filter((function(t){return t.name===r}))[0]["module_config"]["api"]}return[]},isInitalModel:function(){return this.graphNodes.length<=0},isInitalFunction:function(){return""===this.project_structure.running_config.initial_module},projectBasicInfoVuex:function(){return this.$store.state.FlowChart.dialogFrom.projectBasicInfo},noCurNodes:function(){var t=this;return this.graphNodes.filter((function(e){return t.curNode&&t.curNode.data.local_name!==e.data.local_name}))},isControlGraphVuex:function(){return this.$store.state.FlowChart.paramList.isControlGraph},curItemVuex:function(){return this.$store.state.projectManage.resultList.curItem},projectConfig:function(){return this.project_structure.running_config}},watch:{nodeData:{handler:function(t){this.curNode&&(this.curNode.setAttrs({label:{textWrap:{text:t["local_name"]}}}),this.curNode.setData(t))},deep:!0},projectConfig:{handler:function(){console.log("监听到改变了+++"),this.isChangeCurrentProject=!0},deep:!0},projectBasicInfoVuex:{handler:function(t){this.project_basic_info=Object(i["a"])({},t)}},graph_config:{handler:function(){this.graph.fromJSON(this.project_structure.graph_config)},deep:!0},curItemVuex:{handler:function(t){this.project_basic_info.project_id=t.id,this.project_basic_info.project_desc=t.desc,this.project_basic_info.project_name=t.name},deep:!0,immediate:!0}},methods:{setGraph:function(){var t=new n["c"]({container:document.getElementById("container"),width:"100%",height:"100%",autoResize:!0,background:{color:"white"},grid:{size:10,visible:!0},panning:{enabled:!0},selecting:{enabled:!0,rubberband:!0,showNodeSelectionBox:!0,showEdgeSelectionBox:!0,modifiers:"shift"},history:!0,mousewheel:{enabled:!0,zoomAtMousePosition:!0,modifiers:"ctrl",minScale:.5,maxScale:3},connecting:{router:{name:"manhattan",args:{padding:1}},connector:{name:"rounded",args:{radius:8}},anchor:"center",connectionPoint:"anchor",allowBlank:!1,snap:{radius:20},createEdge:function(){return new n["j"].Edge({attrs:{line:{stroke:"#A2B1C3",strokeWidth:2,targetMarker:{name:"block",width:12,height:8}}},zIndex:0})},validateConnection:function(t){var e=t.targetMagnet;return!!e}},highlighting:{magnetAdsorbed:{name:"stroke",args:{attrs:{fill:"#5F95FF",stroke:"#5F95FF"}}}},resizing:{enabled:!0,minWidth:20,minHeight:10,maxWidth:500,maxHeight:500,orthogonal:!0,restricted:!1,autoScroll:!0,preserveAspectRatio:!1,allowReverse:!0},rotating:!0,snapline:!0,keyboard:!0,clipboard:!0});this.graph=t},setNode:function(){var t=this,e=this.graph,o=this.mapMsg,r={groups:{top:{position:"top",attrs:{circle:{r:4,magnet:!0,stroke:"#5F95FF",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}}},right:{position:"right",attrs:{circle:{r:4,magnet:!0,stroke:"#5F95FF",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}}},bottom:{position:"bottom",attrs:{circle:{r:4,magnet:!0,stroke:"#5F95FF",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}}},left:{position:"left",attrs:{circle:{r:4,magnet:!0,stroke:"#5F95FF",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}}}},items:[{group:"top"},{group:"right"},{group:"bottom"},{group:"left"}]},a=Object.keys(o),s=[],c={},l=this.colorList,u=this.colorList.length;a.forEach((function(a,d){var m=o[a].length;s.push({title:a,name:a,graphHeight:60*Math.ceil(m/2)||130,layoutOptions:{rowHeight:55}}),c[a]=[];var h=JSON.parse(JSON.stringify(t.nodeShape[d]));h.ports=Object(i["a"])({},r),h.attrs.label.text=a,n["c"].registerNode(a,h,!0),o[a].forEach((function(t,o){var r={},n=t["module_config"]["parameters"];Object.keys(n).forEach((function(t){var e=n[t];Array.isArray(e)&&e.length>0?r[t]=e[0]:r[t]=e})),r["name"]=t["name"],r["local_name"]=t["name"];var s=e.createNode({shape:a,attrs:{body:{fill:l[o%u]},label:{textWrap:{text:t.name}}},data:Object(i["a"])({},r)});c[a].push(s)}))}));var d=new n["a"].Stencil({title:"模块组件",target:e,stencilGraphWidth:240,stencilGraphHeight:350,collapsable:!0,groups:s,layoutOptions:{columns:2,columnWidth:100,rowHeight:60,resizeToFit:!0}});this.stencil=d,document.getElementById("stencil").appendChild(d.container),Object.keys(c).forEach((function(t){d.load(c[t],t)}))},setKeyEvent:function(){var t=this.graph;t.bindKey(["meta+c","ctrl+c"],(function(){var e=t.getSelectedCells();return e.length&&t.copy(e),!1})),t.bindKey(["meta+x","ctrl+x"],(function(){var e=t.getSelectedCells();return e.length&&t.cut(e),!1})),t.bindKey(["meta+v","ctrl+v"],(function(){if(!t.isClipboardEmpty()){var e=t.paste({offset:32});t.cleanSelection(),t.select(e)}return!1})),t.bindKey(["meta+z","ctrl+z"],(function(){return t.history.canUndo()&&t.history.undo(),!1})),t.bindKey(["meta+shift+z","ctrl+shift+z"],(function(){return t.history.canRedo()&&t.history.redo(),!1})),t.bindKey(["meta+a","ctrl+a"],(function(){var e=t.getNodes();e&&t.select(e)})),t.bindKey("backspace",(function(){var e=t.getSelectedCells();e.length&&t.removeCells(e)})),t.bindKey(["ctrl+1","meta+1"],(function(){var e=t.zoom();e<1.5&&t.zoom(.1)})),t.bindKey(["ctrl+2","meta+2"],(function(){var e=t.zoom();e>.5&&t.zoom(-.1)}));var e=function(t,e){for(var o=0,r=t.length;o<r;o+=1)t[o].style.visibility=e?"visible":"hidden"};t.on("node:mouseenter",(function(){var t=document.getElementById("container"),o=t.querySelectorAll(".x6-port-body");e(o,!0)})),t.on("node:mouseleave",(function(){var t=document.getElementById("container"),o=t.querySelectorAll(".x6-port-body");e(o,!1)}))},setNodeData:function(){var t=this,e=this,o=this.graph;o.on("graph:mouseleave",(function(){t.graphNodes=t.graph.getNodes()})),o.on("cell:click",(function(){e.$store.commit("FlowChart/setParamList",{key:"isdisabled",value:!1})})),o.on("cell:removed",(function(o){var r=o.cell;e.isChangeCurrentProject=!0,t.curNode.id===r.id&&(t.$store.commit("FlowChart/setParamList",{key:"isControlGraph",value:!1}),t.curNode="",t.$store.commit("FlowChart/setParamList",{key:"params",value:[]}),t.$store.commit("FlowChart/setParamList",{key:"nodeData",value:{}}))})),o.on("cell:change:*",(function(){e.isChangeCurrentProject=!0,console.log("监听到改变了")})),o.on("node:added",(function(t){var o=t.node,r=o.data["local_name"];e.itemMsg.counter+=1;var a="".concat(r,"_").concat(e.itemMsg.counter);o.setAttrs({label:{textWrap:{text:a}}}),o.setData({local_name:a})})),o.on("node:click",(function(o){var r=o.node;e.curNode=r;var a=r.data["name"],n=t.mapMsg[r["shape"]].filter((function(t){return t.name===a}))[0]["module_config"]["parameters"];n["local_name"]=r.data["local_name"];var s=[];Object.keys(n).forEach((function(t){var e={name:t};Array.isArray(n[t])?(e.value=r.data[t],e.tips=n[t].map((function(t){return{value:t}}))):(e.value=r.data[t],e.tips=[{value:n[t]}]),s.push(e)})),t.$store.commit("FlowChart/setParamList",{key:"params",value:[].concat(s)}),t.$store.commit("FlowChart/setParamList",{key:"nodeData",value:Object(i["a"])({},r.data)})})),o.on("node:removed",(function(o){var r=o.node,a=r.data["local_name"],i=e.project_structure.running_config.initial_module;i==a&&(e.project_structure.running_config.initial_module="",e.project_structure.running_config.initial_function="",t.$message({type:"error",message:"初始模块已经被删除,请重新选择初始模块"})),e.$store.commit("FlowChart/setParamList",{key:"isdisabled",value:!0})})),o.on("edge:click",(function(r){var a=r.edge;e.curNode=a;var i=o.getCellById(a.target.cell),n=i.data["name"],s=i.shape,c=t.mapMsg[s].filter((function(t){return t.name===n}))[0]["module_config"]["link_func"];if(Array.isArray(c)){var l=c.map((function(t){return{value:t}})),u=[{name:"link_func",value:a.data.link_func,tips:l}];t.$store.commit("FlowChart/setParamList",{key:"params",value:u})}})),o.on("edge:added",(function(t){var e=t.edge;e.setData({link_func:""})})),o.on("edge:connected",(function(e){var o=e.edge,r=e.currentCell;console.log(r);var a=r,i=a.data["name"],n=a.shape,s=t.mapMsg[n].filter((function(t){return t.name===i}))[0]["module_config"]["link_func"];Array.isArray(s)&&o.setData({link_func:s[0]})})),o.on("blank:click",(function(){e.curNode="",e.$store.commit("FlowChart/setParamList",{key:"isdisabled",value:!0})}))},saveProject:function(){var t=this,e=this.graph.toJSON().cells;this.project_structure.graph_config=e,this.project_structure.counter=this.itemMsg.counter;var o={project_basic_info:this.project_basic_info,project_structure:this.project_structure};this.checkParams()&&this.$api.updateProject(o).then((function(){t.isChangeCurrentProject=!1,t.$message({showClose:!0,type:"success",message:"保存成功"})})).catch((function(){t.$message({type:"error",message:"保存失败,请重试"})}))},goBackSaveProject:function(){var t=this;if(this.checkParams()){var e=this.graph.toJSON().cells;this.project_structure.graph_config=e,this.project_structure.counter=this.itemMsg.counter;var o={project_basic_info:this.project_basic_info,project_structure:this.project_structure},r=this.$loading({lock:!0,text:"正在上传..."});this.$api.updateProject(o).then((function(){t.$message({showClose:!0,type:"success",message:"保存成功"}),r.close(),t.$router.push({name:"ProjectManage"})})).catch((function(){r.close(),t.$message({type:"error",message:"保存失败,请重试"})}))}},resetView:function(){this.graph.centerContent(),console.log("复位")},clearGraph:function(){this.graph.clearCells(),console.log("清空画布")},preStep:function(){this.graph.undo(),console.log("上一步")},nextStep:function(){this.graph.redo(),console.log("下一步")},delCell:function(){var t=this,e=this.graph.getSelectedCells();e.forEach((function(e){t.graph.removeCell(e)}))},goBack:function(){var t=this;this.isChangeCurrentProject?this.$confirm("是否保存当前修改, 是否继续?","提示",{confirmButtonText:"保存",cancelButtonText:"不保存",type:"warning"}).then((function(){t.goBackSaveProject()})).catch((function(){t.$message({type:"info",message:"修改将不会保存",showClose:!0}),t.$router.push({name:"ProjectManage"})})):this.$router.push({name:"ProjectManage"})},importProject:function(){var t=this.graph.toJSON().cells;this.project_structure.graph_config=t,console.log(t)},isShow:function(){this.$store.commit("FlowChart/setDialogFrom",{key:"projectBasicInfo",value:{}}),this.$store.commit("FlowChart/setDialogFrom",{key:"projectBasicInfo",value:Object(i["a"])({},this.project_basic_info)}),this.$store.commit("FlowChart/setDialogFrom",{key:"dialogFormVisible",value:!1}),this.$store.commit("FlowChart/setDialogFrom",{key:"dialogFormVisible",value:!0})},checkParams:function(){var t=this,e=[],o={initial_module:"请配置初始模块",initial_function:"请配置入口函数",graph_config_null:"不能保存空项目",graph_config:"请检查节点或边的参数配置",project_name:"项目名不能为空",project_desc:"项目描述不能为空",project_id:"项目编号不能为空"},r=this.project_structure.running_config,a=this.project_structure.graph_config,i=this.project_basic_info;if(i?Object.keys(i).forEach((function(t){i[t]||e.push(t)})):e.push.apply(e,["project_desc","project_name"]),r?Object.keys(r).forEach((function(t){r[t]||e.push(t)})):e.push.apply(e,["initial_module","initial_function"]),!Array.isArray(a)||a.length<=0)e.push("graph_config_null"),console.log("不是数组");else{var n=a.every((function(t){return Object.values(t.data).every((function(t){return""!==t}))}));n||e.push("graph_config")}return!(e.length>0)||(e.forEach((function(e){setTimeout((function(){t.$message({showClose:!0,message:"".concat(o[e]),type:"error",duration:5e3})}),10)})),!1)},getOneProjectData:function(){var t=this;this.$api.getProjectConfig({id:104}).then((function(e){console.log(e),console.log(Array.isArray(e.mapMsg.graph_config)),t.project_structure.running_config=e.mapMsg.running_config,t.project_structure.graph_config=e.mapMsg.graph_config,t.graph.fromJSON(e.mapMsg.graph_config)}))},getModules:function(){var t=this;this.$api.getModules().then((function(e){console.log(e),t.mapMsg=e.mapMsg,t.setNode()}))},getInitialData:function(){var t=this,e=this.$store.state.projectManage.resultList.curItem.id,o=[this.$api.getModules(),this.$api.getProjectConfig({id:e})],r=Promise.all(o);r.then((function(e){t.mapMsg=e[0].mapMsg,t.setNode(),t.project_structure.running_config=e[1].mapMsg.running_config,t.project_structure.graph_config=e[1].mapMsg.graph_config,t.itemMsg.counter=e[1].mapMsg.counter||1,t.graph.fromJSON(e[1].mapMsg.graph_config),setTimeout((function(){t.isChangeCurrentProject=!1}),0)}))},saveVuexToLocal:function(){sessionStorage.getItem("store")&&this.$store.replaceState(Object.assign({},this.$store.state,JSON.parse(sessionStorage.getItem("store")))),window.addEventListener("beforeunload",this.saveVuex)},cancelListening:function(){window.removeEventListener("beforeunload",this.saveVuex),sessionStorage.removeItem("store")},saveVuex:function(){sessionStorage.setItem("store",JSON.stringify(this.$store.state))},dragToolsBox:function(){var t,e,o=document.getElementById("tools-box"),r=!1;o.onmousedown=function(a){t=a.pageX-o.offsetLeft,e=a.pageY-o.offsetTop,r=!0},window.onmouseup=function(){r=!1},window.onmousemove=function(a){r&&(o.style.left=a.pageX-t+"px",o.style.top=a.pageY-e+"px")}}},created:function(){this.saveVuexToLocal()},mounted:function(){this.setGraph(),this.setKeyEvent(),this.setNodeData()},activated:function(){this.isChangeCurrentProject=!1,this.saveVuexToLocal(),this.getInitialData()},deactivated:function(){this.cancelListening()},beforeDestroy:function(){this.cancelListening()}},j=y,k=(o("5c04"),Object(d["a"])(j,r,a,!1,null,"26c3b85e",null));e["default"]=k.exports},a7c8:function(t,e,o){t.exports=o.p+"static/img/clear.fb88e9cd.svg"},bf19:function(t,e,o){"use strict";var r=o("23e7");r({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return URL.prototype.toString.call(this)}})},c9a6:function(t,e,o){t.exports=o.p+"static/img/back.9823959a.svg"},f3f4:function(t,e,o){t.exports=o.p+"static/img/refresh.fdc08188.svg"},fa5a:function(t,e,o){}}]);
//# sourceMappingURL=chunk-66892c0b.e2d34337.js.map