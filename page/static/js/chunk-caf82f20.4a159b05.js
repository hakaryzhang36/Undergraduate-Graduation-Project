(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-caf82f20"],{"048d":function(t,e,a){},"0b69":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-button",{attrs:{type:"primary",size:"mini",round:""},on:{click:t.handleUpload,closed:t.handleClose}},[t._v("上传")]),a("el-dialog",{attrs:{title:"上传数据","close-on-click-modal":!1,visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-radio-group",{on:{change:t.changeMode},model:{value:t.mode,callback:function(e){t.mode=e},expression:"mode"}},[a("el-radio",{attrs:{label:1}},[t._v("上传图片")]),a("el-radio",{attrs:{label:2}},[t._v("上传标注文件xml")])],1),a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"#","http-request":t.httpReq,"before-upload":t.beforeUpload,"on-error":t.uploadError,"auto-upload":!1,limit:3e3,multiple:""}},[a("div",{staticClass:"el-upload__bts"},[a("el-button",{attrs:{slot:"trigger",size:"mini",type:"primary"},slot:"trigger"},[t._v("选取文件")]),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"mini",type:"success"},on:{click:t.submitUpload}},[t._v("上传到服务器")])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:1===t.mode,expression:"mode === 1"}],staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[a("div",[t._v("1、只能上传jpg文件，且不超过1200M")]),a("div",[t._v("2、一次只能上传3000张")]),a("div",[t._v("3、上传过程中不要关闭页面并报持网络畅通")])]),a("div",{directives:[{name:"show",rawName:"v-show",value:2===t.mode,expression:"mode === 2"}],staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[a("div",[t._v("1、只能上传xml文件")])])]),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:t.hideUpload}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.determineUpload}},[t._v("确 定")])],1)],1)],1)},n=[],s=(a("b0c0"),a("4de4"),{data:function(){return{currentDateName:"",mode:1,dialogFormVisible:!1,postImgParam:{datasetname:"",action:"",version:"",index:""}}},computed:{currentName:function(){return this.$store.state.ItemDetails.itemDate}},watch:{currentName:{handler:function(t,e){console.log(t,e),this.currentDateName=t}}},methods:{changeMode:function(){console.log("上传的方式变化了"+this.mode)},handleUpload:function(){console.log("点击上传"),this.dialogFormVisible=!0},beforeUpload:function(t){var e=t.name.substring(t.name.lastIndexOf(".")+1);1==this.mode?(console.log("jpg"),e="jpg"):(console.log("xml"),e="xml");var a=t.size/1024/1024<10;return e||this.$message({message:"文件类型只能是 jpg 或者 xml格式!",type:"warning"}),a||this.$message({message:"文件大小不能超过10MB!",type:"warning"}),e&&a},httpReq:function(t){var e=this;console.log("httpReq"),console.log(t),this.currentDateName=this.currentName,console.log(this.currentDateName);var a=t.file,i=new FormData;if("image/jpeg"==t.file.type)console.log("pic"),i.append("file",a),i.append("dataSetName",this.currentDateName),this.$api.uploadImgs(i).then((function(a){200==a.code?(console.log(a),e.$refs.upload.uploadFiles=e.$refs.upload.uploadFiles.filter((function(e){return t.file.name!=e.name}))):404==a.code&&e.$message({message:"该图片已存在",type:"warning"})}));else{console.log("xml");var n=new FormData;n.append("labelFile",a),n.append("dataSetName",this.currentDateName),this.$api.uploadXmls(n).then((function(a){console.log(a),e.$refs.upload.uploadFiles=e.$refs.upload.uploadFiles.filter((function(e){return t.file.name!=e.name}))}))}},httpReqXml:function(t){var e=this;console.log("httpReqXml"),console.log(t),console.log(this.currentDateName),this.currentDateName=this.currentName;var a=t.file,i=new FormData;i.append("labelFile",a),i.append("dataSetName",this.currentDateName),this.$api.uploadXmls(i).then((function(a){console.log(a),e.$refs.upload.uploadFiles=e.$refs.upload.uploadFiles.filter((function(e){return t.file.name!=e.name}))}))},handleRemove:function(t,e){console.log(t,e)},submitUpload:function(t){console.log("执行了"),console.log(t),this.$refs.upload.submit()},uploadError:function(t,e){console.log(e)},handleClose:function(){},hideUpload:function(){var t=this;t.$refs.upload.uploadFiles=[],t.dialogFormVisible=!1},determineUpload:function(){var t=this;console.log(t.$refs.upload.uploadFiles.length),t.$refs.upload.uploadFiles.length>0&&t.$message({type:"error",message:"部分图片上传失败"}),t.$refs.upload.uploadFiles=[],t.dialogFormVisible=!1,this.$emit("changePageData",this.currentName)}}}),o=s,r=(a("53a1"),a("2877")),l=Object(r["a"])(o,i,n,!1,null,"c8807a72",null);e["a"]=l.exports},"33ae":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"imags"}},[a("el-container",[a("el-header",{attrs:{height:"30px"}},[a("div",{staticClass:"command"},[a("div",{staticClass:"name"},[t._v(" "+t._s(t.currentData)+"( "+t._s("已标注："+t.unTag.total_tagging_pics)+" "+t._s("图片总数："+t.total)+") ")]),a("div",{staticClass:"btns"},[a("span",{staticClass:"add"},[a("add-pop",{on:{changeResult:function(e){return t.getPage(e)}}})],1),a("span",{staticClass:"upload"},[a("up-load",{on:{changePageData:function(e){return t.getPage(e)}}})],1),a("span",{staticClass:"dowmload"},[a("down-load")],1),a("span",{staticClass:"showhidden"},[a("el-button",{attrs:{type:"primary",size:"mini",round:""},on:{click:t.isShowTag}},[t._v(t._s(t.btnName))])],1),a("span",{staticClass:"make"},[a("el-button",{attrs:{type:"primary",size:"mini",round:""},on:{click:t.handleMark}},[t._v("标注")])],1),a("span",{staticClass:"delete"},[a("el-button",{attrs:{type:"danger",size:"mini",round:""},on:{click:t.handleDelete}},[t._v("删除")])],1)])])]),a("el-container",[a("el-aside",{attrs:{width:"180px"}},[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"right"},[a("result-list")],1)])],1),a("el-container",[a("el-main",[a("el-row",t._l(t.unTag.tagging_imgs,(function(e,i){return a("el-col",{key:e.imagename+i+t.time,attrs:{span:6}},[a("div",{staticClass:"col-content"},[a("ShowHidden",{key:e.imagename+i+t.time,attrs:{imgConfig:e,comIndex:i,chainName:t.chainName}})],1)])})),1)],1),a("el-footer",{attrs:{height:"30px"}},[a("div",{staticClass:"footer"},[a("el-pagination",{attrs:{background:"","current-page":t.currentPage,"page-sizes":t.pageSizes,"page-size":t.pageSize,layout:t.layout,total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)])],1)],1)],1)],1)},n=[],s=a("6dfc"),o=s["a"],r=(a("33ba"),a("2877")),l=Object(r["a"])(o,i,n,!1,null,null,null);e["default"]=l.exports},"33ba":function(t,e,a){"use strict";a("048d")},"493c":function(t,e,a){"use strict";(function(t){a("a9e3"),a("ac1f"),a("1276"),a("159b"),a("99af");e["a"]={name:"ShowHidden",props:{imgConfig:{type:Object,default:function(){return{}}},classes_count:{type:Array,default:function(){return[]}},comIndex:{type:Number,default:1},chainName:{}},data:function(){return{imgPath:"",ratio:1,imgWH:{width:"",height:""},layer:0,haveCanvas:!0,imgHeight:200,imgWidth:335}},computed:{imgData:function(){return this.imgConfig},comPath:function(){return this.imgPath},currentData:function(){return this.$store.state.ItemDetails.itemDate}},watch:{imgConfig:{handler:function(t){this.initImage(t),console.log("初始化")},deep:!0}},methods:{resizeImgV2:function(e){t("#threeTag"+this.comIndex).empty();var a=parseInt(e["imagesize"].split(",")[1]),i=parseInt(e["imagesize"].split(",")[0]),n=this;n.imgWH.width=i,n.imgWH.height=a;var s="",o="",r=n.imgHeight/a;n.ratio=r,console.log("按高比例缩放"+r),s=parseInt(r*i),o=parseInt(r*a),s>n.imgWidth&&(r=n.imgWidth/i,n.ratio=r,console.log("按宽比例缩放"+r),s=parseInt(r*i)),o=parseInt(n.ratio*a),this.$refs["biaoZu"].style.height="".concat(o,"px"),this.$refs["biaoZu"].style.width="".concat(s,"px"),this.$refs["myCanvas"].setAttribute("width","".concat(s,"px")),this.$refs["myCanvas"].setAttribute("height","".concat(o,"px")),this.$refs["threeTag"].style.height="".concat(o,"px"),this.$refs["threeTag"].style.width="".concat(s,"px"),this.createTag(),this.imgPath=e.imagename},addImgV2:function(t){console.log(t);var e=this;console.log(t["imagesize"]);var a=parseInt(t["imagesize"].split(",")[1]),i=parseInt(t["imagesize"].split(",")[0]);e.imgWH.width=i,e.imgWH.height=a;var n="",s="",o="";o=e.imgHeight/a,e.ratio=o,console.log("按高比例缩放"+o),n=parseInt(o*i),console.log(n,e.imgWidth),n>e.imgWidth&&(o=e.imgWidth/i,e.ratio=o,console.log("按宽比例缩放"+o),n=parseInt(o*i)),s=parseInt(e.ratio*a),this.$refs["biaoZu"].style.height="".concat(s,"px"),this.$refs["biaoZu"].style.width="".concat(n,"px"),this.imgPath=t.imagename},createTag:function(){var e=this,a="threeTag"+e.comIndex,i=e.ratio,n=e.$refs["myCanvas"].getContext("2d");n.strokeStyle="#FF0000",this.imgConfig.labelboxes.forEach((function(s){var o=parseInt(s.xmin*i),r=parseInt(s.ymin*i),l=parseInt((s.xmax-s.xmin)*i),c=parseInt((s.ymax-s.ymin)*i),g=e.chainName[s.label]?e.chainName[s.label]:s.label;e.layer+=1;var u=t('<div id="layer'.concat(e.layer,'" class="isShowLayer">').concat(g,"</div>"));u.css({position:"absolute",background:"rgb(107,124,152)",left:"".concat(o,"px"),top:"".concat(r,"px"),color:"yellow","z-index":1e3}),n.strokeRect(o,r,l,c),t("#"+a).append(u)}))},initImage:function(e){t("#threeTag"+this.comIndex).empty(),this.$refs["myCanvas"].setAttribute("width","".concat(200,"px")),this.$refs["myCanvas"].setAttribute("height","".concat(200,"px")),0!=this.imgConfig.labelboxes.length?(console.log("***已标注*****"),this.haveCanvas=!0,this.resizeImgV2(e)):(this.haveCanvas=!1,this.addImgV2(e))}},mounted:function(){this.initImage(this.imgConfig)}}}).call(this,a("1157"))},"53a1":function(t,e,a){"use strict";a("b507")},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,a){var i=a("1d80"),n=a("5899"),s="["+n+"]",o=RegExp("^"+s+s+"*"),r=RegExp(s+s+"*$"),l=function(t){return function(e){var a=String(i(e));return 1&t&&(a=a.replace(o,"")),2&t&&(a=a.replace(r,"")),a}};t.exports={start:l(1),end:l(2),trim:l(3)}},"6dfc":function(t,e,a){"use strict";(function(t){var i=a("5530"),n=a("53ca"),s=(a("d81d"),a("b64b"),a("1ea1")),o=a("93b8"),r=a("0b69"),l=a("4bdd"),c=a("6957");e["a"]={components:{AddPop:s["a"],ShowHidden:o["a"],UpLoad:r["a"],DownLoad:l["a"],ResultList:c["a"]},data:function(){return{currentData:"",currentPage:1,total:null,pageSize:12,pageSizes:[12,18],layout:"total, sizes, prev, pager, next, jumper",unTag:{tagging_imgs:[],total_pages:0,total_pic:0,total_tagging_pics:0,total_untagging_pics:0},time:null,labelstatus:"labeled",chainName:{},chainNameKey:[],loading:"",currentTag:"全部标注",currentTagKey:"all",btn:"隐藏标注"}},computed:{currentType:function(){return this.$store.state.ItemDetails.currentType},menulist:function(){return this.$store.state.ItemDetails.menuList},itemDate:function(){return this.$store.state.ItemDetails.itemDate},btnName:function(){return this.btn?"隐藏标注":"显示标注"}},watch:{itemDate:{handler:function(t,e){"image"==this.currentType&&(console.log(t,e),this.currentData=t,this.unTag.tagging_imgs=[],this.currentPage=1,this.getPage())},deep:!0,immediate:!0}},methods:{reLoad:function(){console.log(this.$store.state.ItemDetails.itemDate),this.currentData=this.$store.state.ItemDetails.itemDate,this.getPage()},getTime:function(){this.time=(new Date).getTime(),console.log("当前时间"+this.time+Object(n["a"])(this.time))},getPage:function(){var t=this,e=this;this.getTime(),"image"===this.$store.state.ItemDetails.currentType&&this.$api.getPageData({dataSetName:this.currentData,page_number:this.currentPage,page_size:this.pageSize}).then((function(a){if(t.loading=t.$loading({lock:!0,text:"正在加载图片...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),console.log(a),200===a.code&&"image"==a.dataType){console.log(a.images);var n=a.images.tagging_imgs.map((function(t){var e=Object.keys(t.classes_count).map((function(e){return{date:e,name:t.classes_count[e]}}));return Object(i["a"])(Object(i["a"])({},t),{},{classes_count:e})}));console.log(n),e.unTag=a.images,e.unTag.tagging_imgs=n,e.total=parseInt(e.unTag.total_pics),e.unTag.total_tagging_pics=a.images.total_tagging_pics,e.unTag.total_untagging_pics=a.images.total_untagging_pics}e.loading.close()}))},handleSizeChange:function(t){console.log("每页 ".concat(t," 条")),this.pageSize=t,this.getPage()},handleCurrentChange:function(t){console.log("当前页: ".concat(t)),this.currentPage=t,this.getPage()},isShowTag:function(){this.btn?t(".isShowLayer").css("display","none"):t(".isShowLayer").css("display","block"),this.btn=!this.btn},handleMark:function(){this.$router.push({name:"TagImage"})},handleDelete:function(){var t=this;console.log("开始删除"),console.log(this.currentData);var e=this;this.$confirm("此操作将永久删除该数据集, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$api.deleteData({dataSetName:t.currentData}).then((function(e){console.log(e),t.$store.commit("ItemDetails/delect_resultList_isDelect",!1),t.$store.commit("ItemDetails/delect_resultList_isDelect",!0),t.$message({type:"success",message:"删除成功!"})})).catch((function(e){console.log(e),t.$message({type:"error",message:"删除失败"})}))})).catch((function(e){console.log(e),t.$message({type:"info",message:"已取消删除"})}))}},mounted:function(){}}}).call(this,a("1157"))},7156:function(t,e,a){var i=a("861d"),n=a("d2bb");t.exports=function(t,e,a){var s,o;return n&&"function"==typeof(s=e.constructor)&&s!==a&&i(o=s.prototype)&&o!==a.prototype&&n(t,o),t}},"93b8":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"tagImged"}},[a("div",{staticClass:"imgs"},[a("div",{ref:"threeTag",staticClass:"threeTag",attrs:{id:"threeTag"+t.comIndex}}),a("img",{ref:"biaoZu",attrs:{id:"biaoZu",src:t.comPath,alt:"暂无图片"}}),a("canvas",{ref:"myCanvas",staticClass:"myCanvas",attrs:{id:"myCanvas"+t.comIndex}})])])},n=[],s=a("493c"),o=s["a"],r=(a("ba70"),a("2877")),l=Object(r["a"])(o,i,n,!1,null,"629ffd33",null);e["a"]=l.exports},a9e3:function(t,e,a){"use strict";var i=a("83ab"),n=a("da84"),s=a("94ca"),o=a("6eeb"),r=a("5135"),l=a("c6b6"),c=a("7156"),g=a("c04e"),u=a("d039"),m=a("7c73"),d=a("241c").f,h=a("06cf").f,p=a("9bf2").f,f=a("58a8").trim,v="Number",b=n[v],y=b.prototype,_=l(m(y))==v,I=function(t){var e,a,i,n,s,o,r,l,c=g(t,!1);if("string"==typeof c&&c.length>2)if(c=f(c),e=c.charCodeAt(0),43===e||45===e){if(a=c.charCodeAt(2),88===a||120===a)return NaN}else if(48===e){switch(c.charCodeAt(1)){case 66:case 98:i=2,n=49;break;case 79:case 111:i=8,n=55;break;default:return+c}for(s=c.slice(2),o=s.length,r=0;r<o;r++)if(l=s.charCodeAt(r),l<48||l>n)return NaN;return parseInt(s,i)}return+c};if(s(v,!b(" 0o1")||!b("0b1")||b("+0x1"))){for(var x,$=function(t){var e=arguments.length<1?0:t,a=this;return a instanceof $&&(_?u((function(){y.valueOf.call(a)})):l(a)!=v)?c(new b(I(e)),a,$):I(e)},C=i?d(b):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),N=0;C.length>N;N++)r(b,x=C[N])&&!r($,x)&&p($,x,h(b,x));$.prototype=y,y.constructor=$,o(n,v,$)}},b507:function(t,e,a){},ba70:function(t,e,a){"use strict";a("d807")},d807:function(t,e,a){}}]);
//# sourceMappingURL=chunk-caf82f20.4a159b05.js.map