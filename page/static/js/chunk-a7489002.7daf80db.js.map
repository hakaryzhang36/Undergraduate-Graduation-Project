{"version":3,"sources":["webpack:///./src/assets/images/kong.png","webpack:///./src/views/TagImage/TagImage.vue?cf43","webpack:///./node_modules/jcanvas/dist/jcanvas.js","webpack:///src/views/TagImage/TagImage.vue","webpack:///./src/views/TagImage/TagImage.vue?763e","webpack:///./src/views/TagImage/TagImage.vue?b033","webpack:///./src/views/TagImage/TagImage.vue"],"names":["module","exports","jQuery","global","factory","w","window","this","$","defaults","document","Image","Array","getComputedStyle","Math","Number","parseFloat","extendObject","extend","inArray","typeOf","operand","Object","prototype","toString","call","slice","toLowerCase","isPlainObject","PI","round","abs","sin","cos","atan2","arraySlice","jQueryEventFix","event","fix","maps","caches","dataCache","propCache","imageCache","baseTransforms","rotate","scaleX","scaleY","translateX","translateY","masks","css","tangibleEvents","jCanvasObject","args","propName","params","hasOwnProperty","jCanvas","events","eventHooks","future","jCanvasDefaults","baseDefaults","isString","isFunction","isNumeric","isNaN","_getContext","canvas","getContext","_coerceNumericProps","props","propType","propValue","undefined","text","String","_cloneTransforms","transforms","_saveCanvas","ctx","data","save","savedTransforms","push","_restoreCanvas","length","restore","pop","_setStyle","styleName","_setGlobalProps","lineWidth","strokeWidth","rounded","lineCap","lineJoin","strokeCap","strokeJoin","miterLimit","strokeDash","setLineDash","webkitLineDash","lineDashOffset","webkitLineDashOffset","mozDashOffset","strokeDashOffset","shadowOffsetX","shadowX","shadowOffsetY","shadowY","shadowBlur","shadowColor","globalAlpha","opacity","globalCompositeOperation","compositing","imageSmoothing","imageSmoothingEnabled","_enableMasking","mask","autosave","clip","_args","_restoreTransform","_transformed","_closePath","closed","closePath","shadowStroke","stroke","fill","fillStyle","_getCanvasData","_transformShape","width","height","_toRad","inDegrees","fromCenter","_centered","x","y","_rotateCanvas","scale","_scaleCanvas","translate","_translateCanvas","_canvas","_data","layers","layer","names","groups","intersecting","lastIntersected","cursor","drag","dragging","type","animating","animated","pixelRatio","scaled","redrawOnMousemove","_addLayerEvents","$canvas","eventName","cursors","_addExplicitLayerEvent","mouseout","bind","l","_triggerLayerEvent","_hovered","triggerLayerEvent","drawLayers","_addLayerEvent","_event","_enableDrag","dragHelperEvents","i","draggable","_updateLayerName","nameMap","name","_updateLayerGroups","group","groupName","g","index","groupMap","splice","_getIntersectingLayer","m","_masks","intersects","intangible","_drawLayer","nextLayerIndex","visible","_method","_next","_handleLayerDrag","eventType","dragGroups","newX","newY","bringToFront","_startX","_startY","_endX","_eventX","_endY","_eventY","updateDragX","updateDragY","dx","dy","restrictDragToAxis","originalRedrawOnMousemove","_setCursor","prefix","_resetCursor","_runEventCallback","callbacks","arg","_running","_layerCanFireEvent","disableEvents","_addLayer","method","_layer","fn","drawings","drawText","measureText","_showProps","obj","cssProp","p","_hideProps","reset","propsObj","_parseEndValues","endValues","subPropName","subPropValue","_removeSubPropAliases","indexOf","_colorToRgbArray","color","originalColor","elem","rgb","multiple","match","head","style","_animateColor","fx","n","start","end","now","pos","join","nodeName","prop","_supportColorProps","step","_getTouchEventName","touchEvents","_getMouseEventName","mouseEvents","_createEvent","helperEventName","touchEventName","eventCache","eventCallback","offsetX","offsetY","resetFire","preventDefault","_createEvents","eventNames","_detectEvents","angle","isPointInPath","isPointInStroke","eventX","eventY","Boolean","_getCoterminal","_getArcX","radius","_getArcY","_drawArc","path","x1","y1","x2","y2","x3","y3","x4","y4","diff","ccw","_addStartArrow","arc","_addEndArrow","_addArrow","leftX","leftY","rightX","rightY","arrowRadius","arrowAngle","moveTo","lineTo","_arrowAngleConverted","startArrow","endArrow","_drawLine","lx","ly","_drawQuadratic","lcx","lcy","cx1","cy1","quadraticCurveTo","_drawBezier","lc","lcx1","lcy1","lcx2","lcy2","bezierCurveTo","_getVectorX","_getVectorY","_drawVector","a1","l1","_setCanvasFont","fontSize","font","fontStyle","fontFamily","_measureText","lines","originalSize","curWidth","maxWidth","lineHeight","_wrapText","line","words","allText","manualLines","split","allLines","concat","replace","align","baseline","concavity","cornerRadius","count","cropFromCenter","crossOrigin","letterSpacing","r1","r2","repeat","respectAlign","sHeight","sides","source","spread","strokeStyle","sWidth","sx","sy","plugin","self","e","$canvases","getEventHooks","setEventHooks","getLayers","callback","matching","getLayer","layerId","idType","getLayerGroup","groupId","getLayerIndex","setLayer","substr","isEmptyObject","setLayers","setLayerGroup","moveLayer","removeLayer","removeLayers","removeLayerGroup","addLayerToGroup","removeLayerFromGroup","styles","documentElement","pre","OLink","drawLayer","lastLayer","lastIndex","isImageLayer","clear","clearCanvas","complete","drawLayersComplete","_fired","drawImage","mouseover","addLayer","animateLayer","arguments","_animating","parts","hidden","_pos","duration","easing","draw","animate","animateLayerGroup","apply","delayLayer","delay","delayLayerGroup","stopLayer","clearQueue","stop","stopLayerGroup","offset","originalEvent","touches","changedTouches","pageX","currentTarget","left","pageY","top","error","setTransform","clearRect","saveCanvas","restoreCanvas","rotateCanvas","scaleCanvas","translateCanvas","drawRect","r","temp","beginPath","rect","drawArc","drawEllipse","controlW","controlH","drawPolygon","theta","dtheta","hdtheta","apothem","drawSlice","drawLine","drawQuadratic","drawBezier","drawVector","drawPath","lp","nchars","chars","ch","c","constantCloseness","textBaseline","textAlign","flipArcText","reverse","fillText","strokeText","img","imgCtx","onload","load","src","createPattern","pattern","createGradient","gradient","nstops","a","stops","createRadialGradient","createLinearGradient","addColorStop","setPixels","canvasData","px","imgData","pixelData","len","getImageData","each","b","putImageData","getCanvasImage","quality","dataURL","toDataURL","detectPixelRatio","devicePixelRatio","backingStoreRatio","ratio","oldWidth","oldHeight","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio","clearCache","cacheName","support","setGlobalProps","transformShape","detectEvents","setCanvasFont","imgPath","imgWH","looking","tagImg","msgList","tagName","trained","untrained","imgTagDist","folder","version","imgName","imgWidth","imgHeight","TagList","action","dialogVisible","restaurants","dialogVisible2","dynamicTags","inputVisible","inputValue","isLoading","loading","isTagImgList","pagenumber","pagesize","total_pics","total_pages","isTaged","curImage","ratioHeight","ratioWidth","curImageIndex","paramList","dataSetName","tagStatus","scaleHeight","disabled","tableList","currentPage","pageSize","search","computed","imgUrl","that","itemDate","$store","state","ItemDetails","twoListLength","imgParam","param","pageNum","console","log","isNextPage","isNext","watch","handler","newVal","drawPen","deep","close","getTagedImage","getUnTagImage","methods","up","resizeImgV2","down","getTagName","clearList","searchAction","handleSearch","resizeWindow","resize","stopTag","startTag","$api","showData","lastPage","$router","onmousedown","onmouseup","onmousemove","layerName","clientX","canvasLeft","clientY","canvasTop","result","leftUp","canvasId","penWidth","rightDown","canvasX","canvasY","createTag","div","position","background","append","querySearch","cb","handleSelect","item","addLabelBoxes","isArray","tagList","forEach","labItem","label","xmin","ymin","xmax","ymax","labelBoxes","sendTagList","msg","imgname","imagename","imgItem","dataset","cancel","removeOne","determine","removeTag","clearAll","empty","imgRatio","managerTag","res","value","handleClose","tag","showInput","$nextTick","handleInputConfirm","cancelManage","determineManage","postTagList","unTarget","unTag","saveData","createLoading","$loading","lock","spinner","commit","setIsTaged","tf","getPage","num","selectImg","isClick","parseInt","$refs","setAttribute","image","addTagRect","created","mounted","activated","beforeDestroy","cancelListening","render","_vm","_h","$createElement","_c","_self","attrs","on","$event","staticClass","model","$$v","expression","slot","_v","_l","key","_s","ref","nativeOn","_k","keyCode","target","directives","rawName","_e","padding","staticRenderFns","component"],"mappings":"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","file":"static/js/chunk-a7489002.7daf80db.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/img/kong.effef897.png\";","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TagImage.vue?vue&type=style&index=0&id=1d9daacd&lang=scss&scoped=true&\"","/**\n * @license jCanvas v21.0.1\n * Copyright 2017 Caleb Evans\n * Released under the MIT license\n */\n(function (jQuery, global, factory) {\n\t'use strict';\n\n\tif (typeof module === 'object' && typeof module.exports === 'object') {\n\t\tmodule.exports = function (jQuery, w) {\n\t\t\treturn factory(jQuery, w);\n\t\t};\n\t} else {\n\t\tfactory(jQuery, global);\n\t}\n\n// Pass this if window is not defined yet\n}(typeof window !== 'undefined' ? window.jQuery : {}, typeof window !== 'undefined' ? window : this, function ($, window) {\n'use strict';\n\nvar document = window.document,\n\tImage = window.Image,\n\tArray = window.Array,\n\tgetComputedStyle = window.getComputedStyle,\n\tMath = window.Math,\n\tNumber = window.Number,\n\tparseFloat = window.parseFloat;\n\n// Define local aliases to frequently used properties\nvar defaults,\n\t// Aliases to jQuery methods\n\textendObject = $.extend,\n\tinArray = $.inArray,\n\ttypeOf = function (operand) {\n\t\treturn Object.prototype.toString.call(operand)\n\t\t\t.slice(8, -1).toLowerCase();\n\t},\n\tisPlainObject = $.isPlainObject,\n\t// Math constants and functions\n\tPI = Math.PI,\n\tround = Math.round,\n\tabs = Math.abs,\n\tsin = Math.sin,\n\tcos = Math.cos,\n\tatan2 = Math.atan2,\n\t// The Array slice() method\n\tarraySlice = Array.prototype.slice,\n\t// jQuery's internal event normalization function\n\tjQueryEventFix = $.event.fix,\n\t// Object for storing a number of internal property maps\n\tmaps = {},\n\t// jQuery internal caches\n\tcaches = {\n\t\tdataCache: {},\n\t\tpropCache: {},\n\t\timageCache: {}\n\t},\n\t// Base transformations\n\tbaseTransforms = {\n\t\trotate: 0,\n\t\tscaleX: 1,\n\t\tscaleY: 1,\n\t\ttranslateX: 0,\n\t\ttranslateY: 0,\n\t\t// Store all previous masks\n\t\tmasks: []\n\t},\n\t// Object for storing CSS-related properties\n\tcss = {},\n\ttangibleEvents = [\n\t\t'mousedown',\n\t\t'mousemove',\n\t\t'mouseup',\n\t\t'mouseover',\n\t\t'mouseout',\n\t\t'touchstart',\n\t\t'touchmove',\n\t\t'touchend'\n\t];\n\n// Constructor for creating objects that inherit from jCanvas preferences and defaults\nfunction jCanvasObject(args) {\n\tvar params = this,\n\t\tpropName;\n\t// Copy the given parameters into new object\n\tfor (propName in args) {\n\t\t// Do not merge defaults into parameters\n\t\tif (Object.prototype.hasOwnProperty.call(args, propName)) {\n\t\t\tparams[propName] = args[propName];\n\t\t}\n\t}\n\treturn params;\n}\n\n// jCanvas object in which global settings are other data are stored\nvar jCanvas = {\n\t// Events object for storing jCanvas event initiation functions\n\tevents: {},\n\t// Object containing all jCanvas event hooks\n\teventHooks: {},\n\t// Settings for enabling future jCanvas features\n\tfuture: {}\n};\n\n// jCanvas default property values\nfunction jCanvasDefaults() {\n\textendObject(this, jCanvasDefaults.baseDefaults);\n}\njCanvasDefaults.baseDefaults = {\n\talign: 'center',\n\tarrowAngle: 90,\n\tarrowRadius: 0,\n\tautosave: true,\n\tbaseline: 'middle',\n\tbringToFront: false,\n\tccw: false,\n\tclosed: false,\n\tcompositing: 'source-over',\n\tconcavity: 0,\n\tcornerRadius: 0,\n\tcount: 1,\n\tcropFromCenter: true,\n\tcrossOrigin: null,\n\tcursors: null,\n\tdisableEvents: false,\n\tdraggable: false,\n\tdragGroups: null,\n\tgroups: null,\n\tdata: null,\n\tdx: null,\n\tdy: null,\n\tend: 360,\n\teventX: null,\n\teventY: null,\n\tfillStyle: 'transparent',\n\tfontStyle: 'normal',\n\tfontSize: '12pt',\n\tfontFamily: 'sans-serif',\n\tfromCenter: true,\n\theight: null,\n\timageSmoothing: true,\n\tinDegrees: true,\n\tintangible: false,\n\tindex: null,\n\tletterSpacing: null,\n\tlineHeight: 1,\n\tlayer: false,\n\tmask: false,\n\tmaxWidth: null,\n\tmiterLimit: 10,\n\tname: null,\n\topacity: 1,\n\tr1: null,\n\tr2: null,\n\tradius: 0,\n\trepeat: 'repeat',\n\trespectAlign: false,\n\trestrictDragToAxis: null,\n\trotate: 0,\n\trounded: false,\n\tscale: 1,\n\tscaleX: 1,\n\tscaleY: 1,\n\tshadowBlur: 0,\n\tshadowColor: 'transparent',\n\tshadowStroke: false,\n\tshadowX: 0,\n\tshadowY: 0,\n\tsHeight: null,\n\tsides: 0,\n\tsource: '',\n\tspread: 0,\n\tstart: 0,\n\tstrokeCap: 'butt',\n\tstrokeDash: null,\n\tstrokeDashOffset: 0,\n\tstrokeJoin: 'miter',\n\tstrokeStyle: 'transparent',\n\tstrokeWidth: 1,\n\tsWidth: null,\n\tsx: null,\n\tsy: null,\n\ttext: '',\n\ttranslate: 0,\n\ttranslateX: 0,\n\ttranslateY: 0,\n\ttype: null,\n\tvisible: true,\n\twidth: null,\n\tx: 0,\n\ty: 0\n};\ndefaults = new jCanvasDefaults();\njCanvasObject.prototype = defaults;\n\n/* Internal helper methods */\n\n// Determines if the given operand is a string\nfunction isString(operand) {\n\treturn (typeOf(operand) === 'string');\n}\n\n// Determines if the given operand is a function\nfunction isFunction(operand) {\n\treturn (typeOf(operand) === 'function');\n}\n\n// Determines if the given operand is numeric\nfunction isNumeric(operand) {\n\treturn !isNaN(Number(operand)) && !isNaN(parseFloat(operand));\n}\n\n// Get 2D context for the given canvas\nfunction _getContext(canvas) {\n\treturn (canvas && canvas.getContext ? canvas.getContext('2d') : null);\n}\n\n// Coerce designated number properties from strings to numbers\nfunction _coerceNumericProps(props) {\n\tvar propName, propType, propValue;\n\t// Loop through all properties in given property map\n\tfor (propName in props) {\n\t\tif (Object.prototype.hasOwnProperty.call(props, propName)) {\n\t\t\tpropValue = props[propName];\n\t\t\tpropType = typeOf(propValue);\n\t\t\t// If property is non-empty string and value is numeric\n\t\t\tif (propType === 'string' && isNumeric(propValue) && propName !== 'text') {\n\t\t\t\t// Convert value to number\n\t\t\t\tprops[propName] = parseFloat(propValue);\n\t\t\t}\n\t\t}\n\t}\n\t// Ensure value of text property is always a string\n\tif (props.text !== undefined) {\n\t\tprops.text = String(props.text);\n\t}\n}\n\n// Clone the given transformations object\nfunction _cloneTransforms(transforms) {\n\t// Clone the object itself\n\ttransforms = extendObject({}, transforms);\n\t// Clone the object's masks array\n\ttransforms.masks = transforms.masks.slice(0);\n\treturn transforms;\n}\n\n// Save canvas context and update transformation stack\nfunction _saveCanvas(ctx, data) {\n\tvar transforms;\n\tctx.save();\n\ttransforms = _cloneTransforms(data.transforms);\n\tdata.savedTransforms.push(transforms);\n}\n\n// Restore canvas context update transformation stack\nfunction _restoreCanvas(ctx, data) {\n\tif (data.savedTransforms.length === 0) {\n\t\t// Reset transformation state if it can't be restored any more\n\t\tdata.transforms = _cloneTransforms(baseTransforms);\n\t} else {\n\t\t// Restore canvas context\n\t\tctx.restore();\n\t\t// Restore current transform state to the last saved state\n\t\tdata.transforms = data.savedTransforms.pop();\n\t}\n}\n\n// Set the style with the given name\nfunction _setStyle(canvas, ctx, params, styleName) {\n\tif (params[styleName]) {\n\t\tif (isFunction(params[styleName])) {\n\t\t\t// Handle functions\n\t\t\tctx[styleName] = params[styleName].call(canvas, params);\n\t\t} else {\n\t\t\t// Handle string values\n\t\t\tctx[styleName] = params[styleName];\n\t\t}\n\t}\n}\n\n// Set canvas context properties\nfunction _setGlobalProps(canvas, ctx, params) {\n\t_setStyle(canvas, ctx, params, 'fillStyle');\n\t_setStyle(canvas, ctx, params, 'strokeStyle');\n\tctx.lineWidth = params.strokeWidth;\n\t// Optionally round corners for paths\n\tif (params.rounded) {\n\t\tctx.lineCap = ctx.lineJoin = 'round';\n\t} else {\n\t\tctx.lineCap = params.strokeCap;\n\t\tctx.lineJoin = params.strokeJoin;\n\t\tctx.miterLimit = params.miterLimit;\n\t}\n\t// Reset strokeDash if null\n\tif (!params.strokeDash) {\n\t\tparams.strokeDash = [];\n\t}\n\t// Dashed lines\n\tif (ctx.setLineDash) {\n\t\tctx.setLineDash(params.strokeDash);\n\t}\n\tctx.webkitLineDash = params.strokeDash;\n\tctx.lineDashOffset = ctx.webkitLineDashOffset = ctx.mozDashOffset = params.strokeDashOffset;\n\t// Drop shadow\n\tctx.shadowOffsetX = params.shadowX;\n\tctx.shadowOffsetY = params.shadowY;\n\tctx.shadowBlur = params.shadowBlur;\n\tctx.shadowColor = params.shadowColor;\n\t// Opacity and composite operation\n\tctx.globalAlpha = params.opacity;\n\tctx.globalCompositeOperation = params.compositing;\n\t// Support cross-browser toggling of image smoothing\n\tif (params.imageSmoothing) {\n\t\tctx.imageSmoothingEnabled = params.imageSmoothing;\n\t}\n}\n\n// Optionally enable masking support for this path\nfunction _enableMasking(ctx, data, params) {\n\tif (params.mask) {\n\t\t// If jCanvas autosave is enabled\n\t\tif (params.autosave) {\n\t\t\t// Automatically save transformation state by default\n\t\t\t_saveCanvas(ctx, data);\n\t\t}\n\t\t// Clip the current path\n\t\tctx.clip();\n\t\t// Keep track of current masks\n\t\tdata.transforms.masks.push(params._args);\n\t}\n}\n\n// Restore individual shape transformation\nfunction _restoreTransform(ctx, params) {\n\t// If shape has been transformed by jCanvas\n\tif (params._transformed) {\n\t\t// Restore canvas context\n\t\tctx.restore();\n\t}\n}\n\n// Close current canvas path\nfunction _closePath(canvas, ctx, params) {\n\tvar data;\n\n\t// Optionally close path\n\tif (params.closed) {\n\t\tctx.closePath();\n\t}\n\n\tif (params.shadowStroke && params.strokeWidth !== 0) {\n\t\t// Extend the shadow to include the stroke of a drawing\n\n\t\t// Add a stroke shadow by stroking before filling\n\t\tctx.stroke();\n\t\tctx.fill();\n\t\t// Ensure the below stroking does not inherit a shadow\n\t\tctx.shadowColor = 'transparent';\n\t\tctx.shadowBlur = 0;\n\t\t// Stroke over fill as usual\n\t\tctx.stroke();\n\n\t} else {\n\t\t// If shadowStroke is not enabled, stroke & fill as usual\n\n\t\tctx.fill();\n\t\t// Prevent extra shadow created by stroke (but only when fill is present)\n\t\tif (params.fillStyle !== 'transparent') {\n\t\t\tctx.shadowColor = 'transparent';\n\t\t}\n\t\tif (params.strokeWidth !== 0) {\n\t\t\t// Only stroke if the stroke is not 0\n\t\t\tctx.stroke();\n\t\t}\n\n\t}\n\n\t// Optionally close path\n\tif (!params.closed) {\n\t\tctx.closePath();\n\t}\n\n\t// Restore individual shape transformation\n\t_restoreTransform(ctx, params);\n\n\t// Mask shape if chosen\n\tif (params.mask) {\n\t\t// Retrieve canvas data\n\t\tdata = _getCanvasData(canvas);\n\t\t_enableMasking(ctx, data, params);\n\t}\n\n}\n\n// Transform (translate, scale, or rotate) shape\nfunction _transformShape(canvas, ctx, params, width, height) {\n\n\t// Get conversion factor for radians\n\tparams._toRad = (params.inDegrees ? (PI / 180) : 1);\n\n\tparams._transformed = true;\n\tctx.save();\n\n\t// Optionally measure (x, y) position from top-left corner\n\tif (!params.fromCenter && !params._centered && width !== undefined) {\n\t\t// Always draw from center unless otherwise specified\n\t\tif (height === undefined) {\n\t\t\theight = width;\n\t\t}\n\t\tparams.x += width / 2;\n\t\tparams.y += height / 2;\n\t\tparams._centered = true;\n\t}\n\t// Optionally rotate shape\n\tif (params.rotate) {\n\t\t_rotateCanvas(ctx, params, null);\n\t}\n\t// Optionally scale shape\n\tif (params.scale !== 1 || params.scaleX !== 1 || params.scaleY !== 1) {\n\t\t_scaleCanvas(ctx, params, null);\n\t}\n\t// Optionally translate shape\n\tif (params.translate || params.translateX || params.translateY) {\n\t\t_translateCanvas(ctx, params, null);\n\t}\n\n}\n\n/* Plugin API */\n\n// Extend jCanvas with a user-defined method\njCanvas.extend = function extend(plugin) {\n\n\t// Create plugin\n\tif (plugin.name) {\n\t\t// Merge properties with defaults\n\t\tif (plugin.props) {\n\t\t\textendObject(defaults, plugin.props);\n\t\t}\n\t\t// Define plugin method\n\t\t$.fn[plugin.name] = function self(args) {\n\t\t\tvar $canvases = this, canvas, e, ctx,\n\t\t\t\tparams;\n\n\t\t\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\t\t\tcanvas = $canvases[e];\n\t\t\t\tctx = _getContext(canvas);\n\t\t\t\tif (ctx) {\n\n\t\t\t\t\tparams = new jCanvasObject(args);\n\t\t\t\t\t_addLayer(canvas, params, args, self);\n\n\t\t\t\t\t_setGlobalProps(canvas, ctx, params);\n\t\t\t\t\tplugin.fn.call(canvas, ctx, params);\n\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn $canvases;\n\t\t};\n\t\t// Add drawing type to drawing map\n\t\tif (plugin.type) {\n\t\t\tmaps.drawings[plugin.type] = plugin.name;\n\t\t}\n\t}\n\treturn $.fn[plugin.name];\n};\n\n/* Layer API */\n\n// Retrieved the stored jCanvas data for a canvas element\nfunction _getCanvasData(canvas) {\n\tvar dataCache = caches.dataCache, data;\n\tif (dataCache._canvas === canvas && dataCache._data) {\n\n\t\t// Retrieve canvas data from cache if possible\n\t\tdata = dataCache._data;\n\n\t} else {\n\n\t\t// Retrieve canvas data from jQuery's internal data storage\n\t\tdata = $.data(canvas, 'jCanvas');\n\t\tif (!data) {\n\n\t\t\t// Create canvas data object if it does not already exist\n\t\t\tdata = {\n\t\t\t\t// The associated canvas element\n\t\t\t\tcanvas: canvas,\n\t\t\t\t// Layers array\n\t\t\t\tlayers: [],\n\t\t\t\t// Layer maps\n\t\t\t\tlayer: {\n\t\t\t\t\tnames: {},\n\t\t\t\t\tgroups: {}\n\t\t\t\t},\n\t\t\t\teventHooks: {},\n\t\t\t\t// All layers that intersect with the event coordinates (regardless of visibility)\n\t\t\t\tintersecting: [],\n\t\t\t\t// The topmost layer whose area contains the event coordinates\n\t\t\t\tlastIntersected: null,\n\t\t\t\tcursor: $(canvas).css('cursor'),\n\t\t\t\t// Properties for the current drag event\n\t\t\t\tdrag: {\n\t\t\t\t\tlayer: null,\n\t\t\t\t\tdragging: false\n\t\t\t\t},\n\t\t\t\t// Data for the current event\n\t\t\t\tevent: {\n\t\t\t\t\ttype: null,\n\t\t\t\t\tx: null,\n\t\t\t\t\ty: null\n\t\t\t\t},\n\t\t\t\t// Events which already have been bound to the canvas\n\t\t\t\tevents: {},\n\t\t\t\t// The canvas's current transformation state\n\t\t\t\ttransforms: _cloneTransforms(baseTransforms),\n\t\t\t\tsavedTransforms: [],\n\t\t\t\t// Whether a layer is being animated or not\n\t\t\t\tanimating: false,\n\t\t\t\t// The layer currently being animated\n\t\t\t\tanimated: null,\n\t\t\t\t// The device pixel ratio\n\t\t\t\tpixelRatio: 1,\n\t\t\t\t// Whether pixel ratio transformations have been applied\n\t\t\t\tscaled: false,\n\t\t\t\t// Whether the canvas should be redrawn when a layer mousemove\n\t\t\t\t// event triggers (either directly, or indirectly via dragging)\n\t\t\t\tredrawOnMousemove: false\n\t\t\t};\n\t\t\t// Use jQuery to store canvas data\n\t\t\t$.data(canvas, 'jCanvas', data);\n\n\t\t}\n\t\t// Cache canvas data for faster retrieval\n\t\tdataCache._canvas = canvas;\n\t\tdataCache._data = data;\n\n\t}\n\treturn data;\n}\n\n// Initialize all of a layer's associated jCanvas events\nfunction _addLayerEvents($canvas, data, layer) {\n\tvar eventName;\n\t// Determine which jCanvas events need to be bound to this layer\n\tfor (eventName in jCanvas.events) {\n\t\tif (Object.prototype.hasOwnProperty.call(jCanvas.events, eventName)) {\n\t\t\t// If layer has callback function to complement it\n\t\t\tif (layer[eventName] || (layer.cursors && layer.cursors[eventName])) {\n\t\t\t\t// Bind event to layer\n\t\t\t\t_addExplicitLayerEvent($canvas, data, layer, eventName);\n\t\t\t}\n\t\t}\n\t}\n\tif (!data.events.mouseout) {\n\t\t$canvas.bind('mouseout.jCanvas', function () {\n\t\t\t// Retrieve the layer whose drag event was canceled\n\t\t\tvar layer = data.drag.layer, l;\n\t\t\t// If cursor mouses out of canvas while dragging\n\t\t\tif (layer) {\n\t\t\t\t// Cancel drag\n\t\t\t\tdata.drag = {};\n\t\t\t\t_triggerLayerEvent($canvas, data, layer, 'dragcancel');\n\t\t\t}\n\t\t\t// Loop through all layers\n\t\t\tfor (l = 0; l < data.layers.length; l += 1) {\n\t\t\t\tlayer = data.layers[l];\n\t\t\t\t// If layer thinks it's still being moused over\n\t\t\t\tif (layer._hovered) {\n\t\t\t\t\t// Trigger mouseout on layer\n\t\t\t\t\t$canvas.triggerLayerEvent(data.layers[l], 'mouseout');\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Redraw layers\n\t\t\t$canvas.drawLayers();\n\t\t});\n\t\t// Indicate that an event handler has been bound\n\t\tdata.events.mouseout = true;\n\t}\n}\n\n// Initialize the given event on the given layer\nfunction _addLayerEvent($canvas, data, layer, eventName) {\n\t// Use touch events if appropriate\n\t// eventName = _getMouseEventName(eventName);\n\t// Bind event to layer\n\tjCanvas.events[eventName]($canvas, data);\n\tlayer._event = true;\n}\n\n// Add a layer event that was explicitly declared in the layer's parameter map,\n// excluding events added implicitly (e.g. mousemove event required by draggable\n// layers)\nfunction _addExplicitLayerEvent($canvas, data, layer, eventName) {\n\t_addLayerEvent($canvas, data, layer, eventName);\n\tif (eventName === 'mouseover' || eventName === 'mouseout' || eventName === 'mousemove') {\n\t\tdata.redrawOnMousemove = true;\n\t}\n}\n\n// Enable drag support for this layer\nfunction _enableDrag($canvas, data, layer) {\n\tvar dragHelperEvents, eventName, i;\n\t// Only make layer draggable if necessary\n\tif (layer.draggable || layer.cursors) {\n\n\t\t// Organize helper events which enable drag support\n\t\tdragHelperEvents = ['mousedown', 'mousemove', 'mouseup'];\n\n\t\t// Bind each helper event to the canvas\n\t\tfor (i = 0; i < dragHelperEvents.length; i += 1) {\n\t\t\t// Use touch events if appropriate\n\t\t\teventName = dragHelperEvents[i];\n\t\t\t// Bind event\n\t\t\t_addLayerEvent($canvas, data, layer, eventName);\n\t\t}\n\t\t// Indicate that this layer has events bound to it\n\t\tlayer._event = true;\n\n\t}\n}\n\n// Update a layer property map if property is changed\nfunction _updateLayerName($canvas, data, layer, props) {\n\tvar nameMap = data.layer.names;\n\n\t// If layer name is being added, not changed\n\tif (!props) {\n\n\t\tprops = layer;\n\n\t} else {\n\n\t\t// Remove old layer name entry because layer name has changed\n\t\tif (props.name !== undefined && isString(layer.name) && layer.name !== props.name) {\n\t\t\tdelete nameMap[layer.name];\n\t\t}\n\n\t}\n\n\t// Add new entry to layer name map with new name\n\tif (isString(props.name)) {\n\t\tnameMap[props.name] = layer;\n\t}\n}\n\n// Create or update the data map for the given layer and group type\nfunction _updateLayerGroups($canvas, data, layer, props) {\n\tvar groupMap = data.layer.groups,\n\t\tgroup, groupName, g,\n\t\tindex, l;\n\n\t// If group name is not changing\n\tif (!props) {\n\n\t\tprops = layer;\n\n\t} else {\n\n\t\t// Remove layer from all of its associated groups\n\t\tif (props.groups !== undefined && layer.groups !== null) {\n\t\t\tfor (g = 0; g < layer.groups.length; g += 1) {\n\t\t\t\tgroupName = layer.groups[g];\n\t\t\t\tgroup = groupMap[groupName];\n\t\t\t\tif (group) {\n\t\t\t\t\t// Remove layer from its old layer group entry\n\t\t\t\t\tfor (l = 0; l < group.length; l += 1) {\n\t\t\t\t\t\tif (group[l] === layer) {\n\t\t\t\t\t\t\t// Keep track of the layer's initial index\n\t\t\t\t\t\t\tindex = l;\n\t\t\t\t\t\t\t// Remove layer once found\n\t\t\t\t\t\t\tgroup.splice(l, 1);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// Remove layer group entry if group is empty\n\t\t\t\t\tif (group.length === 0) {\n\t\t\t\t\t\tdelete groupMap[groupName];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t}\n\n\t// Add layer to new group if a new group name is given\n\tif (props.groups !== undefined && props.groups !== null) {\n\n\t\tfor (g = 0; g < props.groups.length; g += 1) {\n\n\t\t\tgroupName = props.groups[g];\n\n\t\t\tgroup = groupMap[groupName];\n\t\t\tif (!group) {\n\t\t\t\t// Create new group entry if it doesn't exist\n\t\t\t\tgroup = groupMap[groupName] = [];\n\t\t\t\tgroup.name = groupName;\n\t\t\t}\n\t\t\tif (index === undefined) {\n\t\t\t\t// Add layer to end of group unless otherwise stated\n\t\t\t\tindex = group.length;\n\t\t\t}\n\t\t\t// Add layer to its new layer group\n\t\t\tgroup.splice(index, 0, layer);\n\n\t\t}\n\n\t}\n}\n\n// Get event hooks object for the first selected canvas\n$.fn.getEventHooks = function getEventHooks() {\n\tvar $canvases = this, canvas, data,\n\t\teventHooks = {};\n\n\tif ($canvases.length !== 0) {\n\t\tcanvas = $canvases[0];\n\t\tdata = _getCanvasData(canvas);\n\t\teventHooks = data.eventHooks;\n\t}\n\treturn eventHooks;\n};\n\n// Set event hooks for the selected canvases\n$.fn.setEventHooks = function setEventHooks(eventHooks) {\n\tvar $canvases = this, e,\n\t\tdata;\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\tdata = _getCanvasData($canvases[e]);\n\t\textendObject(data.eventHooks, eventHooks);\n\t}\n\treturn $canvases;\n};\n\n// Get jCanvas layers array\n$.fn.getLayers = function getLayers(callback) {\n\tvar $canvases = this, canvas, data,\n\t\tlayers, layer, l,\n\t\tmatching = [];\n\n\tif ($canvases.length !== 0) {\n\n\t\tcanvas = $canvases[0];\n\t\tdata = _getCanvasData(canvas);\n\t\t// Retrieve layers array for this canvas\n\t\tlayers = data.layers;\n\n\t\t// If a callback function is given\n\t\tif (isFunction(callback)) {\n\n\t\t\t// Filter the layers array using the callback\n\t\t\tfor (l = 0; l < layers.length; l += 1) {\n\t\t\t\tlayer = layers[l];\n\t\t\t\tif (callback.call(canvas, layer)) {\n\t\t\t\t\t// Add layer to array of matching layers if test passes\n\t\t\t\t\tmatching.push(layer);\n\t\t\t\t}\n\t\t\t}\n\n\t\t} else {\n\t\t\t// Otherwise, get all layers\n\n\t\t\tmatching = layers;\n\n\t\t}\n\n\t}\n\treturn matching;\n};\n\n// Get a single jCanvas layer object\n$.fn.getLayer = function getLayer(layerId) {\n\tvar $canvases = this, canvas,\n\t\tdata, layers, layer, l,\n\t\tidType;\n\n\tif ($canvases.length !== 0) {\n\n\t\tcanvas = $canvases[0];\n\t\tdata = _getCanvasData(canvas);\n\t\tlayers = data.layers;\n\t\tidType = typeOf(layerId);\n\n\t\tif (layerId && layerId.layer) {\n\n\t\t\t// Return the actual layer object if given\n\t\t\tlayer = layerId;\n\n\t\t} else if (idType === 'number') {\n\n\t\t\t// Retrieve the layer using the given index\n\n\t\t\t// Allow for negative indices\n\t\t\tif (layerId < 0) {\n\t\t\t\tlayerId = layers.length + layerId;\n\t\t\t}\n\t\t\t// Get layer with the given index\n\t\t\tlayer = layers[layerId];\n\n\t\t} else if (idType === 'regexp') {\n\n\t\t\t// Get layer with the name that matches the given regex\n\t\t\tfor (l = 0; l < layers.length; l += 1) {\n\t\t\t\t// Check if layer matches name\n\t\t\t\tif (isString(layers[l].name) && layers[l].name.match(layerId)) {\n\t\t\t\t\tlayer = layers[l];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// Get layer with the given name\n\t\t\tlayer = data.layer.names[layerId];\n\n\t\t}\n\n\t}\n\treturn layer;\n};\n\n// Get all layers in the given group\n$.fn.getLayerGroup = function getLayerGroup(groupId) {\n\tvar $canvases = this, canvas, data,\n\t\tgroups, groupName, group,\n\t\tidType = typeOf(groupId);\n\n\tif ($canvases.length !== 0) {\n\n\t\tcanvas = $canvases[0];\n\n\t\tif (idType === 'array') {\n\n\t\t\t// Return layer group if given\n\t\t\tgroup = groupId;\n\n\t\t} else if (idType === 'regexp') {\n\n\t\t\t// Get canvas data\n\t\t\tdata = _getCanvasData(canvas);\n\t\t\tgroups = data.layer.groups;\n\t\t\t// Loop through all layers groups for this canvas\n\t\t\tfor (groupName in groups) {\n\t\t\t\t// Find a group whose name matches the given regex\n\t\t\t\tif (groupName.match(groupId)) {\n\t\t\t\t\tgroup = groups[groupName];\n\t\t\t\t\t// Stop after finding the first matching group\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// Find layer group with the given group name\n\t\t\tdata = _getCanvasData(canvas);\n\t\t\tgroup = data.layer.groups[groupId];\n\t\t}\n\n\t}\n\treturn group;\n};\n\n// Get index of layer in layers array\n$.fn.getLayerIndex = function getLayerIndex(layerId) {\n\tvar $canvases = this,\n\t\tlayers = $canvases.getLayers(),\n\t\tlayer = $canvases.getLayer(layerId);\n\n\treturn inArray(layer, layers);\n};\n\n// Set properties of a layer\n$.fn.setLayer = function setLayer(layerId, props) {\n\tvar $canvases = this, $canvas, e,\n\t\tdata, layer,\n\t\tpropName, propValue, propType;\n\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\t$canvas = $($canvases[e]);\n\t\tdata = _getCanvasData($canvases[e]);\n\n\t\tlayer = $($canvases[e]).getLayer(layerId);\n\t\tif (layer) {\n\n\t\t\t// Update layer property maps\n\t\t\t_updateLayerName($canvas, data, layer, props);\n\t\t\t_updateLayerGroups($canvas, data, layer, props);\n\n\t\t\t_coerceNumericProps(props);\n\n\t\t\t// Merge properties with layer\n\t\t\tfor (propName in props) {\n\t\t\t\tif (Object.prototype.hasOwnProperty.call(props, propName)) {\n\t\t\t\t\tpropValue = props[propName];\n\t\t\t\t\tpropType = typeOf(propValue);\n\t\t\t\t\tif (propType === 'object' && isPlainObject(propValue)) {\n\t\t\t\t\t\t// Clone objects\n\t\t\t\t\t\tlayer[propName] = extendObject({}, propValue);\n\t\t\t\t\t\t_coerceNumericProps(layer[propName]);\n\t\t\t\t\t} else if (propType === 'array') {\n\t\t\t\t\t\t// Clone arrays\n\t\t\t\t\t\tlayer[propName] = propValue.slice(0);\n\t\t\t\t\t} else if (propType === 'string') {\n\t\t\t\t\t\tif (propValue.indexOf('+=') === 0) {\n\t\t\t\t\t\t\t// Increment numbers prefixed with +=\n\t\t\t\t\t\t\tlayer[propName] += parseFloat(propValue.substr(2));\n\t\t\t\t\t\t} else if (propValue.indexOf('-=') === 0) {\n\t\t\t\t\t\t\t// Decrement numbers prefixed with -=\n\t\t\t\t\t\t\tlayer[propName] -= parseFloat(propValue.substr(2));\n\t\t\t\t\t\t} else if (!isNaN(propValue) && isNumeric(propValue) && propName !== 'text') {\n\t\t\t\t\t\t\t// Convert numeric values as strings to numbers\n\t\t\t\t\t\t\tlayer[propName] = parseFloat(propValue);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Otherwise, set given string value\n\t\t\t\t\t\t\tlayer[propName] = propValue;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Otherwise, set given value\n\t\t\t\t\t\tlayer[propName] = propValue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Update layer events\n\t\t\t_addLayerEvents($canvas, data, layer);\n\t\t\t_enableDrag($canvas, data, layer);\n\n\t\t\t// If layer's properties were changed\n\t\t\tif ($.isEmptyObject(props) === false) {\n\t\t\t\t_triggerLayerEvent($canvas, data, layer, 'change', props);\n\t\t\t}\n\n\t\t}\n\t}\n\treturn $canvases;\n};\n\n// Set properties of all layers (optionally filtered by a callback)\n$.fn.setLayers = function setLayers(props, callback) {\n\tvar $canvases = this, $canvas, e,\n\t\tlayers, l;\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\t$canvas = $($canvases[e]);\n\n\t\tlayers = $canvas.getLayers(callback);\n\t\t// Loop through all layers\n\t\tfor (l = 0; l < layers.length; l += 1) {\n\t\t\t// Set properties of each layer\n\t\t\t$canvas.setLayer(layers[l], props);\n\t\t}\n\t}\n\treturn $canvases;\n};\n\n// Set properties of all layers in the given group\n$.fn.setLayerGroup = function setLayerGroup(groupId, props) {\n\tvar $canvases = this, $canvas, e,\n\t\tgroup, l;\n\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\t// Get layer group\n\t\t$canvas = $($canvases[e]);\n\n\t\tgroup = $canvas.getLayerGroup(groupId);\n\t\t// If group exists\n\t\tif (group) {\n\n\t\t\t// Loop through layers in group\n\t\t\tfor (l = 0; l < group.length; l += 1) {\n\t\t\t\t// Merge given properties with layer\n\t\t\t\t$canvas.setLayer(group[l], props);\n\t\t\t}\n\n\t\t}\n\t}\n\treturn $canvases;\n};\n\n// Move a layer to the given index in the layers array\n$.fn.moveLayer = function moveLayer(layerId, index) {\n\tvar $canvases = this, $canvas, e,\n\t\tdata, layers, layer;\n\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\t$canvas = $($canvases[e]);\n\t\tdata = _getCanvasData($canvases[e]);\n\n\t\t// Retrieve layers array and desired layer\n\t\tlayers = data.layers;\n\t\tlayer = $canvas.getLayer(layerId);\n\t\tif (layer) {\n\n\t\t\t// Ensure layer index is accurate\n\t\t\tlayer.index = inArray(layer, layers);\n\n\t\t\t// Remove layer from its current placement\n\t\t\tlayers.splice(layer.index, 1);\n\t\t\t// Add layer in its new placement\n\t\t\tlayers.splice(index, 0, layer);\n\n\t\t\t// Handle negative indices\n\t\t\tif (index < 0) {\n\t\t\t\tindex = layers.length + index;\n\t\t\t}\n\t\t\t// Update layer's stored index\n\t\t\tlayer.index = index;\n\n\t\t\t_triggerLayerEvent($canvas, data, layer, 'move');\n\n\t\t}\n\t}\n\treturn $canvases;\n};\n\n// Remove a jCanvas layer\n$.fn.removeLayer = function removeLayer(layerId) {\n\tvar $canvases = this, $canvas, e, data,\n\t\tlayers, layer;\n\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\t$canvas = $($canvases[e]);\n\t\tdata = _getCanvasData($canvases[e]);\n\n\t\t// Retrieve layers array and desired layer\n\t\tlayers = $canvas.getLayers();\n\t\tlayer = $canvas.getLayer(layerId);\n\t\t// Remove layer if found\n\t\tif (layer) {\n\n\t\t\t// Ensure layer index is accurate\n\t\t\tlayer.index = inArray(layer, layers);\n\t\t\t// Remove layer and allow it to be re-added later\n\t\t\tlayers.splice(layer.index, 1);\n\t\t\tdelete layer._layer;\n\n\t\t\t// Update layer name map\n\t\t\t_updateLayerName($canvas, data, layer, {\n\t\t\t\tname: null\n\t\t\t});\n\t\t\t// Update layer group map\n\t\t\t_updateLayerGroups($canvas, data, layer, {\n\t\t\t\tgroups: null\n\t\t\t});\n\n\t\t\t// Trigger 'remove' event\n\t\t\t_triggerLayerEvent($canvas, data, layer, 'remove');\n\n\t\t}\n\t}\n\treturn $canvases;\n};\n\n// Remove all layers\n$.fn.removeLayers = function removeLayers(callback) {\n\tvar $canvases = this, $canvas, e,\n\t\tdata, layers, layer, l;\n\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\t$canvas = $($canvases[e]);\n\t\tdata = _getCanvasData($canvases[e]);\n\t\tlayers = $canvas.getLayers(callback).slice(0);\n\t\t// Remove all layers individually\n\t\tfor (l = 0; l < layers.length; l += 1) {\n\t\t\tlayer = layers[l];\n\t\t\t$canvas.removeLayer(layer);\n\t\t}\n\t\t// Update layer maps\n\t\tdata.layer.names = {};\n\t\tdata.layer.groups = {};\n\t}\n\treturn $canvases;\n};\n\n// Remove all layers in the group with the given ID\n$.fn.removeLayerGroup = function removeLayerGroup(groupId) {\n\tvar $canvases = this, $canvas, e, group, l;\n\n\tif (groupId !== undefined) {\n\t\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\t\t$canvas = $($canvases[e]);\n\n\t\t\tgroup = $canvas.getLayerGroup(groupId);\n\t\t\t// Remove layer group using given group name\n\t\t\tif (group) {\n\n\t\t\t\t// Clone groups array\n\t\t\t\tgroup = group.slice(0);\n\n\t\t\t\t// Loop through layers in group\n\t\t\t\tfor (l = 0; l < group.length; l += 1) {\n\t\t\t\t\t$canvas.removeLayer(group[l]);\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t}\n\treturn $canvases;\n};\n\n// Add an existing layer to a layer group\n$.fn.addLayerToGroup = function addLayerToGroup(layerId, groupName) {\n\tvar $canvases = this, $canvas, e,\n\t\tlayer, groups = [groupName];\n\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\t$canvas = $($canvases[e]);\n\t\tlayer = $canvas.getLayer(layerId);\n\n\t\t// If layer is not already in group\n\t\tif (layer.groups) {\n\t\t\t// Clone groups list\n\t\t\tgroups = layer.groups.slice(0);\n\t\t\t// If layer is not already in group\n\t\t\tif (inArray(groupName, layer.groups) === -1) {\n\t\t\t\t// Add layer to group\n\t\t\t\tgroups.push(groupName);\n\t\t\t}\n\t\t}\n\t\t// Update layer group maps\n\t\t$canvas.setLayer(layer, {\n\t\t\tgroups: groups\n\t\t});\n\n\t}\n\treturn $canvases;\n};\n\n// Remove an existing layer from a layer group\n$.fn.removeLayerFromGroup = function removeLayerFromGroup(layerId, groupName) {\n\tvar $canvases = this, $canvas, e,\n\t\tlayer, groups = [],\n\t\tindex;\n\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\t$canvas = $($canvases[e]);\n\t\tlayer = $canvas.getLayer(layerId);\n\n\t\tif (layer.groups) {\n\n\t\t\t// Find index of layer in group\n\t\t\tindex = inArray(groupName, layer.groups);\n\n\t\t\t// If layer is in group\n\t\t\tif (index !== -1) {\n\n\t\t\t\t// Clone groups list\n\t\t\t\tgroups = layer.groups.slice(0);\n\n\t\t\t\t// Remove layer from group\n\t\t\t\tgroups.splice(index, 1);\n\n\t\t\t\t// Update layer group maps\n\t\t\t\t$canvas.setLayer(layer, {\n\t\t\t\t\tgroups: groups\n\t\t\t\t});\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\treturn $canvases;\n};\n\n// Get topmost layer that intersects with event coordinates\nfunction _getIntersectingLayer(data) {\n\tvar layer, i,\n\t\tmask, m;\n\n\t// Store the topmost layer\n\tlayer = null;\n\n\t// Get the topmost layer whose visible area intersects event coordinates\n\tfor (i = data.intersecting.length - 1; i >= 0; i -= 1) {\n\n\t\t// Get current layer\n\t\tlayer = data.intersecting[i];\n\n\t\t// If layer has previous masks\n\t\tif (layer._masks) {\n\n\t\t\t// Search previous masks to ensure\n\t\t\t// layer is visible at event coordinates\n\t\t\tfor (m = layer._masks.length - 1; m >= 0; m -= 1) {\n\t\t\t\tmask = layer._masks[m];\n\t\t\t\t// If mask does not intersect event coordinates\n\t\t\t\tif (!mask.intersects) {\n\t\t\t\t\t// Indicate that the mask does not\n\t\t\t\t\t// intersect event coordinates\n\t\t\t\t\tlayer.intersects = false;\n\t\t\t\t\t// Stop searching previous masks\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// If event coordinates intersect all previous masks\n\t\t\t// and layer is not intangible\n\t\t\tif (layer.intersects && !layer.intangible) {\n\t\t\t\t// Stop searching for topmost layer\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t}\n\n\t}\n\t// If resulting layer is intangible\n\tif (layer && layer.intangible) {\n\t\t// Cursor does not intersect this layer\n\t\tlayer = null;\n\t}\n\treturn layer;\n}\n\n// Draw individual layer (internal)\nfunction _drawLayer($canvas, ctx, layer, nextLayerIndex) {\n\tif (layer && layer.visible && layer._method) {\n\t\tif (nextLayerIndex) {\n\t\t\tlayer._next = nextLayerIndex;\n\t\t} else {\n\t\t\tlayer._next = null;\n\t\t}\n\t\t// If layer is an object, call its respective method\n\t\tif (layer._method) {\n\t\t\tlayer._method.call($canvas, layer);\n\t\t}\n\t}\n}\n\n// Handle dragging of the currently-dragged layer\nfunction _handleLayerDrag($canvas, data, eventType) {\n\tvar layers, layer, l,\n\t\tdrag, dragGroups,\n\t\tgroup, groupName, g,\n\t\tnewX, newY;\n\n\tdrag = data.drag;\n\tlayer = drag.layer;\n\tdragGroups = (layer && layer.dragGroups) || [];\n\tlayers = data.layers;\n\n\tif (eventType === 'mousemove' || eventType === 'touchmove') {\n\t\t// Detect when user is currently dragging layer\n\n\t\tif (!drag.dragging) {\n\t\t\t// Detect when user starts dragging layer\n\n\t\t\t// Signify that a layer on the canvas is being dragged\n\t\t\tdrag.dragging = true;\n\t\t\tlayer.dragging = true;\n\n\t\t\t// Optionally bring layer to front when drag starts\n\t\t\tif (layer.bringToFront) {\n\t\t\t\t// Remove layer from its original position\n\t\t\t\tlayers.splice(layer.index, 1);\n\t\t\t\t// Bring layer to front\n\t\t\t\t// push() returns the new array length\n\t\t\t\tlayer.index = layers.push(layer);\n\t\t\t}\n\n\t\t\t// Set drag properties for this layer\n\t\t\tlayer._startX = layer.x;\n\t\t\tlayer._startY = layer.y;\n\t\t\tlayer._endX = layer._eventX;\n\t\t\tlayer._endY = layer._eventY;\n\n\t\t\t// Trigger dragstart event\n\t\t\t_triggerLayerEvent($canvas, data, layer, 'dragstart');\n\n\t\t}\n\n\t\tif (drag.dragging) {\n\n\t\t\t// Calculate position after drag\n\t\t\tnewX = layer._eventX - (layer._endX - layer._startX);\n\t\t\tnewY = layer._eventY - (layer._endY - layer._startY);\n\t\t\tif (layer.updateDragX) {\n\t\t\t\tnewX = layer.updateDragX.call($canvas[0], layer, newX);\n\t\t\t}\n\t\t\tif (layer.updateDragY) {\n\t\t\t\tnewY = layer.updateDragY.call($canvas[0], layer, newY);\n\t\t\t}\n\t\t\tlayer.dx = newX - layer.x;\n\t\t\tlayer.dy = newY - layer.y;\n\t\t\tif (layer.restrictDragToAxis !== 'y') {\n\t\t\t\tlayer.x = newX;\n\t\t\t}\n\t\t\tif (layer.restrictDragToAxis !== 'x') {\n\t\t\t\tlayer.y = newY;\n\t\t\t}\n\n\t\t\t// Trigger drag event\n\t\t\t_triggerLayerEvent($canvas, data, layer, 'drag');\n\n\t\t\t// Move groups with layer on drag\n\t\t\tfor (g = 0; g < dragGroups.length; g += 1) {\n\n\t\t\t\tgroupName = dragGroups[g];\n\t\t\t\tgroup = data.layer.groups[groupName];\n\t\t\t\tif (layer.groups && group) {\n\n\t\t\t\t\tfor (l = 0; l < group.length; l += 1) {\n\t\t\t\t\t\tif (group[l] !== layer) {\n\t\t\t\t\t\t\tif (layer.restrictDragToAxis !== 'y' && group[l].restrictDragToAxis !== 'y') {\n\t\t\t\t\t\t\t\tgroup[l].x += layer.dx;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (layer.restrictDragToAxis !== 'x' && group[l].restrictDragToAxis !== 'x') {\n\t\t\t\t\t\t\t\tgroup[l].y += layer.dy;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t} else if (eventType === 'mouseup' || eventType === 'touchend') {\n\t\t// Detect when user stops dragging layer\n\n\t\tif (drag.dragging) {\n\t\t\tlayer.dragging = false;\n\t\t\tdrag.dragging = false;\n\t\t\tdata.redrawOnMousemove = data.originalRedrawOnMousemove;\n\t\t\t// Trigger dragstop event\n\t\t\t_triggerLayerEvent($canvas, data, layer, 'dragstop');\n\t\t}\n\n\t\t// Cancel dragging\n\t\tdata.drag = {};\n\n\t}\n}\n\n\n// List of CSS3 cursors that need to be prefixed\ncss.cursors = ['grab', 'grabbing', 'zoom-in', 'zoom-out'];\n\n// Function to detect vendor prefix\n// Modified version of David Walsh's implementation\n// https://davidwalsh.name/vendor-prefix\ncss.prefix = (function () {\n\tvar styles = getComputedStyle(document.documentElement, ''),\n\t\tpre = (arraySlice\n\t\t\t.call(styles)\n\t\t\t.join('')\n\t\t\t.match(/-(moz|webkit|ms)-/) || (styles.OLink === '' && ['', 'o'])\n\t\t)[1];\n\treturn '-' + pre + '-';\n})();\n\n// Set cursor on canvas\nfunction _setCursor($canvas, layer, eventType) {\n\tvar cursor;\n\tif (layer.cursors) {\n\t\t// Retrieve cursor from cursors object if it exists\n\t\tcursor = layer.cursors[eventType];\n\t}\n\t// Prefix any CSS3 cursor\n\tif ($.inArray(cursor, css.cursors) !== -1) {\n\t\tcursor = css.prefix + cursor;\n\t}\n\t// If cursor is defined\n\tif (cursor) {\n\t\t// Set canvas cursor\n\t\t$canvas.css({\n\t\t\tcursor: cursor\n\t\t});\n\t}\n}\n\n// Reset cursor on canvas\nfunction _resetCursor($canvas, data) {\n\t$canvas.css({\n\t\tcursor: data.cursor\n\t});\n}\n\n// Run the given event callback with the given arguments\nfunction _runEventCallback($canvas, layer, eventType, callbacks, arg) {\n\t// Prevent callback from firing recursively\n\tif (callbacks[eventType] && layer._running && !layer._running[eventType]) {\n\t\t// Signify the start of callback execution for this event\n\t\tlayer._running[eventType] = true;\n\t\t// Run event callback with the given arguments\n\t\tcallbacks[eventType].call($canvas[0], layer, arg);\n\t\t// Signify the end of callback execution for this event\n\t\tlayer._running[eventType] = false;\n\t}\n}\n\n// Determine if the given layer can \"legally\" fire the given event\nfunction _layerCanFireEvent(layer, eventType) {\n\t// If events are disable and if\n\t// layer is tangible or event is not tangible\n\treturn (!layer.disableEvents &&\n\t\t(!layer.intangible || $.inArray(eventType, tangibleEvents) === -1));\n}\n\n// Trigger the given event on the given layer\nfunction _triggerLayerEvent($canvas, data, layer, eventType, arg) {\n\t// If layer can legally fire this event type\n\tif (_layerCanFireEvent(layer, eventType)) {\n\n\t\t// Do not set a custom cursor on layer mouseout\n\t\tif (eventType !== 'mouseout') {\n\t\t\t// Update cursor if one is defined for this event\n\t\t\t_setCursor($canvas, layer, eventType);\n\t\t}\n\n\t\t// Trigger the user-defined event callback\n\t\t_runEventCallback($canvas, layer, eventType, layer, arg);\n\t\t// Trigger the canvas-bound event hook\n\t\t_runEventCallback($canvas, layer, eventType, data.eventHooks, arg);\n\t\t// Trigger the global event hook\n\t\t_runEventCallback($canvas, layer, eventType, jCanvas.eventHooks, arg);\n\n\t}\n}\n\n// Manually trigger a layer event\n$.fn.triggerLayerEvent = function (layer, eventType) {\n\tvar $canvases = this, $canvas, e,\n\t\tdata;\n\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\t$canvas = $($canvases[e]);\n\t\tdata = _getCanvasData($canvases[e]);\n\t\tlayer = $canvas.getLayer(layer);\n\t\tif (layer) {\n\t\t\t_triggerLayerEvent($canvas, data, layer, eventType);\n\t\t}\n\t}\n\treturn $canvases;\n};\n\n// Draw layer with the given ID\n$.fn.drawLayer = function drawLayer(layerId) {\n\tvar $canvases = this, e, ctx,\n\t\t$canvas, layer;\n\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\t$canvas = $($canvases[e]);\n\t\tctx = _getContext($canvases[e]);\n\t\tif (ctx) {\n\t\t\tlayer = $canvas.getLayer(layerId);\n\t\t\t_drawLayer($canvas, ctx, layer);\n\t\t}\n\t}\n\treturn $canvases;\n};\n\n// Draw all layers (or, if given, only layers starting at an index)\n$.fn.drawLayers = function drawLayers(args) {\n\tvar $canvases = this, $canvas, e, ctx,\n\t\t// Internal parameters for redrawing the canvas\n\t\tparams = args || {},\n\t\t// Other variables\n\t\tlayers, layer, lastLayer, l, index, lastIndex,\n\t\tdata, eventCache, eventType, isImageLayer;\n\n\t// The layer index from which to start redrawing the canvas\n\tindex = params.index;\n\tif (!index) {\n\t\tindex = 0;\n\t}\n\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\t$canvas = $($canvases[e]);\n\t\tctx = _getContext($canvases[e]);\n\t\tif (ctx) {\n\n\t\t\tdata = _getCanvasData($canvases[e]);\n\n\t\t\t// Clear canvas first unless otherwise directed\n\t\t\tif (params.clear !== false) {\n\t\t\t\t$canvas.clearCanvas();\n\t\t\t}\n\n\t\t\t// If a completion callback was provided, save it to the canvas data\n\t\t\t// store so that the function can be passed to drawLayers() again\n\t\t\t// after any image layers have loaded\n\t\t\tif (params.complete) {\n\t\t\t\tdata.drawLayersComplete = params.complete;\n\t\t\t}\n\n\t\t\t// Cache the layers array\n\t\t\tlayers = data.layers;\n\n\t\t\t// Draw layers from first to last (bottom to top)\n\t\t\tfor (l = index; l < layers.length; l += 1) {\n\t\t\t\tlayer = layers[l];\n\n\t\t\t\t// Ensure layer index is up-to-date\n\t\t\t\tlayer.index = l;\n\n\t\t\t\t// Prevent any one event from firing excessively\n\t\t\t\tif (params.resetFire) {\n\t\t\t\t\tlayer._fired = false;\n\t\t\t\t}\n\t\t\t\t// Draw layer\n\t\t\t\t_drawLayer($canvas, ctx, layer, l + 1);\n\t\t\t\t// Store list of previous masks for each layer\n\t\t\t\tlayer._masks = data.transforms.masks.slice(0);\n\n\t\t\t\t// Allow image layers to load before drawing successive layers\n\t\t\t\tif (layer._method === $.fn.drawImage && layer.visible) {\n\t\t\t\t\tisImageLayer = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// If layer is an image layer\n\t\t\tif (isImageLayer) {\n\t\t\t\t// Stop and wait for drawImage() to resume drawLayers()\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Store the latest\n\t\t\tlastIndex = l;\n\n\t\t\t// Run completion callback (if provided) once all layers have drawn\n\t\t\tif (params.complete) {\n\t\t\t\tparams.complete.call($canvases[e]);\n\t\t\t\tdelete data.drawLayersComplete;\n\t\t\t}\n\n\t\t\t// Get first layer that intersects with event coordinates\n\t\t\tlayer = _getIntersectingLayer(data);\n\n\t\t\teventCache = data.event;\n\t\t\teventType = eventCache.type;\n\n\t\t\t// If jCanvas has detected a dragstart\n\t\t\tif (data.drag.layer) {\n\t\t\t\t// Handle dragging of layer\n\t\t\t\t_handleLayerDrag($canvas, data, eventType);\n\t\t\t}\n\n\t\t\t// Manage mouseout event\n\t\t\tlastLayer = data.lastIntersected;\n\t\t\tif (lastLayer !== null && layer !== lastLayer && lastLayer._hovered && !lastLayer._fired && !data.drag.dragging) {\n\n\t\t\t\tdata.lastIntersected = null;\n\t\t\t\tlastLayer._fired = true;\n\t\t\t\tlastLayer._hovered = false;\n\t\t\t\t_triggerLayerEvent($canvas, data, lastLayer, 'mouseout');\n\t\t\t\t_resetCursor($canvas, data);\n\n\t\t\t}\n\n\t\t\tif (layer) {\n\n\t\t\t\t// Use mouse event callbacks if no touch event callbacks are given\n\t\t\t\tif (!layer[eventType]) {\n\t\t\t\t\teventType = _getMouseEventName(eventType);\n\t\t\t\t}\n\n\t\t\t\t// Check events for intersecting layer\n\t\t\t\tif (layer._event && layer.intersects) {\n\n\t\t\t\t\tdata.lastIntersected = layer;\n\n\t\t\t\t\t// Detect mouseover events\n\t\t\t\t\tif ((layer.mouseover || layer.mouseout || layer.cursors) && !data.drag.dragging) {\n\n\t\t\t\t\t\tif (!layer._hovered && !layer._fired) {\n\n\t\t\t\t\t\t\t// Prevent events from firing excessively\n\t\t\t\t\t\t\tlayer._fired = true;\n\t\t\t\t\t\t\tlayer._hovered = true;\n\t\t\t\t\t\t\t_triggerLayerEvent($canvas, data, layer, 'mouseover');\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// Detect any other mouse event\n\t\t\t\t\tif (!layer._fired) {\n\n\t\t\t\t\t\t// Prevent event from firing twice unintentionally\n\t\t\t\t\t\tlayer._fired = true;\n\t\t\t\t\t\teventCache.type = null;\n\n\t\t\t\t\t\t_triggerLayerEvent($canvas, data, layer, eventType);\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// Use the mousedown event to start drag\n\t\t\t\t\tif (layer.draggable && !layer.disableEvents && (eventType === 'mousedown' || eventType === 'touchstart')) {\n\n\t\t\t\t\t\t// Keep track of drag state\n\t\t\t\t\t\tdata.drag.layer = layer;\n\t\t\t\t\t\tdata.originalRedrawOnMousemove = data.redrawOnMousemove;\n\t\t\t\t\t\tdata.redrawOnMousemove = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// If cursor is not intersecting with any layer\n\t\t\tif (layer === null && !data.drag.dragging) {\n\t\t\t\t// Reset cursor to previous state\n\t\t\t\t_resetCursor($canvas, data);\n\t\t\t}\n\n\t\t\t// If the last layer has been drawn\n\t\t\tif (lastIndex === layers.length) {\n\n\t\t\t\t// Reset list of intersecting layers\n\t\t\t\tdata.intersecting.length = 0;\n\t\t\t\t// Reset transformation stack\n\t\t\t\tdata.transforms = _cloneTransforms(baseTransforms);\n\t\t\t\tdata.savedTransforms.length = 0;\n\n\t\t\t}\n\n\t\t}\n\t}\n\treturn $canvases;\n};\n\n// Add a jCanvas layer (internal)\nfunction _addLayer(canvas, params, args, method) {\n\tvar $canvas, data,\n\t\tlayers, layer = (params._layer ? args : params);\n\n\t// Store arguments object for later use\n\tparams._args = args;\n\n\t// Convert all draggable drawings into jCanvas layers\n\tif (params.draggable || params.dragGroups) {\n\t\tparams.layer = true;\n\t\tparams.draggable = true;\n\t}\n\n\t// Determine the layer's type using the available information\n\tif (!params._method) {\n\t\tif (method) {\n\t\t\tparams._method = method;\n\t\t} else if (params.method) {\n\t\t\tparams._method = $.fn[params.method];\n\t\t} else if (params.type) {\n\t\t\tparams._method = $.fn[maps.drawings[params.type]];\n\t\t}\n\t}\n\n\t// If layer hasn't been added yet\n\tif (params.layer && !params._layer) {\n\t\t// Add layer to canvas\n\n\t\t$canvas = $(canvas);\n\n\t\tdata = _getCanvasData(canvas);\n\t\tlayers = data.layers;\n\n\t\t// Do not add duplicate layers of same name\n\t\tif (layer.name === null || (isString(layer.name) && data.layer.names[layer.name] === undefined)) {\n\n\t\t\t// Convert number properties to numbers\n\t\t\t_coerceNumericProps(params);\n\n\t\t\t// Ensure layers are unique across canvases by cloning them\n\t\t\tlayer = new jCanvasObject(params);\n\t\t\tlayer.canvas = canvas;\n\t\t\t// Indicate that this is a layer for future checks\n\t\t\tlayer.layer = true;\n\t\t\tlayer._layer = true;\n\t\t\tlayer._running = {};\n\t\t\t// If layer stores user-defined data\n\t\t\tif (layer.data !== null) {\n\t\t\t\t// Clone object\n\t\t\t\tlayer.data = extendObject({}, layer.data);\n\t\t\t} else {\n\t\t\t\t// Otherwise, create data object\n\t\t\t\tlayer.data = {};\n\t\t\t}\n\t\t\t// If layer stores a list of associated groups\n\t\t\tif (layer.groups !== null) {\n\t\t\t\t// Clone list\n\t\t\t\tlayer.groups = layer.groups.slice(0);\n\t\t\t} else {\n\t\t\t\t// Otherwise, create empty list\n\t\t\t\tlayer.groups = [];\n\t\t\t}\n\n\t\t\t// Update layer group maps\n\t\t\t_updateLayerName($canvas, data, layer);\n\t\t\t_updateLayerGroups($canvas, data, layer);\n\n\t\t\t// Check for any associated jCanvas events and enable them\n\t\t\t_addLayerEvents($canvas, data, layer);\n\n\t\t\t// Optionally enable drag-and-drop support and cursor support\n\t\t\t_enableDrag($canvas, data, layer);\n\n\t\t\t// Copy _event property to parameters object\n\t\t\tparams._event = layer._event;\n\n\t\t\t// Calculate width/height for text layers\n\t\t\tif (layer._method === $.fn.drawText) {\n\t\t\t\t$canvas.measureText(layer);\n\t\t\t}\n\n\t\t\t// Add layer to end of array if no index is specified\n\t\t\tif (layer.index === null) {\n\t\t\t\tlayer.index = layers.length;\n\t\t\t}\n\n\t\t\t// Add layer to layers array at specified index\n\t\t\tlayers.splice(layer.index, 0, layer);\n\n\t\t\t// Store layer on parameters object\n\t\t\tparams._args = layer;\n\n\t\t\t// Trigger an 'add' event\n\t\t\t_triggerLayerEvent($canvas, data, layer, 'add');\n\n\t\t}\n\n\t} else if (!params.layer) {\n\t\t_coerceNumericProps(params);\n\t}\n\n\treturn layer;\n}\n\n// Add a jCanvas layer\n$.fn.addLayer = function addLayer(args) {\n\tvar $canvases = this, e, ctx,\n\t\tparams;\n\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\tctx = _getContext($canvases[e]);\n\t\tif (ctx) {\n\n\t\t\tparams = new jCanvasObject(args);\n\t\t\tparams.layer = true;\n\t\t\t_addLayer($canvases[e], params, args);\n\n\t\t}\n\t}\n\treturn $canvases;\n};\n\n/* Animation API */\n\n// Define properties used in both CSS and jCanvas\ncss.props = [\n\t'width',\n\t'height',\n\t'opacity',\n\t'lineHeight'\n];\ncss.propsObj = {};\n\n// Hide/show jCanvas/CSS properties so they can be animated using jQuery\nfunction _showProps(obj) {\n\tvar cssProp, p;\n\tfor (p = 0; p < css.props.length; p += 1) {\n\t\tcssProp = css.props[p];\n\t\tobj[cssProp] = obj['_' + cssProp];\n\t}\n}\nfunction _hideProps(obj, reset) {\n\tvar cssProp, p;\n\tfor (p = 0; p < css.props.length; p += 1) {\n\t\tcssProp = css.props[p];\n\t\t// Hide property using same name with leading underscore\n\t\tif (obj[cssProp] !== undefined) {\n\t\t\tobj['_' + cssProp] = obj[cssProp];\n\t\t\tcss.propsObj[cssProp] = true;\n\t\t\tif (reset) {\n\t\t\t\tdelete obj[cssProp];\n\t\t\t}\n\t\t}\n\t}\n}\n\n// Evaluate property values that are functions\nfunction _parseEndValues(canvas, layer, endValues) {\n\tvar propName, propValue,\n\t\tsubPropName, subPropValue;\n\t// Loop through all properties in map of end values\n\tfor (propName in endValues) {\n\t\tif (Object.prototype.hasOwnProperty.call(endValues, propName)) {\n\t\t\tpropValue = endValues[propName];\n\t\t\t// If end value is function\n\t\t\tif (isFunction(propValue)) {\n\t\t\t\t// Call function and use its value as the end value\n\t\t\t\tendValues[propName] = propValue.call(canvas, layer, propName);\n\t\t\t}\n\t\t\t// If end value is an object\n\t\t\tif (typeOf(propValue) === 'object' && isPlainObject(propValue)) {\n\t\t\t\t// Prepare to animate properties in object\n\t\t\t\tfor (subPropName in propValue) {\n\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(propValue, subPropName)) {\n\t\t\t\t\t\tsubPropValue = propValue[subPropName];\n\t\t\t\t\t\t// Store property's start value at top-level of layer\n\t\t\t\t\t\tif (layer[propName] !== undefined) {\n\t\t\t\t\t\t\tlayer[propName + '.' + subPropName] = layer[propName][subPropName];\n\t\t\t\t\t\t\t// Store property's end value at top-level of end values map\n\t\t\t\t\t\t\tendValues[propName + '.' + subPropName] = subPropValue;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// Delete sub-property of object as it's no longer needed\n\t\t\t\tdelete endValues[propName];\n\t\t\t}\n\t\t}\n\t}\n\treturn endValues;\n}\n\n// Remove sub-property aliases from layer object\nfunction _removeSubPropAliases(layer) {\n\tvar propName;\n\tfor (propName in layer) {\n\t\tif (Object.prototype.hasOwnProperty.call(layer, propName)) {\n\t\t\tif (propName.indexOf('.') !== -1) {\n\t\t\t\tdelete layer[propName];\n\t\t\t}\n\t\t}\n\t}\n}\n\n// Convert a color value to an array of RGB values\nfunction _colorToRgbArray(color) {\n\tvar originalColor, elem,\n\t\trgb = [],\n\t\tmultiple = 1;\n\n\t// Deal with complete transparency\n\tif (color === 'transparent') {\n\t\tcolor = 'rgba(0, 0, 0, 0)';\n\t} else if (color.match(/^([a-z]+|#[0-9a-f]+)$/gi)) {\n\t\t// Deal with hexadecimal colors and color names\n\t\telem = document.head;\n\t\toriginalColor = elem.style.color;\n\t\telem.style.color = color;\n\t\tcolor = $.css(elem, 'color');\n\t\telem.style.color = originalColor;\n\t}\n\t// Parse RGB string\n\tif (color.match(/^rgb/gi)) {\n\t\trgb = color.match(/(\\d+(\\.\\d+)?)/gi);\n\t\t// Deal with RGB percentages\n\t\tif (color.match(/%/gi)) {\n\t\t\tmultiple = 2.55;\n\t\t}\n\t\trgb[0] *= multiple;\n\t\trgb[1] *= multiple;\n\t\trgb[2] *= multiple;\n\t\t// Ad alpha channel if given\n\t\tif (rgb[3] !== undefined) {\n\t\t\trgb[3] = parseFloat(rgb[3]);\n\t\t} else {\n\t\t\trgb[3] = 1;\n\t\t}\n\t}\n\treturn rgb;\n}\n\n// Animate a hex or RGB color\nfunction _animateColor(fx) {\n\tvar n = 3,\n\t\ti;\n\t// Only parse start and end colors once\n\tif (typeOf(fx.start) !== 'array') {\n\t\tfx.start = _colorToRgbArray(fx.start);\n\t\tfx.end = _colorToRgbArray(fx.end);\n\t}\n\tfx.now = [];\n\n\t// If colors are RGBA, animate transparency\n\tif (fx.start[3] !== 1 || fx.end[3] !== 1) {\n\t\tn = 4;\n\t}\n\n\t// Calculate current frame for red, green, blue, and alpha\n\tfor (i = 0; i < n; i += 1) {\n\t\tfx.now[i] = fx.start[i] + ((fx.end[i] - fx.start[i]) * fx.pos);\n\t\t// Only the red, green, and blue values must be integers\n\t\tif (i < 3) {\n\t\t\tfx.now[i] = round(fx.now[i]);\n\t\t}\n\t}\n\tif (fx.start[3] !== 1 || fx.end[3] !== 1) {\n\t\t// Only use RGBA if RGBA colors are given\n\t\tfx.now = 'rgba(' + fx.now.join(',') + ')';\n\t} else {\n\t\t// Otherwise, animate as solid colors\n\t\tfx.now.slice(0, 3);\n\t\tfx.now = 'rgb(' + fx.now.join(',') + ')';\n\t}\n\t// Animate colors for both canvas layers and DOM elements\n\tif (fx.elem.nodeName) {\n\t\tfx.elem.style[fx.prop] = fx.now;\n\t} else {\n\t\tfx.elem[fx.prop] = fx.now;\n\t}\n}\n\n// Animate jCanvas layer\n$.fn.animateLayer = function animateLayer() {\n\tvar $canvases = this, $canvas, e, ctx,\n\t\targs = arraySlice.call(arguments, 0),\n\t\tdata, layer, props;\n\n\t// Deal with all cases of argument placement\n\t/*\n\t\t0. layer name/index\n\t\t1. properties\n\t\t2. duration/options\n\t\t3. easing\n\t\t4. complete function\n\t\t5. step function\n\t*/\n\n\tif (typeOf(args[2]) === 'object') {\n\n\t\t// Accept an options object for animation\n\t\targs.splice(2, 0, args[2].duration || null);\n\t\targs.splice(3, 0, args[3].easing || null);\n\t\targs.splice(4, 0, args[4].complete || null);\n\t\targs.splice(5, 0, args[5].step || null);\n\n\t} else {\n\n\t\tif (args[2] === undefined) {\n\t\t\t// If object is the last argument\n\t\t\targs.splice(2, 0, null);\n\t\t\targs.splice(3, 0, null);\n\t\t\targs.splice(4, 0, null);\n\t\t} else if (isFunction(args[2])) {\n\t\t\t// If callback comes after object\n\t\t\targs.splice(2, 0, null);\n\t\t\targs.splice(3, 0, null);\n\t\t}\n\t\tif (args[3] === undefined) {\n\t\t\t// If duration is the last argument\n\t\t\targs[3] = null;\n\t\t\targs.splice(4, 0, null);\n\t\t} else if (isFunction(args[3])) {\n\t\t\t// If callback comes after duration\n\t\t\targs.splice(3, 0, null);\n\t\t}\n\n\t}\n\n\t// Run callback function when animation completes\n\tfunction complete($canvas, data, layer) {\n\n\t\treturn function () {\n\n\t\t\t_showProps(layer);\n\t\t\t_removeSubPropAliases(layer);\n\n\t\t\t// Prevent multiple redraw loops\n\t\t\tif (!data.animating || data.animated === layer) {\n\t\t\t\t// Redraw layers on last frame\n\t\t\t\t$canvas.drawLayers();\n\t\t\t}\n\n\t\t\t// Signify the end of an animation loop\n\t\t\tlayer._animating = false;\n\t\t\tdata.animating = false;\n\t\t\tdata.animated = null;\n\n\t\t\t// If callback is defined\n\t\t\tif (args[4]) {\n\t\t\t\t// Run callback at the end of the animation\n\t\t\t\targs[4].call($canvas[0], layer);\n\t\t\t}\n\n\t\t\t_triggerLayerEvent($canvas, data, layer, 'animateend');\n\n\t\t};\n\n\t}\n\n\t// Redraw layers on every frame of the animation\n\tfunction step($canvas, data, layer) {\n\n\t\treturn function (now, fx) {\n\t\t\tvar parts, propName, subPropName,\n\t\t\t\thidden = false;\n\n\t\t\t// If animated property has been hidden\n\t\t\tif (fx.prop[0] === '_') {\n\t\t\t\thidden = true;\n\t\t\t\t// Unhide property temporarily\n\t\t\t\tfx.prop = fx.prop.replace('_', '');\n\t\t\t\tlayer[fx.prop] = layer['_' + fx.prop];\n\t\t\t}\n\n\t\t\t// If animating property of sub-object\n\t\t\tif (fx.prop.indexOf('.') !== -1) {\n\t\t\t\tparts = fx.prop.split('.');\n\t\t\t\tpropName = parts[0];\n\t\t\t\tsubPropName = parts[1];\n\t\t\t\tif (layer[propName]) {\n\t\t\t\t\tlayer[propName][subPropName] = fx.now;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Throttle animation to improve efficiency\n\t\t\tif (layer._pos !== fx.pos) {\n\n\t\t\t\tlayer._pos = fx.pos;\n\n\t\t\t\t// Signify the start of an animation loop\n\t\t\t\tif (!layer._animating && !data.animating) {\n\t\t\t\t\tlayer._animating = true;\n\t\t\t\t\tdata.animating = true;\n\t\t\t\t\tdata.animated = layer;\n\t\t\t\t}\n\n\t\t\t\t// Prevent multiple redraw loops\n\t\t\t\tif (!data.animating || data.animated === layer) {\n\t\t\t\t\t// Redraw layers for every frame\n\t\t\t\t\t$canvas.drawLayers();\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// If callback is defined\n\t\t\tif (args[5]) {\n\t\t\t\t// Run callback for each step of animation\n\t\t\t\targs[5].call($canvas[0], now, fx, layer);\n\t\t\t}\n\n\t\t\t_triggerLayerEvent($canvas, data, layer, 'animate', fx);\n\n\t\t\t// If property should be hidden during animation\n\t\t\tif (hidden) {\n\t\t\t\t// Hide property again\n\t\t\t\tfx.prop = '_' + fx.prop;\n\t\t\t}\n\n\t\t};\n\n\t}\n\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\t$canvas = $($canvases[e]);\n\t\tctx = _getContext($canvases[e]);\n\t\tif (ctx) {\n\n\t\t\tdata = _getCanvasData($canvases[e]);\n\n\t\t\t// If a layer object was passed, use it the layer to be animated\n\t\t\tlayer = $canvas.getLayer(args[0]);\n\n\t\t\t// Ignore layers that are functions\n\t\t\tif (layer && layer._method !== $.fn.draw) {\n\n\t\t\t\t// Do not modify original object\n\t\t\t\tprops = extendObject({}, args[1]);\n\n\t\t\t\tprops = _parseEndValues($canvases[e], layer, props);\n\n\t\t\t\t// Bypass jQuery CSS Hooks for CSS properties (width, opacity, etc.)\n\t\t\t\t_hideProps(props, true);\n\t\t\t\t_hideProps(layer);\n\n\t\t\t\t// Fix for jQuery's vendor prefixing support, which affects how width/height/opacity are animated\n\t\t\t\tlayer.style = css.propsObj;\n\n\t\t\t\t// Animate layer\n\t\t\t\t$(layer).animate(props, {\n\t\t\t\t\tduration: args[2],\n\t\t\t\t\teasing: ($.easing[args[3]] ? args[3] : null),\n\t\t\t\t\t// When animation completes\n\t\t\t\t\tcomplete: complete($canvas, data, layer),\n\t\t\t\t\t// Redraw canvas for every animation frame\n\t\t\t\t\tstep: step($canvas, data, layer)\n\t\t\t\t});\n\t\t\t\t_triggerLayerEvent($canvas, data, layer, 'animatestart');\n\t\t\t}\n\n\t\t}\n\t}\n\treturn $canvases;\n};\n\n// Animate all layers in a layer group\n$.fn.animateLayerGroup = function animateLayerGroup(groupId) {\n\tvar $canvases = this, $canvas, e,\n\t\targs = arraySlice.call(arguments, 0),\n\t\tgroup, l;\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\t$canvas = $($canvases[e]);\n\t\tgroup = $canvas.getLayerGroup(groupId);\n\t\tif (group) {\n\n\t\t\t// Animate all layers in the group\n\t\t\tfor (l = 0; l < group.length; l += 1) {\n\n\t\t\t\t// Replace first argument with layer\n\t\t\t\targs[0] = group[l];\n\t\t\t\t$canvas.animateLayer.apply($canvas, args);\n\n\t\t\t}\n\n\t\t}\n\t}\n\treturn $canvases;\n};\n\n// Delay layer animation by a given number of milliseconds\n$.fn.delayLayer = function delayLayer(layerId, duration) {\n\tvar $canvases = this, $canvas, e,\n\t\tdata, layer;\n\tduration = duration || 0;\n\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\t$canvas = $($canvases[e]);\n\t\tdata = _getCanvasData($canvases[e]);\n\t\tlayer = $canvas.getLayer(layerId);\n\t\t// If layer exists\n\t\tif (layer) {\n\t\t\t// Delay animation\n\t\t\t$(layer).delay(duration);\n\t\t\t_triggerLayerEvent($canvas, data, layer, 'delay');\n\t\t}\n\t}\n\treturn $canvases;\n};\n\n// Delay animation all layers in a layer group\n$.fn.delayLayerGroup = function delayLayerGroup(groupId, duration) {\n\tvar $canvases = this, $canvas, e,\n\t\tgroup, layer, l;\n\tduration = duration || 0;\n\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\t$canvas = $($canvases[e]);\n\n\t\tgroup = $canvas.getLayerGroup(groupId);\n\t\t// Delay all layers in the group\n\t\tif (group) {\n\n\t\t\tfor (l = 0; l < group.length; l += 1) {\n\t\t\t\t// Delay each layer in the group\n\t\t\t\tlayer = group[l];\n\t\t\t\t$canvas.delayLayer(layer, duration);\n\t\t\t}\n\n\t\t}\n\t}\n\treturn $canvases;\n};\n\n// Stop layer animation\n$.fn.stopLayer = function stopLayer(layerId, clearQueue) {\n\tvar $canvases = this, $canvas, e,\n\t\tdata, layer;\n\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\t$canvas = $($canvases[e]);\n\t\tdata = _getCanvasData($canvases[e]);\n\t\tlayer = $canvas.getLayer(layerId);\n\t\t// If layer exists\n\t\tif (layer) {\n\t\t\t// Stop animation\n\t\t\t$(layer).stop(clearQueue);\n\t\t\t_triggerLayerEvent($canvas, data, layer, 'stop');\n\t\t}\n\t}\n\treturn $canvases;\n};\n\n// Stop animation of all layers in a layer group\n$.fn.stopLayerGroup = function stopLayerGroup(groupId, clearQueue) {\n\tvar $canvases = this, $canvas, e,\n\t\tgroup, layer, l;\n\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\t$canvas = $($canvases[e]);\n\n\t\tgroup = $canvas.getLayerGroup(groupId);\n\t\t// Stop all layers in the group\n\t\tif (group) {\n\n\t\t\tfor (l = 0; l < group.length; l += 1) {\n\t\t\t\t// Stop each layer in the group\n\t\t\t\tlayer = group[l];\n\t\t\t\t$canvas.stopLayer(layer, clearQueue);\n\t\t\t}\n\n\t\t}\n\t}\n\treturn $canvases;\n};\n\n// Enable animation for color properties\nfunction _supportColorProps(props) {\n\tvar p;\n\tfor (p = 0; p < props.length; p += 1) {\n\t\t$.fx.step[props[p]] = _animateColor;\n\t}\n}\n\n// Enable animation for color properties\n_supportColorProps([\n\t'color',\n\t'backgroundColor',\n\t'borderColor',\n\t'borderTopColor',\n\t'borderRightColor',\n\t'borderBottomColor',\n\t'borderLeftColor',\n\t'fillStyle',\n\t'outlineColor',\n\t'strokeStyle',\n\t'shadowColor'\n]);\n\n/* Event API */\n\n// Map standard mouse events to touch events\nmaps.touchEvents = {\n\t'mousedown': 'touchstart',\n\t'mouseup': 'touchend',\n\t'mousemove': 'touchmove'\n};\n// Map standard touch events to mouse events\nmaps.mouseEvents = {\n\t'touchstart': 'mousedown',\n\t'touchend': 'mouseup',\n\t'touchmove': 'mousemove'\n};\n\n// Convert mouse event name to a corresponding touch event name (if possible)\nfunction _getTouchEventName(eventName) {\n\t// Detect touch event support\n\tif (maps.touchEvents[eventName]) {\n\t\teventName = maps.touchEvents[eventName];\n\t}\n\treturn eventName;\n}\n// Convert touch event name to a corresponding mouse event name\nfunction _getMouseEventName(eventName) {\n\tif (maps.mouseEvents[eventName]) {\n\t\teventName = maps.mouseEvents[eventName];\n\t}\n\treturn eventName;\n}\n\n// Bind event to jCanvas layer using standard jQuery events\nfunction _createEvent(eventName) {\n\n\tjCanvas.events[eventName] = function ($canvas, data) {\n\t\tvar helperEventName, touchEventName, eventCache;\n\n\t\t// Retrieve canvas's event cache\n\t\teventCache = data.event;\n\n\t\t// Both mouseover/mouseout events will be managed by a single mousemove event\n\t\thelperEventName = (eventName === 'mouseover' || eventName === 'mouseout') ? 'mousemove' : eventName;\n\t\ttouchEventName = _getTouchEventName(helperEventName);\n\n\t\tfunction eventCallback(event) {\n\t\t\t// Cache current mouse position and redraw layers\n\t\t\teventCache.x = event.offsetX;\n\t\t\teventCache.y = event.offsetY;\n\t\t\teventCache.type = helperEventName;\n\t\t\teventCache.event = event;\n\t\t\t// Redraw layers on every trigger of the event; don't redraw if at\n\t\t\t// least one layer is draggable and there are no layers with\n\t\t\t// explicit mouseover/mouseout/mousemove events\n\t\t\tif (event.type !== 'mousemove' || data.redrawOnMousemove || data.drag.dragging) {\n\t\t\t\t$canvas.drawLayers({\n\t\t\t\t\tresetFire: true\n\t\t\t\t});\n\t\t\t}\n\t\t\t// Prevent default event behavior\n\t\t\tevent.preventDefault();\n\t\t}\n\n\t\t// Ensure the event is not bound more than once\n\t\tif (!data.events[helperEventName]) {\n\t\t\t// Bind one canvas event which handles all layer events of that type\n\t\t\tif (touchEventName !== helperEventName) {\n\t\t\t\t$canvas.bind(helperEventName + '.jCanvas ' + touchEventName + '.jCanvas', eventCallback);\n\t\t\t} else {\n\t\t\t\t$canvas.bind(helperEventName + '.jCanvas', eventCallback);\n\t\t\t}\n\t\t\t// Prevent this event from being bound twice\n\t\t\tdata.events[helperEventName] = true;\n\t\t}\n\t};\n}\nfunction _createEvents(eventNames) {\n\tvar n;\n\tfor (n = 0; n < eventNames.length; n += 1) {\n\t\t_createEvent(eventNames[n]);\n\t}\n}\n// Populate jCanvas events object with some standard events\n_createEvents([\n\t'click',\n\t'dblclick',\n\t'mousedown',\n\t'mouseup',\n\t'mousemove',\n\t'mouseover',\n\t'mouseout',\n\t'touchstart',\n\t'touchmove',\n\t'touchend',\n\t'pointerdown',\n\t'pointermove',\n\t'pointerup',\n\t'contextmenu'\n]);\n\n// Check if event fires when a drawing is drawn\nfunction _detectEvents(canvas, ctx, params) {\n\tvar layer, data, eventCache, intersects,\n\t\ttransforms, x, y, angle;\n\n\t// Use the layer object stored by the given parameters object\n\tlayer = params._args;\n\t// Canvas must have event bindings\n\tif (layer) {\n\n\t\tdata = _getCanvasData(canvas);\n\t\teventCache = data.event;\n\t\tif (eventCache.x !== null && eventCache.y !== null) {\n\t\t\t// Respect user-defined pixel ratio\n\t\t\tx = eventCache.x * data.pixelRatio;\n\t\t\ty = eventCache.y * data.pixelRatio;\n\t\t\t// Determine if the given coordinates are in the current path\n\t\t\tintersects = ctx.isPointInPath(x, y) || (ctx.isPointInStroke && ctx.isPointInStroke(x, y));\n\t\t}\n\t\ttransforms = data.transforms;\n\n\t\t// Allow callback functions to retrieve the mouse coordinates\n\t\tlayer.eventX = eventCache.x;\n\t\tlayer.eventY = eventCache.y;\n\t\tlayer.event = eventCache.event;\n\n\t\t// Adjust coordinates to match current canvas transformation\n\n\t\t// Keep track of some transformation values\n\t\tangle = data.transforms.rotate;\n\t\tx = layer.eventX;\n\t\ty = layer.eventY;\n\n\t\tif (angle !== 0) {\n\t\t\t// Rotate coordinates if coordinate space has been rotated\n\t\t\tlayer._eventX = (x * cos(-angle)) - (y * sin(-angle));\n\t\t\tlayer._eventY = (y * cos(-angle)) + (x * sin(-angle));\n\t\t} else {\n\t\t\t// Otherwise, no calculations need to be made\n\t\t\tlayer._eventX = x;\n\t\t\tlayer._eventY = y;\n\t\t}\n\n\t\t// Scale coordinates\n\t\tlayer._eventX /= transforms.scaleX;\n\t\tlayer._eventY /= transforms.scaleY;\n\n\t\t// If layer intersects with cursor\n\t\tif (intersects) {\n\t\t\t// Add it to a list of layers that intersect with cursor\n\t\t\tdata.intersecting.push(layer);\n\t\t}\n\t\tlayer.intersects = Boolean(intersects);\n\t}\n}\n\n// Normalize offsetX and offsetY for all browsers\n$.event.fix = function (event) {\n\tvar offset, originalEvent, touches;\n\n\tevent = jQueryEventFix.call($.event, event);\n\toriginalEvent = event.originalEvent;\n\n\t// originalEvent does not exist for manually-triggered events\n\tif (originalEvent) {\n\n\t\ttouches = originalEvent.changedTouches;\n\n\t\t// If offsetX and offsetY are not supported, define them\n\t\tif (event.pageX !== undefined && event.offsetX === undefined) {\n\t\t\ttry {\n\t\t\t\toffset = $(event.currentTarget).offset();\n\t\t\t\tif (offset) {\n\t\t\t\t\tevent.offsetX = event.pageX - offset.left;\n\t\t\t\t\tevent.offsetY = event.pageY - offset.top;\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\t// Fail silently\n\t\t\t}\n\t\t} else if (touches) {\n\t\t\ttry {\n\t\t\t\t// Enable offsetX and offsetY for mobile devices\n\t\t\t\toffset = $(event.currentTarget).offset();\n\t\t\t\tif (offset) {\n\t\t\t\t\tevent.offsetX = touches[0].pageX - offset.left;\n\t\t\t\t\tevent.offsetY = touches[0].pageY - offset.top;\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\t// Fail silently\n\t\t\t}\n\t\t}\n\n\t}\n\treturn event;\n};\n\n/* Drawing API */\n\n// Map drawing names with their respective method names\nmaps.drawings = {\n\t'arc': 'drawArc',\n\t'bezier': 'drawBezier',\n\t'ellipse': 'drawEllipse',\n\t'function': 'draw',\n\t'image': 'drawImage',\n\t'line': 'drawLine',\n\t'path': 'drawPath',\n\t'polygon': 'drawPolygon',\n\t'slice': 'drawSlice',\n\t'quadratic': 'drawQuadratic',\n\t'rectangle': 'drawRect',\n\t'text': 'drawText',\n\t'vector': 'drawVector',\n\t'save': 'saveCanvas',\n\t'restore': 'restoreCanvas',\n\t'rotate': 'rotateCanvas',\n\t'scale': 'scaleCanvas',\n\t'translate': 'translateCanvas'\n};\n\n// Draws on canvas using a function\n$.fn.draw = function draw(args) {\n\tvar $canvases = this, e, ctx,\n\t\tparams = new jCanvasObject(args);\n\n\t// Draw using any other method\n\tif (maps.drawings[params.type] && params.type !== 'function') {\n\n\t\t$canvases[maps.drawings[params.type]](args);\n\n\t} else {\n\n\t\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\t\tctx = _getContext($canvases[e]);\n\t\t\tif (ctx) {\n\n\t\t\t\tparams = new jCanvasObject(args);\n\t\t\t\t_addLayer($canvases[e], params, args, draw);\n\t\t\t\tif (params.visible) {\n\n\t\t\t\t\tif (params.fn) {\n\t\t\t\t\t\t// Call the given user-defined function\n\t\t\t\t\t\tparams.fn.call($canvases[e], ctx, params);\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t}\n\treturn $canvases;\n};\n\n// Clears canvas\n$.fn.clearCanvas = function clearCanvas(args) {\n\tvar $canvases = this, e, ctx,\n\t\tparams = new jCanvasObject(args);\n\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\tctx = _getContext($canvases[e]);\n\t\tif (ctx) {\n\n\t\t\tif (params.width === null || params.height === null) {\n\t\t\t\t// Clear entire canvas if width/height is not given\n\n\t\t\t\t// Reset current transformation temporarily to ensure that the entire canvas is cleared\n\t\t\t\tctx.save();\n\t\t\t\tctx.setTransform(1, 0, 0, 1, 0, 0);\n\t\t\t\tctx.clearRect(0, 0, $canvases[e].width, $canvases[e].height);\n\t\t\t\tctx.restore();\n\n\t\t\t} else {\n\t\t\t\t// Otherwise, clear the defined section of the canvas\n\n\t\t\t\t// Transform clear rectangle\n\t\t\t\t_addLayer($canvases[e], params, args, clearCanvas);\n\t\t\t\t_transformShape($canvases[e], ctx, params, params.width, params.height);\n\t\t\t\tctx.clearRect(params.x - (params.width / 2), params.y - (params.height / 2), params.width, params.height);\n\t\t\t\t// Restore previous transformation\n\t\t\t\t_restoreTransform(ctx, params);\n\n\t\t\t}\n\n\t\t}\n\t}\n\treturn $canvases;\n};\n\n/* Transformation API */\n\n// Restores canvas\n$.fn.saveCanvas = function saveCanvas(args) {\n\tvar $canvases = this, e, ctx,\n\t\tparams, data, i;\n\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\tctx = _getContext($canvases[e]);\n\t\tif (ctx) {\n\n\t\t\tdata = _getCanvasData($canvases[e]);\n\n\t\t\tparams = new jCanvasObject(args);\n\t\t\t_addLayer($canvases[e], params, args, saveCanvas);\n\n\t\t\t// Restore a number of times using the given count\n\t\t\tfor (i = 0; i < params.count; i += 1) {\n\t\t\t\t_saveCanvas(ctx, data);\n\t\t\t}\n\n\t\t}\n\t}\n\treturn $canvases;\n};\n\n// Restores canvas\n$.fn.restoreCanvas = function restoreCanvas(args) {\n\tvar $canvases = this, e, ctx,\n\t\tparams, data, i;\n\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\tctx = _getContext($canvases[e]);\n\t\tif (ctx) {\n\n\t\t\tdata = _getCanvasData($canvases[e]);\n\n\t\t\tparams = new jCanvasObject(args);\n\t\t\t_addLayer($canvases[e], params, args, restoreCanvas);\n\n\t\t\t// Restore a number of times using the given count\n\t\t\tfor (i = 0; i < params.count; i += 1) {\n\t\t\t\t_restoreCanvas(ctx, data);\n\t\t\t}\n\n\t\t}\n\t}\n\treturn $canvases;\n};\n\n// Rotates canvas (internal)\nfunction _rotateCanvas(ctx, params, transforms) {\n\n\t// Get conversion factor for radians\n\tparams._toRad = (params.inDegrees ? (PI / 180) : 1);\n\n\t// Rotate canvas using shape as center of rotation\n\tctx.translate(params.x, params.y);\n\tctx.rotate(params.rotate * params._toRad);\n\tctx.translate(-params.x, -params.y);\n\n\t// If transformation data was given\n\tif (transforms) {\n\t\t// Update transformation data\n\t\ttransforms.rotate += (params.rotate * params._toRad);\n\t}\n}\n\n// Scales canvas (internal)\nfunction _scaleCanvas(ctx, params, transforms) {\n\n\t// Scale both the x- and y- axis using the 'scale' property\n\tif (params.scale !== 1) {\n\t\tparams.scaleX = params.scaleY = params.scale;\n\t}\n\n\t// Scale canvas using shape as center of rotation\n\tctx.translate(params.x, params.y);\n\tctx.scale(params.scaleX, params.scaleY);\n\tctx.translate(-params.x, -params.y);\n\n\t// If transformation data was given\n\tif (transforms) {\n\t\t// Update transformation data\n\t\ttransforms.scaleX *= params.scaleX;\n\t\ttransforms.scaleY *= params.scaleY;\n\t}\n}\n\n// Translates canvas (internal)\nfunction _translateCanvas(ctx, params, transforms) {\n\n\t// Translate both the x- and y-axis using the 'translate' property\n\tif (params.translate) {\n\t\tparams.translateX = params.translateY = params.translate;\n\t}\n\n\t// Translate canvas\n\tctx.translate(params.translateX, params.translateY);\n\n\t// If transformation data was given\n\tif (transforms) {\n\t\t// Update transformation data\n\t\ttransforms.translateX += params.translateX;\n\t\ttransforms.translateY += params.translateY;\n\t}\n}\n\n// Rotates canvas\n$.fn.rotateCanvas = function rotateCanvas(args) {\n\tvar $canvases = this, e, ctx,\n\t\tparams, data;\n\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\tctx = _getContext($canvases[e]);\n\t\tif (ctx) {\n\n\t\t\tdata = _getCanvasData($canvases[e]);\n\n\t\t\tparams = new jCanvasObject(args);\n\t\t\t_addLayer($canvases[e], params, args, rotateCanvas);\n\n\t\t\t// Autosave transformation state by default\n\t\t\tif (params.autosave) {\n\t\t\t\t// Automatically save transformation state by default\n\t\t\t\t_saveCanvas(ctx, data);\n\t\t\t}\n\t\t\t_rotateCanvas(ctx, params, data.transforms);\n\t\t}\n\n\t}\n\treturn $canvases;\n};\n\n// Scales canvas\n$.fn.scaleCanvas = function scaleCanvas(args) {\n\tvar $canvases = this, e, ctx,\n\t\tparams, data;\n\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\tctx = _getContext($canvases[e]);\n\t\tif (ctx) {\n\n\t\t\tdata = _getCanvasData($canvases[e]);\n\n\t\t\tparams = new jCanvasObject(args);\n\t\t\t_addLayer($canvases[e], params, args, scaleCanvas);\n\n\t\t\t// Autosave transformation state by default\n\t\t\tif (params.autosave) {\n\t\t\t\t// Automatically save transformation state by default\n\t\t\t\t_saveCanvas(ctx, data);\n\t\t\t}\n\t\t\t_scaleCanvas(ctx, params, data.transforms);\n\n\t\t}\n\t}\n\treturn $canvases;\n};\n\n// Translates canvas\n$.fn.translateCanvas = function translateCanvas(args) {\n\tvar $canvases = this, e, ctx,\n\t\tparams, data;\n\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\tctx = _getContext($canvases[e]);\n\t\tif (ctx) {\n\n\t\t\tdata = _getCanvasData($canvases[e]);\n\n\t\t\tparams = new jCanvasObject(args);\n\t\t\t_addLayer($canvases[e], params, args, translateCanvas);\n\n\t\t\t// Autosave transformation state by default\n\t\t\tif (params.autosave) {\n\t\t\t\t// Automatically save transformation state by default\n\t\t\t\t_saveCanvas(ctx, data);\n\t\t\t}\n\t\t\t_translateCanvas(ctx, params, data.transforms);\n\n\t\t}\n\t}\n\treturn $canvases;\n};\n\n/* Shape API */\n\n// Draws rectangle\n$.fn.drawRect = function drawRect(args) {\n\tvar $canvases = this, e, ctx,\n\t\tparams,\n\t\tx1, y1,\n\t\tx2, y2,\n\t\tr, temp;\n\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\tctx = _getContext($canvases[e]);\n\t\tif (ctx) {\n\n\t\t\tparams = new jCanvasObject(args);\n\t\t\t_addLayer($canvases[e], params, args, drawRect);\n\t\t\tif (params.visible) {\n\n\t\t\t\t_transformShape($canvases[e], ctx, params, params.width, params.height);\n\t\t\t\t_setGlobalProps($canvases[e], ctx, params);\n\n\t\t\t\tctx.beginPath();\n\t\t\t\tif (params.width && params.height) {\n\t\t\t\t\tx1 = params.x - (params.width / 2);\n\t\t\t\t\ty1 = params.y - (params.height / 2);\n\t\t\t\t\tr = abs(params.cornerRadius);\n\t\t\t\t\t// If corner radius is defined and is not zero\n\t\t\t\t\tif (r) {\n\t\t\t\t\t\t// Draw rectangle with rounded corners if cornerRadius is defined\n\n\t\t\t\t\t\tx2 = params.x + (params.width / 2);\n\t\t\t\t\t\ty2 = params.y + (params.height / 2);\n\n\t\t\t\t\t\t// Handle negative width\n\t\t\t\t\t\tif (params.width < 0) {\n\t\t\t\t\t\t\ttemp = x1;\n\t\t\t\t\t\t\tx1 = x2;\n\t\t\t\t\t\t\tx2 = temp;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// Handle negative height\n\t\t\t\t\t\tif (params.height < 0) {\n\t\t\t\t\t\t\ttemp = y1;\n\t\t\t\t\t\t\ty1 = y2;\n\t\t\t\t\t\t\ty2 = temp;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Prevent over-rounded corners\n\t\t\t\t\t\tif ((x2 - x1) - (2 * r) < 0) {\n\t\t\t\t\t\t\tr = (x2 - x1) / 2;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ((y2 - y1) - (2 * r) < 0) {\n\t\t\t\t\t\t\tr = (y2 - y1) / 2;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Draw rectangle\n\t\t\t\t\t\tctx.moveTo(x1 + r, y1);\n\t\t\t\t\t\tctx.lineTo(x2 - r, y1);\n\t\t\t\t\t\tctx.arc(x2 - r, y1 + r, r, 3 * PI / 2, PI * 2, false);\n\t\t\t\t\t\tctx.lineTo(x2, y2 - r);\n\t\t\t\t\t\tctx.arc(x2 - r, y2 - r, r, 0, PI / 2, false);\n\t\t\t\t\t\tctx.lineTo(x1 + r, y2);\n\t\t\t\t\t\tctx.arc(x1 + r, y2 - r, r, PI / 2, PI, false);\n\t\t\t\t\t\tctx.lineTo(x1, y1 + r);\n\t\t\t\t\t\tctx.arc(x1 + r, y1 + r, r, PI, 3 * PI / 2, false);\n\t\t\t\t\t\t// Always close path\n\t\t\t\t\t\tparams.closed = true;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// Otherwise, draw rectangle with square corners\n\t\t\t\t\t\tctx.rect(x1, y1, params.width, params.height);\n\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// Check for jCanvas events\n\t\t\t\t_detectEvents($canvases[e], ctx, params);\n\t\t\t\t// Close rectangle path\n\t\t\t\t_closePath($canvases[e], ctx, params);\n\t\t\t}\n\t\t}\n\t}\n\treturn $canvases;\n};\n\n// Retrieves a coterminal angle between 0 and 2pi for the given angle\nfunction _getCoterminal(angle) {\n\twhile (angle < 0) {\n\t\tangle += (2 * PI);\n\t}\n\treturn angle;\n}\n\n// Retrieves the x-coordinate for the given angle in a circle\nfunction _getArcX(params, angle) {\n\treturn params.x + (params.radius * cos(angle));\n}\n// Retrieves the y-coordinate for the given angle in a circle\nfunction _getArcY(params, angle) {\n\treturn params.y + (params.radius * sin(angle));\n}\n\n// Draws arc (internal)\nfunction _drawArc(canvas, ctx, params, path) {\n\tvar x1, y1, x2, y2,\n\t\tx3, y3, x4, y4,\n\t\toffsetX, offsetY,\n\t\tdiff;\n\n\t// Determine offset from dragging\n\tif (params === path) {\n\t\toffsetX = 0;\n\t\toffsetY = 0;\n\t} else {\n\t\toffsetX = params.x;\n\t\toffsetY = params.y;\n\t}\n\n\t// Convert default end angle to radians\n\tif (!path.inDegrees && path.end === 360) {\n\t\tpath.end = PI * 2;\n\t}\n\n\t// Convert angles to radians\n\tpath.start *= params._toRad;\n\tpath.end *= params._toRad;\n\t// Consider 0deg due north of arc\n\tpath.start -= (PI / 2);\n\tpath.end -= (PI / 2);\n\n\t// Ensure arrows are pointed correctly for CCW arcs\n\tdiff = PI / 180;\n\tif (path.ccw) {\n\t\tdiff *= -1;\n\t}\n\n\t// Calculate coordinates for start arrow\n\tx1 = _getArcX(path, path.start + diff);\n\ty1 = _getArcY(path, path.start + diff);\n\tx2 = _getArcX(path, path.start);\n\ty2 = _getArcY(path, path.start);\n\n\t_addStartArrow(\n\t\tcanvas, ctx,\n\t\tparams, path,\n\t\tx1, y1,\n\t\tx2, y2\n\t);\n\n\t// Draw arc\n\tctx.arc(path.x + offsetX, path.y + offsetY, path.radius, path.start, path.end, path.ccw);\n\n\t// Calculate coordinates for end arrow\n\tx3 = _getArcX(path, path.end + diff);\n\ty3 = _getArcY(path, path.end + diff);\n\tx4 = _getArcX(path, path.end);\n\ty4 = _getArcY(path, path.end);\n\n\t_addEndArrow(\n\t\tcanvas, ctx,\n\t\tparams, path,\n\t\tx4, y4,\n\t\tx3, y3\n\t);\n}\n\n// Draws arc or circle\n$.fn.drawArc = function drawArc(args) {\n\tvar $canvases = this, e, ctx,\n\t\tparams;\n\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\tctx = _getContext($canvases[e]);\n\t\tif (ctx) {\n\n\t\t\tparams = new jCanvasObject(args);\n\t\t\t_addLayer($canvases[e], params, args, drawArc);\n\t\t\tif (params.visible) {\n\n\t\t\t\t_transformShape($canvases[e], ctx, params, params.radius * 2);\n\t\t\t\t_setGlobalProps($canvases[e], ctx, params);\n\n\t\t\t\tctx.beginPath();\n\t\t\t\t_drawArc($canvases[e], ctx, params, params);\n\t\t\t\t// Check for jCanvas events\n\t\t\t\t_detectEvents($canvases[e], ctx, params);\n\t\t\t\t// Optionally close path\n\t\t\t\t_closePath($canvases[e], ctx, params);\n\n\t\t\t}\n\n\t\t}\n\t}\n\treturn $canvases;\n};\n\n// Draws ellipse\n$.fn.drawEllipse = function drawEllipse(args) {\n\tvar $canvases = this, e, ctx,\n\t\tparams,\n\t\tcontrolW,\n\t\tcontrolH;\n\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\tctx = _getContext($canvases[e]);\n\t\tif (ctx) {\n\n\t\t\tparams = new jCanvasObject(args);\n\t\t\t_addLayer($canvases[e], params, args, drawEllipse);\n\t\t\tif (params.visible) {\n\n\t\t\t\t_transformShape($canvases[e], ctx, params, params.width, params.height);\n\t\t\t\t_setGlobalProps($canvases[e], ctx, params);\n\n\t\t\t\t// Calculate control width and height\n\t\t\t\tcontrolW = params.width * (4 / 3);\n\t\t\t\tcontrolH = params.height;\n\n\t\t\t\t// Create ellipse using curves\n\t\t\t\tctx.beginPath();\n\t\t\t\tctx.moveTo(params.x, params.y - (controlH / 2));\n\t\t\t\t// Left side\n\t\t\t\tctx.bezierCurveTo(params.x - (controlW / 2), params.y - (controlH / 2), params.x - (controlW / 2), params.y + (controlH / 2), params.x, params.y + (controlH / 2));\n\t\t\t\t// Right side\n\t\t\t\tctx.bezierCurveTo(params.x + (controlW / 2), params.y + (controlH / 2), params.x + (controlW / 2), params.y - (controlH / 2), params.x, params.y - (controlH / 2));\n\t\t\t\t// Check for jCanvas events\n\t\t\t\t_detectEvents($canvases[e], ctx, params);\n\t\t\t\t// Always close path\n\t\t\t\tparams.closed = true;\n\t\t\t\t_closePath($canvases[e], ctx, params);\n\n\t\t\t}\n\t\t}\n\t}\n\treturn $canvases;\n};\n\n// Draws a regular (equal-angled) polygon\n$.fn.drawPolygon = function drawPolygon(args) {\n\tvar $canvases = this, e, ctx,\n\t\tparams,\n\t\ttheta, dtheta, hdtheta,\n\t\tapothem,\n\t\tx, y, i;\n\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\tctx = _getContext($canvases[e]);\n\t\tif (ctx) {\n\n\t\t\tparams = new jCanvasObject(args);\n\t\t\t_addLayer($canvases[e], params, args, drawPolygon);\n\t\t\tif (params.visible) {\n\n\t\t\t\t_transformShape($canvases[e], ctx, params, params.radius * 2);\n\t\t\t\t_setGlobalProps($canvases[e], ctx, params);\n\n\t\t\t\t// Polygon's central angle\n\t\t\t\tdtheta = (2 * PI) / params.sides;\n\t\t\t\t// Half of dtheta\n\t\t\t\thdtheta = dtheta / 2;\n\t\t\t\t// Polygon's starting angle\n\t\t\t\ttheta = hdtheta + (PI / 2);\n\t\t\t\t// Distance from polygon's center to the middle of its side\n\t\t\t\tapothem = params.radius * cos(hdtheta);\n\n\t\t\t\t// Calculate path and draw\n\t\t\t\tctx.beginPath();\n\t\t\t\tfor (i = 0; i < params.sides; i += 1) {\n\n\t\t\t\t\t// Draw side of polygon\n\t\t\t\t\tx = params.x + (params.radius * cos(theta));\n\t\t\t\t\ty = params.y + (params.radius * sin(theta));\n\n\t\t\t\t\t// Plot point on polygon\n\t\t\t\t\tctx.lineTo(x, y);\n\n\t\t\t\t\t// Project side if chosen\n\t\t\t\t\tif (params.concavity) {\n\t\t\t\t\t\t// Sides are projected from the polygon's apothem\n\t\t\t\t\t\tx = params.x + ((apothem + (-apothem * params.concavity)) * cos(theta + hdtheta));\n\t\t\t\t\t\ty = params.y + ((apothem + (-apothem * params.concavity)) * sin(theta + hdtheta));\n\t\t\t\t\t\tctx.lineTo(x, y);\n\t\t\t\t\t}\n\n\t\t\t\t\t// Increment theta by delta theta\n\t\t\t\t\ttheta += dtheta;\n\n\t\t\t\t}\n\t\t\t\t// Check for jCanvas events\n\t\t\t\t_detectEvents($canvases[e], ctx, params);\n\t\t\t\t// Always close path\n\t\t\t\tparams.closed = true;\n\t\t\t\t_closePath($canvases[e], ctx, params);\n\n\t\t\t}\n\t\t}\n\t}\n\treturn $canvases;\n};\n\n// Draws pie-shaped slice\n$.fn.drawSlice = function drawSlice(args) {\n\tvar $canvases = this, e, ctx,\n\t\tparams,\n\t\tangle, dx, dy;\n\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\tctx = _getContext($canvases[e]);\n\t\tif (ctx) {\n\n\t\t\tparams = new jCanvasObject(args);\n\t\t\t_addLayer($canvases[e], params, args, drawSlice);\n\t\t\tif (params.visible) {\n\n\t\t\t\t_transformShape($canvases[e], ctx, params, params.radius * 2);\n\t\t\t\t_setGlobalProps($canvases[e], ctx, params);\n\n\t\t\t\t// Perform extra calculations\n\n\t\t\t\t// Convert angles to radians\n\t\t\t\tparams.start *= params._toRad;\n\t\t\t\tparams.end *= params._toRad;\n\t\t\t\t// Consider 0deg at north of arc\n\t\t\t\tparams.start -= (PI / 2);\n\t\t\t\tparams.end -= (PI / 2);\n\n\t\t\t\t// Find positive equivalents of angles\n\t\t\t\tparams.start = _getCoterminal(params.start);\n\t\t\t\tparams.end = _getCoterminal(params.end);\n\t\t\t\t// Ensure start angle is less than end angle\n\t\t\t\tif (params.end < params.start) {\n\t\t\t\t\tparams.end += (2 * PI);\n\t\t\t\t}\n\n\t\t\t\t// Calculate angular position of slice\n\t\t\t\tangle = ((params.start + params.end) / 2);\n\n\t\t\t\t// Calculate ratios for slice's angle\n\t\t\t\tdx = (params.radius * params.spread * cos(angle));\n\t\t\t\tdy = (params.radius * params.spread * sin(angle));\n\n\t\t\t\t// Adjust position of slice\n\t\t\t\tparams.x += dx;\n\t\t\t\tparams.y += dy;\n\n\t\t\t\t// Draw slice\n\t\t\t\tctx.beginPath();\n\t\t\t\tctx.arc(params.x, params.y, params.radius, params.start, params.end, params.ccw);\n\t\t\t\tctx.lineTo(params.x, params.y);\n\t\t\t\t// Check for jCanvas events\n\t\t\t\t_detectEvents($canvases[e], ctx, params);\n\t\t\t\t// Always close path\n\t\t\t\tparams.closed = true;\n\t\t\t\t_closePath($canvases[e], ctx, params);\n\n\t\t\t}\n\n\t\t}\n\t}\n\treturn $canvases;\n};\n\n/* Path API */\n\n// Adds arrow to path using the given properties\nfunction _addArrow(canvas, ctx, params, path, x1, y1, x2, y2) {\n\tvar leftX, leftY,\n\t\trightX, rightY,\n\t\toffsetX, offsetY,\n\t\tangle;\n\n\t// If arrow radius is given and path is not closed\n\tif (path.arrowRadius && !params.closed) {\n\n\t\t// Calculate angle\n\t\tangle = atan2((y2 - y1), (x2 - x1));\n\t\t// Adjust angle correctly\n\t\tangle -= PI;\n\t\t// Calculate offset to place arrow at edge of path\n\t\toffsetX = (params.strokeWidth * cos(angle));\n\t\toffsetY = (params.strokeWidth * sin(angle));\n\n\t\t// Calculate coordinates for left half of arrow\n\t\tleftX = x2 + (path.arrowRadius * cos(angle + (path.arrowAngle / 2)));\n\t\tleftY = y2 + (path.arrowRadius * sin(angle + (path.arrowAngle / 2)));\n\t\t// Calculate coordinates for right half of arrow\n\t\trightX = x2 + (path.arrowRadius * cos(angle - (path.arrowAngle / 2)));\n\t\trightY = y2 + (path.arrowRadius * sin(angle - (path.arrowAngle / 2)));\n\n\t\t// Draw left half of arrow\n\t\tctx.moveTo(leftX - offsetX, leftY - offsetY);\n\t\tctx.lineTo(x2 - offsetX, y2 - offsetY);\n\t\t// Draw right half of arrow\n\t\tctx.lineTo(rightX - offsetX, rightY - offsetY);\n\n\t\t// Visually connect arrow to path\n\t\tctx.moveTo(x2 - offsetX, y2 - offsetY);\n\t\tctx.lineTo(x2 + offsetX, y2 + offsetY);\n\t\t// Move back to end of path\n\t\tctx.moveTo(x2, y2);\n\n\t}\n}\n\n// Optionally adds arrow to start of path\nfunction _addStartArrow(canvas, ctx, params, path, x1, y1, x2, y2) {\n\tif (!path._arrowAngleConverted) {\n\t\tpath.arrowAngle *= params._toRad;\n\t\tpath._arrowAngleConverted = true;\n\t}\n\tif (path.startArrow) {\n\t\t_addArrow(canvas, ctx, params, path, x1, y1, x2, y2);\n\t}\n}\n\n// Optionally adds arrow to end of path\nfunction _addEndArrow(canvas, ctx, params, path, x1, y1, x2, y2) {\n\tif (!path._arrowAngleConverted) {\n\t\tpath.arrowAngle *= params._toRad;\n\t\tpath._arrowAngleConverted = true;\n\t}\n\tif (path.endArrow) {\n\t\t_addArrow(canvas, ctx, params, path, x1, y1, x2, y2);\n\t}\n}\n\n// Draws line (internal)\nfunction _drawLine(canvas, ctx, params, path) {\n\tvar l,\n\t\tlx, ly;\n\tl = 2;\n\t_addStartArrow(\n\t\tcanvas, ctx,\n\t\tparams, path,\n\t\tpath.x2 + params.x,\n\t\tpath.y2 + params.y,\n\t\tpath.x1 + params.x,\n\t\tpath.y1 + params.y\n\t);\n\tif (path.x1 !== undefined && path.y1 !== undefined) {\n\t\tctx.moveTo(path.x1 + params.x, path.y1 + params.y);\n\t}\n\twhile (true) {\n\t\t// Calculate next coordinates\n\t\tlx = path['x' + l];\n\t\tly = path['y' + l];\n\t\t// If coordinates are given\n\t\tif (lx !== undefined && ly !== undefined) {\n\t\t\t// Draw next line\n\t\t\tctx.lineTo(lx + params.x, ly + params.y);\n\t\t\tl += 1;\n\t\t} else {\n\t\t\t// Otherwise, stop drawing\n\t\t\tbreak;\n\t\t}\n\t}\n\tl -= 1;\n\t// Optionally add arrows to path\n\t_addEndArrow(\n\t\tcanvas, ctx,\n\t\tparams,\n\t\tpath,\n\t\tpath['x' + (l - 1)] + params.x,\n\t\tpath['y' + (l - 1)] + params.y,\n\t\tpath['x' + l] + params.x,\n\t\tpath['y' + l] + params.y\n\t);\n}\n\n// Draws line\n$.fn.drawLine = function drawLine(args) {\n\tvar $canvases = this, e, ctx,\n\t\tparams;\n\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\tctx = _getContext($canvases[e]);\n\t\tif (ctx) {\n\n\t\t\tparams = new jCanvasObject(args);\n\t\t\t_addLayer($canvases[e], params, args, drawLine);\n\t\t\tif (params.visible) {\n\n\t\t\t\t_transformShape($canvases[e], ctx, params);\n\t\t\t\t_setGlobalProps($canvases[e], ctx, params);\n\n\t\t\t\t// Draw each point\n\t\t\t\tctx.beginPath();\n\t\t\t\t_drawLine($canvases[e], ctx, params, params);\n\t\t\t\t// Check for jCanvas events\n\t\t\t\t_detectEvents($canvases[e], ctx, params);\n\t\t\t\t// Optionally close path\n\t\t\t\t_closePath($canvases[e], ctx, params);\n\n\t\t\t}\n\n\t\t}\n\t}\n\treturn $canvases;\n};\n\n// Draws quadratic curve (internal)\nfunction _drawQuadratic(canvas, ctx, params, path) {\n\tvar l,\n\t\tlx, ly,\n\t\tlcx, lcy;\n\n\tl = 2;\n\n\t_addStartArrow(\n\t\tcanvas,\n\t\tctx,\n\t\tparams,\n\t\tpath,\n\t\tpath.cx1 + params.x,\n\t\tpath.cy1 + params.y,\n\t\tpath.x1 + params.x,\n\t\tpath.y1 + params.y\n\t);\n\n\tif (path.x1 !== undefined && path.y1 !== undefined) {\n\t\tctx.moveTo(path.x1 + params.x, path.y1 + params.y);\n\t}\n\twhile (true) {\n\t\t// Calculate next coordinates\n\t\tlx = path['x' + l];\n\t\tly = path['y' + l];\n\t\tlcx = path['cx' + (l - 1)];\n\t\tlcy = path['cy' + (l - 1)];\n\t\t// If coordinates are given\n\t\tif (lx !== undefined && ly !== undefined && lcx !== undefined && lcy !== undefined) {\n\t\t\t// Draw next curve\n\t\t\tctx.quadraticCurveTo(lcx + params.x, lcy + params.y, lx + params.x, ly + params.y);\n\t\t\tl += 1;\n\t\t} else {\n\t\t\t// Otherwise, stop drawing\n\t\t\tbreak;\n\t\t}\n\t}\n\tl -= 1;\n\t_addEndArrow(\n\t\tcanvas,\n\t\tctx,\n\t\tparams,\n\t\tpath,\n\t\tpath['cx' + (l - 1)] + params.x,\n\t\tpath['cy' + (l - 1)] + params.y,\n\t\tpath['x' + l] + params.x,\n\t\tpath['y' + l] + params.y\n\t);\n}\n\n// Draws quadratic curve\n$.fn.drawQuadratic = function drawQuadratic(args) {\n\tvar $canvases = this, e, ctx,\n\t\tparams;\n\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\tctx = _getContext($canvases[e]);\n\t\tif (ctx) {\n\n\t\t\tparams = new jCanvasObject(args);\n\t\t\t_addLayer($canvases[e], params, args, drawQuadratic);\n\t\t\tif (params.visible) {\n\n\t\t\t\t_transformShape($canvases[e], ctx, params);\n\t\t\t\t_setGlobalProps($canvases[e], ctx, params);\n\n\t\t\t\t// Draw each point\n\t\t\t\tctx.beginPath();\n\t\t\t\t_drawQuadratic($canvases[e], ctx, params, params);\n\t\t\t\t// Check for jCanvas events\n\t\t\t\t_detectEvents($canvases[e], ctx, params);\n\t\t\t\t// Optionally close path\n\t\t\t\t_closePath($canvases[e], ctx, params);\n\n\t\t\t}\n\t\t}\n\t}\n\treturn $canvases;\n};\n\n// Draws Bezier curve (internal)\nfunction _drawBezier(canvas, ctx, params, path) {\n\tvar l, lc,\n\t\tlx, ly,\n\t\tlcx1, lcy1,\n\t\tlcx2, lcy2;\n\n\tl = 2;\n\tlc = 1;\n\n\t_addStartArrow(\n\t\tcanvas,\n\t\tctx,\n\t\tparams,\n\t\tpath,\n\t\tpath.cx1 + params.x,\n\t\tpath.cy1 + params.y,\n\t\tpath.x1 + params.x,\n\t\tpath.y1 + params.y\n\t);\n\n\tif (path.x1 !== undefined && path.y1 !== undefined) {\n\t\tctx.moveTo(path.x1 + params.x, path.y1 + params.y);\n\t}\n\twhile (true) {\n\t\t// Calculate next coordinates\n\t\tlx = path['x' + l];\n\t\tly = path['y' + l];\n\t\tlcx1 = path['cx' + lc];\n\t\tlcy1 = path['cy' + lc];\n\t\tlcx2 = path['cx' + (lc + 1)];\n\t\tlcy2 = path['cy' + (lc + 1)];\n\t\t// If next coordinates are given\n\t\tif (lx !== undefined && ly !== undefined && lcx1 !== undefined && lcy1 !== undefined && lcx2 !== undefined && lcy2 !== undefined) {\n\t\t\t// Draw next curve\n\t\t\tctx.bezierCurveTo(lcx1 + params.x, lcy1 + params.y, lcx2 + params.x, lcy2 + params.y, lx + params.x, ly + params.y);\n\t\t\tl += 1;\n\t\t\tlc += 2;\n\t\t} else {\n\t\t\t// Otherwise, stop drawing\n\t\t\tbreak;\n\t\t}\n\t}\n\tl -= 1;\n\tlc -= 2;\n\t_addEndArrow(\n\t\tcanvas,\n\t\tctx,\n\t\tparams,\n\t\tpath,\n\t\tpath['cx' + (lc + 1)] + params.x,\n\t\tpath['cy' + (lc + 1)] + params.y,\n\t\tpath['x' + l] + params.x,\n\t\tpath['y' + l] + params.y\n\t);\n}\n\n// Draws Bezier curve\n$.fn.drawBezier = function drawBezier(args) {\n\tvar $canvases = this, e, ctx,\n\t\tparams;\n\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\tctx = _getContext($canvases[e]);\n\t\tif (ctx) {\n\n\t\t\tparams = new jCanvasObject(args);\n\t\t\t_addLayer($canvases[e], params, args, drawBezier);\n\t\t\tif (params.visible) {\n\n\t\t\t\t_transformShape($canvases[e], ctx, params);\n\t\t\t\t_setGlobalProps($canvases[e], ctx, params);\n\n\t\t\t\t// Draw each point\n\t\t\t\tctx.beginPath();\n\t\t\t\t_drawBezier($canvases[e], ctx, params, params);\n\t\t\t\t// Check for jCanvas events\n\t\t\t\t_detectEvents($canvases[e], ctx, params);\n\t\t\t\t// Optionally close path\n\t\t\t\t_closePath($canvases[e], ctx, params);\n\n\t\t\t}\n\t\t}\n\t}\n\treturn $canvases;\n};\n\n// Retrieves the x-coordinate for the given vector angle and length\nfunction _getVectorX(params, angle, length) {\n\tangle *= params._toRad;\n\tangle -= (PI / 2);\n\treturn (length * cos(angle));\n}\n// Retrieves the y-coordinate for the given vector angle and length\nfunction _getVectorY(params, angle, length) {\n\tangle *= params._toRad;\n\tangle -= (PI / 2);\n\treturn (length * sin(angle));\n}\n\n// Draws vector (internal) #2\nfunction _drawVector(canvas, ctx, params, path) {\n\tvar l, angle, length,\n\t\toffsetX, offsetY,\n\t\tx, y,\n\t\tx3, y3,\n\t\tx4, y4;\n\n\t// Determine offset from dragging\n\tif (params === path) {\n\t\toffsetX = 0;\n\t\toffsetY = 0;\n\t} else {\n\t\toffsetX = params.x;\n\t\toffsetY = params.y;\n\t}\n\n\tl = 1;\n\tx = x3 = x4 = path.x + offsetX;\n\ty = y3 = y4 = path.y + offsetY;\n\n\t_addStartArrow(\n\t\tcanvas, ctx,\n\t\tparams, path,\n\t\tx + _getVectorX(params, path.a1, path.l1),\n\t\ty + _getVectorY(params, path.a1, path.l1),\n\t\tx,\n\t\ty\n\t);\n\n\t// The vector starts at the given (x, y) coordinates\n\tif (path.x !== undefined && path.y !== undefined) {\n\t\tctx.moveTo(x, y);\n\t}\n\twhile (true) {\n\n\t\tangle = path['a' + l];\n\t\tlength = path['l' + l];\n\n\t\tif (angle !== undefined && length !== undefined) {\n\t\t\t// Convert the angle to radians with 0 degrees starting at north\n\t\t\t// Keep track of last two coordinates\n\t\t\tx3 = x4;\n\t\t\ty3 = y4;\n\t\t\t// Compute (x, y) coordinates from angle and length\n\t\t\tx4 += _getVectorX(params, angle, length);\n\t\t\ty4 += _getVectorY(params, angle, length);\n\t\t\tctx.lineTo(x4, y4);\n\t\t\tl += 1;\n\t\t} else {\n\t\t\t// Otherwise, stop drawing\n\t\t\tbreak;\n\t\t}\n\n\t}\n\t_addEndArrow(\n\t\tcanvas, ctx,\n\t\tparams, path,\n\t\tx3, y3,\n\t\tx4, y4\n\t);\n}\n\n// Draws vector\n$.fn.drawVector = function drawVector(args) {\n\tvar $canvases = this, e, ctx,\n\t\tparams;\n\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\tctx = _getContext($canvases[e]);\n\t\tif (ctx) {\n\n\t\t\tparams = new jCanvasObject(args);\n\t\t\t_addLayer($canvases[e], params, args, drawVector);\n\t\t\tif (params.visible) {\n\n\t\t\t\t_transformShape($canvases[e], ctx, params);\n\t\t\t\t_setGlobalProps($canvases[e], ctx, params);\n\n\t\t\t\t// Draw each point\n\t\t\t\tctx.beginPath();\n\t\t\t\t_drawVector($canvases[e], ctx, params, params);\n\t\t\t\t// Check for jCanvas events\n\t\t\t\t_detectEvents($canvases[e], ctx, params);\n\t\t\t\t// Optionally close path\n\t\t\t\t_closePath($canvases[e], ctx, params);\n\n\t\t\t}\n\t\t}\n\t}\n\treturn $canvases;\n};\n\n// Draws a path consisting of one or more subpaths\n$.fn.drawPath = function drawPath(args) {\n\tvar $canvases = this, e, ctx,\n\t\tparams,\n\t\tl, lp;\n\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\tctx = _getContext($canvases[e]);\n\t\tif (ctx) {\n\n\t\t\tparams = new jCanvasObject(args);\n\t\t\t_addLayer($canvases[e], params, args, drawPath);\n\t\t\tif (params.visible) {\n\n\t\t\t\t_transformShape($canvases[e], ctx, params);\n\t\t\t\t_setGlobalProps($canvases[e], ctx, params);\n\n\t\t\t\tctx.beginPath();\n\t\t\t\tl = 1;\n\t\t\t\twhile (true) {\n\t\t\t\t\tlp = params['p' + l];\n\t\t\t\t\tif (lp !== undefined) {\n\t\t\t\t\t\tlp = new jCanvasObject(lp);\n\t\t\t\t\t\tif (lp.type === 'line') {\n\t\t\t\t\t\t\t_drawLine($canvases[e], ctx, params, lp);\n\t\t\t\t\t\t} else if (lp.type === 'quadratic') {\n\t\t\t\t\t\t\t_drawQuadratic($canvases[e], ctx, params, lp);\n\t\t\t\t\t\t} else if (lp.type === 'bezier') {\n\t\t\t\t\t\t\t_drawBezier($canvases[e], ctx, params, lp);\n\t\t\t\t\t\t} else if (lp.type === 'vector') {\n\t\t\t\t\t\t\t_drawVector($canvases[e], ctx, params, lp);\n\t\t\t\t\t\t} else if (lp.type === 'arc') {\n\t\t\t\t\t\t\t_drawArc($canvases[e], ctx, params, lp);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tl += 1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Check for jCanvas events\n\t\t\t\t_detectEvents($canvases[e], ctx, params);\n\t\t\t\t// Optionally close path\n\t\t\t\t_closePath($canvases[e], ctx, params);\n\n\t\t\t}\n\n\t\t}\n\t}\n\treturn $canvases;\n};\n\n/* Text API */\n\n// Calculates font string and set it as the canvas font\nfunction _setCanvasFont(canvas, ctx, params) {\n\t// Otherwise, use the given font attributes\n\tif (!isNaN(Number(params.fontSize))) {\n\t\t// Give font size units if it doesn't have any\n\t\tparams.fontSize += 'px';\n\t}\n\t// Set font using given font properties\n\tctx.font = params.fontStyle + ' ' + params.fontSize + ' ' + params.fontFamily;\n}\n\n// Measures canvas text\nfunction _measureText(canvas, ctx, params, lines) {\n\tvar originalSize, curWidth, l,\n\t\tpropCache = caches.propCache;\n\n\t// Used cached width/height if possible\n\tif (propCache.text === params.text && propCache.fontStyle === params.fontStyle && propCache.fontSize === params.fontSize && propCache.fontFamily === params.fontFamily && propCache.maxWidth === params.maxWidth && propCache.lineHeight === params.lineHeight) {\n\n\t\tparams.width = propCache.width;\n\t\tparams.height = propCache.height;\n\n\t} else {\n\t\t// Calculate text dimensions only once\n\n\t\t// Calculate width of first line (for comparison)\n\t\tparams.width = ctx.measureText(lines[0]).width;\n\n\t\t// Get width of longest line\n\t\tfor (l = 1; l < lines.length; l += 1) {\n\n\t\t\tcurWidth = ctx.measureText(lines[l]).width;\n\t\t\t// Ensure text's width is the width of its longest line\n\t\t\tif (curWidth > params.width) {\n\t\t\t\tparams.width = curWidth;\n\t\t\t}\n\n\t\t}\n\n\t\t// Save original font size\n\t\toriginalSize = canvas.style.fontSize;\n\t\t// Temporarily set canvas font size to retrieve size in pixels\n\t\tcanvas.style.fontSize = params.fontSize;\n\t\t// Save text width and height in parameters object\n\t\tparams.height = parseFloat($.css(canvas, 'fontSize')) * lines.length * params.lineHeight;\n\t\t// Reset font size to original size\n\t\tcanvas.style.fontSize = originalSize;\n\t}\n}\n\n// Wraps a string of text within a defined width\nfunction _wrapText(ctx, params) {\n\tvar allText = String(params.text),\n\t\t// Maximum line width (optional)\n\t\tmaxWidth = params.maxWidth,\n\t\t// Lines created by manual line breaks (\\n)\n\t\tmanualLines = allText.split('\\n'),\n\t\t// All lines created manually and by wrapping\n\t\tallLines = [],\n\t\t// Other variables\n\t\tlines, line, l,\n\t\ttext, words, w;\n\n\t// Loop through manually-broken lines\n\tfor (l = 0; l < manualLines.length; l += 1) {\n\n\t\ttext = manualLines[l];\n\t\t// Split line into list of words\n\t\twords = text.split(' ');\n\t\tlines = [];\n\t\tline = '';\n\n\t\t// If text is short enough initially\n\t\t// Or, if the text consists of only one word\n\t\tif (words.length === 1 || ctx.measureText(text).width < maxWidth) {\n\n\t\t\t// No need to wrap text\n\t\t\tlines = [text];\n\n\t\t} else {\n\n\t\t\t// Wrap lines\n\t\t\tfor (w = 0; w < words.length; w += 1) {\n\n\t\t\t\t// Once line gets too wide, push word to next line\n\t\t\t\tif (ctx.measureText(line + words[w]).width > maxWidth) {\n\t\t\t\t\t// This check prevents empty lines from being created\n\t\t\t\t\tif (line !== '') {\n\t\t\t\t\t\tlines.push(line);\n\t\t\t\t\t}\n\t\t\t\t\t// Start new line and repeat process\n\t\t\t\t\tline = '';\n\t\t\t\t}\n\t\t\t\t// Add words to line until the line is too wide\n\t\t\t\tline += words[w];\n\t\t\t\t// Do not add a space after the last word\n\t\t\t\tif (w !== (words.length - 1)) {\n\t\t\t\t\tline += ' ';\n\t\t\t\t}\n\t\t\t}\n\t\t\t// The last word should always be pushed\n\t\t\tlines.push(line);\n\n\t\t}\n\t\t// Remove extra space at the end of each line\n\t\tallLines = allLines.concat(\n\t\t\tlines\n\t\t\t.join('\\n')\n\t\t\t.replace(/((\\n))|($)/gi, '$2')\n\t\t\t.split('\\n')\n\t\t);\n\n\t}\n\n\treturn allLines;\n}\n\n// Draws text on canvas\n$.fn.drawText = function drawText(args) {\n\tvar $canvases = this, e, ctx,\n\t\tparams, layer,\n\t\tlines, line, l,\n\t\tfontSize, constantCloseness = 500,\n\t\tnchars, chars, ch, c,\n\t\tx, y;\n\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\tctx = _getContext($canvases[e]);\n\t\tif (ctx) {\n\n\t\t\tparams = new jCanvasObject(args);\n\t\t\t_addLayer($canvases[e], params, args, drawText);\n\t\t\tif (params.visible) {\n\n\t\t\t\t// Set text-specific properties\n\t\t\t\tctx.textBaseline = params.baseline;\n\t\t\t\tctx.textAlign = params.align;\n\n\t\t\t\t// Set canvas font using given properties\n\t\t\t\t_setCanvasFont($canvases[e], ctx, params);\n\n\t\t\t\tif (params.maxWidth !== null) {\n\t\t\t\t\t// Wrap text using an internal function\n\t\t\t\t\tlines = _wrapText(ctx, params);\n\t\t\t\t} else {\n\t\t\t\t\t// Convert string of text to list of lines\n\t\t\t\t\tlines = params.text\n\t\t\t\t\t.toString()\n\t\t\t\t\t.split('\\n');\n\t\t\t\t}\n\n\t\t\t\t// Calculate text's width and height\n\t\t\t\t_measureText($canvases[e], ctx, params, lines);\n\n\t\t\t\t// If text is a layer\n\t\t\t\tif (layer) {\n\t\t\t\t\t// Copy calculated width/height to layer object\n\t\t\t\t\tlayer.width = params.width;\n\t\t\t\t\tlayer.height = params.height;\n\t\t\t\t}\n\n\t\t\t\t_transformShape($canvases[e], ctx, params, params.width, params.height);\n\t\t\t\t_setGlobalProps($canvases[e], ctx, params);\n\n\t\t\t\t// Adjust text position to accomodate different horizontal alignments\n\t\t\t\tx = params.x;\n\t\t\t\tif (params.align === 'left') {\n\t\t\t\t\tif (params.respectAlign) {\n\t\t\t\t\t\t// Realign text to the left if chosen\n\t\t\t\t\t\tparams.x += params.width / 2;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Center text block by default\n\t\t\t\t\t\tx -= params.width / 2;\n\t\t\t\t\t}\n\t\t\t\t} else if (params.align === 'right') {\n\t\t\t\t\tif (params.respectAlign) {\n\t\t\t\t\t\t// Realign text to the right if chosen\n\t\t\t\t\t\tparams.x -= params.width / 2;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Center text block by default\n\t\t\t\t\t\tx += params.width / 2;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (params.radius) {\n\n\t\t\t\t\tfontSize = parseFloat(params.fontSize);\n\n\t\t\t\t\t// Greater values move clockwise\n\t\t\t\t\tif (params.letterSpacing === null) {\n\t\t\t\t\t\tparams.letterSpacing = fontSize / constantCloseness;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Loop through each line of text\n\t\t\t\t\tfor (l = 0; l < lines.length; l += 1) {\n\t\t\t\t\t\tctx.save();\n\t\t\t\t\t\tctx.translate(params.x, params.y);\n\t\t\t\t\t\tline = lines[l];\n\t\t\t\t\t\tif (params.flipArcText) {\n\t\t\t\t\t\t\tchars = line.split('');\n\t\t\t\t\t\t\tchars.reverse();\n\t\t\t\t\t\t\tline = chars.join('');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnchars = line.length;\n\t\t\t\t\t\tctx.rotate(-(PI * params.letterSpacing * (nchars - 1)) / 2);\n\t\t\t\t\t\t// Loop through characters on each line\n\t\t\t\t\t\tfor (c = 0; c < nchars; c += 1) {\n\t\t\t\t\t\t\tch = line[c];\n\t\t\t\t\t\t\t// If character is not the first character\n\t\t\t\t\t\t\tif (c !== 0) {\n\t\t\t\t\t\t\t\t// Rotate character onto arc\n\t\t\t\t\t\t\t\tctx.rotate(PI * params.letterSpacing);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tctx.save();\n\t\t\t\t\t\t\tctx.translate(0, -params.radius);\n\t\t\t\t\t\t\tif (params.flipArcText) {\n\t\t\t\t\t\t\t\tctx.scale(-1, -1);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tctx.fillText(ch, 0, 0);\n\t\t\t\t\t\t\t// Prevent extra shadow created by stroke (but only when fill is present)\n\t\t\t\t\t\t\tif (params.fillStyle !== 'transparent') {\n\t\t\t\t\t\t\t\tctx.shadowColor = 'transparent';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (params.strokeWidth !== 0) {\n\t\t\t\t\t\t\t\t// Only stroke if the stroke is not 0\n\t\t\t\t\t\t\t\tctx.strokeText(ch, 0, 0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tctx.restore();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tparams.radius -= fontSize;\n\t\t\t\t\t\tparams.letterSpacing += fontSize / (constantCloseness * 2 * PI);\n\t\t\t\t\t\tctx.restore();\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Draw each line of text separately\n\t\t\t\t\tfor (l = 0; l < lines.length; l += 1) {\n\t\t\t\t\t\tline = lines[l];\n\t\t\t\t\t\t// Add line offset to center point, but subtract some to center everything\n\t\t\t\t\t\ty = params.y + (l * params.height / lines.length) - (((lines.length - 1) * params.height / lines.length) / 2);\n\n\t\t\t\t\t\tctx.shadowColor = params.shadowColor;\n\n\t\t\t\t\t\t// Fill & stroke text\n\t\t\t\t\t\tctx.fillText(line, x, y);\n\t\t\t\t\t\t// Prevent extra shadow created by stroke (but only when fill is present)\n\t\t\t\t\t\tif (params.fillStyle !== 'transparent') {\n\t\t\t\t\t\t\tctx.shadowColor = 'transparent';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (params.strokeWidth !== 0) {\n\t\t\t\t\t\t\t// Only stroke if the stroke is not 0\n\t\t\t\t\t\t\tctx.strokeText(line, x, y);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// Adjust bounding box according to text baseline\n\t\t\t\ty = 0;\n\t\t\t\tif (params.baseline === 'top') {\n\t\t\t\t\ty += params.height / 2;\n\t\t\t\t} else if (params.baseline === 'bottom') {\n\t\t\t\t\ty -= params.height / 2;\n\t\t\t\t}\n\n\t\t\t\t// Detect jCanvas events\n\t\t\t\tif (params._event) {\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\tctx.rect(\n\t\t\t\t\t\tparams.x - (params.width / 2),\n\t\t\t\t\t\tparams.y - (params.height / 2) + y,\n\t\t\t\t\t\tparams.width,\n\t\t\t\t\t\tparams.height\n\t\t\t\t\t);\n\t\t\t\t\t_detectEvents($canvases[e], ctx, params);\n\t\t\t\t\t// Close path and configure masking\n\t\t\t\t\tctx.closePath();\n\t\t\t\t}\n\t\t\t\t_restoreTransform(ctx, params);\n\n\t\t\t}\n\t\t}\n\t}\n\t// Cache jCanvas parameters object for efficiency\n\tcaches.propCache = params;\n\treturn $canvases;\n};\n\n// Measures text width/height using the given parameters\n$.fn.measureText = function measureText(args) {\n\tvar $canvases = this, ctx,\n\t\tparams, lines;\n\n\t// Attempt to retrieve layer\n\tparams = $canvases.getLayer(args);\n\t// If layer does not exist or if returned object is not a jCanvas layer\n\tif (!params || (params && !params._layer)) {\n\t\tparams = new jCanvasObject(args);\n\t}\n\n\tctx = _getContext($canvases[0]);\n\tif (ctx) {\n\n\t\t// Set canvas font using given properties\n\t\t_setCanvasFont($canvases[0], ctx, params);\n\t\t// Calculate width and height of text\n\t\tif (params.maxWidth !== null) {\n\t\t\tlines = _wrapText(ctx, params);\n\t\t} else {\n\t\t\tlines = params.text.split('\\n');\n\t\t}\n\t\t_measureText($canvases[0], ctx, params, lines);\n\n\n\t}\n\n\treturn params;\n};\n\n/* Image API */\n\n// Draws image on canvas\n$.fn.drawImage = function drawImage(args) {\n\tvar $canvases = this, canvas, e, ctx, data,\n\t\tparams, layer,\n\t\timg, imgCtx, source,\n\t\timageCache = caches.imageCache;\n\n\t// Draw image function\n\tfunction draw(canvas, ctx, data, params, layer) {\n\n\t\t// If width and sWidth are not defined, use image width\n\t\tif (params.width === null && params.sWidth === null) {\n\t\t\tparams.width = params.sWidth = img.width;\n\t\t}\n\t\t// If width and sHeight are not defined, use image height\n\t\tif (params.height === null && params.sHeight === null) {\n\t\t\tparams.height = params.sHeight = img.height;\n\t\t}\n\n\t\t// Ensure image layer's width and height are accurate\n\t\tif (layer) {\n\t\t\tlayer.width = params.width;\n\t\t\tlayer.height = params.height;\n\t\t}\n\n\t\t// Only crop image if all cropping properties are given\n\t\tif (params.sWidth !== null && params.sHeight !== null && params.sx !== null && params.sy !== null) {\n\n\t\t\t// If width is not defined, use the given sWidth\n\t\t\tif (params.width === null) {\n\t\t\t\tparams.width = params.sWidth;\n\t\t\t}\n\t\t\t// If height is not defined, use the given sHeight\n\t\t\tif (params.height === null) {\n\t\t\t\tparams.height = params.sHeight;\n\t\t\t}\n\n\t\t\t// Optionally crop from top-left corner of region\n\t\t\tif (params.cropFromCenter) {\n\t\t\t\tparams.sx += params.sWidth / 2;\n\t\t\t\tparams.sy += params.sHeight / 2;\n\t\t\t}\n\n\t\t\t// Ensure cropped region does not escape image boundaries\n\n\t\t\t// Top\n\t\t\tif ((params.sy - (params.sHeight / 2)) < 0) {\n\t\t\t\tparams.sy = (params.sHeight / 2);\n\t\t\t}\n\t\t\t// Bottom\n\t\t\tif ((params.sy + (params.sHeight / 2)) > img.height) {\n\t\t\t\tparams.sy = img.height - (params.sHeight / 2);\n\t\t\t}\n\t\t\t// Left\n\t\t\tif ((params.sx - (params.sWidth / 2)) < 0) {\n\t\t\t\tparams.sx = (params.sWidth / 2);\n\t\t\t}\n\t\t\t// Right\n\t\t\tif ((params.sx + (params.sWidth / 2)) > img.width) {\n\t\t\t\tparams.sx = img.width - (params.sWidth / 2);\n\t\t\t}\n\n\t\t\t_transformShape(canvas, ctx, params, params.width, params.height);\n\t\t\t_setGlobalProps(canvas, ctx, params);\n\n\t\t\t// Draw image\n\t\t\tctx.drawImage(\n\t\t\t\timg,\n\t\t\t\tparams.sx - (params.sWidth / 2),\n\t\t\t\tparams.sy - (params.sHeight / 2),\n\t\t\t\tparams.sWidth,\n\t\t\t\tparams.sHeight,\n\t\t\t\tparams.x - (params.width / 2),\n\t\t\t\tparams.y - (params.height / 2),\n\t\t\t\tparams.width,\n\t\t\t\tparams.height\n\t\t\t);\n\n\t\t} else {\n\t\t\t// Show entire image if no crop region is defined\n\n\t\t\t_transformShape(canvas, ctx, params, params.width, params.height);\n\t\t\t_setGlobalProps(canvas, ctx, params);\n\n\t\t\t// Draw image on canvas\n\t\t\tctx.drawImage(\n\t\t\t\timg,\n\t\t\t\tparams.x - (params.width / 2),\n\t\t\t\tparams.y - (params.height / 2),\n\t\t\t\tparams.width,\n\t\t\t\tparams.height\n\t\t\t);\n\n\t\t}\n\n\t\t// Draw invisible rectangle to allow for events and masking\n\t\tctx.beginPath();\n\t\tctx.rect(\n\t\t\tparams.x - (params.width / 2),\n\t\t\tparams.y - (params.height / 2),\n\t\t\tparams.width,\n\t\t\tparams.height\n\t\t);\n\t\t// Check for jCanvas events\n\t\t_detectEvents(canvas, ctx, params);\n\t\t// Close path and configure masking\n\t\tctx.closePath();\n\t\t_restoreTransform(ctx, params);\n\t\t_enableMasking(ctx, data, params);\n\t}\n\t// On load function\n\tfunction onload(canvas, ctx, data, params, layer) {\n\t\treturn function () {\n\t\t\tvar $canvas = $(canvas);\n\t\t\tdraw(canvas, ctx, data, params, layer);\n\t\t\tif (params.layer) {\n\t\t\t\t// Trigger 'load' event for layers\n\t\t\t\t_triggerLayerEvent($canvas, data, layer, 'load');\n\t\t\t} else if (params.load) {\n\t\t\t\t// Run 'load' callback for non-layers\n\t\t\t\tparams.load.call($canvas[0], layer);\n\t\t\t}\n\t\t\t// Continue drawing successive layers after this image layer has loaded\n\t\t\tif (params.layer) {\n\t\t\t\t// Store list of previous masks for each layer\n\t\t\t\tlayer._masks = data.transforms.masks.slice(0);\n\t\t\t\tif (params._next) {\n\t\t\t\t\t// Draw successive layers\n\t\t\t\t\tvar complete = data.drawLayersComplete;\n\t\t\t\t\tdelete data.drawLayersComplete;\n\t\t\t\t\t$canvas.drawLayers({\n\t\t\t\t\t\tclear: false,\n\t\t\t\t\t\tresetFire: true,\n\t\t\t\t\t\tindex: params._next,\n\t\t\t\t\t\tcomplete: complete\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\tcanvas = $canvases[e];\n\t\tctx = _getContext($canvases[e]);\n\t\tif (ctx) {\n\n\t\t\tdata = _getCanvasData($canvases[e]);\n\t\t\tparams = new jCanvasObject(args);\n\t\t\tlayer = _addLayer($canvases[e], params, args, drawImage);\n\t\t\tif (params.visible) {\n\n\t\t\t\t// Cache the given source\n\t\t\t\tsource = params.source;\n\n\t\t\t\timgCtx = source.getContext;\n\t\t\t\tif (source.src || imgCtx) {\n\t\t\t\t\t// Use image or canvas element if given\n\t\t\t\t\timg = source;\n\t\t\t\t} else if (source) {\n\t\t\t\t\tif (imageCache[source] && imageCache[source].complete) {\n\t\t\t\t\t\t// Get the image element from the cache if possible\n\t\t\t\t\t\timg = imageCache[source];\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Otherwise, get the image from the given source URL\n\t\t\t\t\t\timg = new Image();\n\t\t\t\t\t\t// If source URL is not a data URL\n\t\t\t\t\t\tif (!source.match(/^data:/i)) {\n\t\t\t\t\t\t\t// Set crossOrigin for this image\n\t\t\t\t\t\t\timg.crossOrigin = params.crossOrigin;\n\t\t\t\t\t\t}\n\t\t\t\t\t\timg.src = source;\n\t\t\t\t\t\t// Save image in cache for improved performance\n\t\t\t\t\t\timageCache[source] = img;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (img) {\n\t\t\t\t\tif (img.complete || imgCtx) {\n\t\t\t\t\t\t// Draw image if already loaded\n\t\t\t\t\t\tonload(canvas, ctx, data, params, layer)();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Otherwise, draw image when it loads\n\t\t\t\t\t\timg.onload = onload(canvas, ctx, data, params, layer);\n\t\t\t\t\t\t// Fix onload() bug in IE9\n\t\t\t\t\t\timg.src = img.src;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t}\n\treturn $canvases;\n};\n\n// Creates a canvas pattern object\n$.fn.createPattern = function createPattern(args) {\n\tvar $canvases = this, ctx,\n\t\tparams,\n\t\timg, imgCtx,\n\t\tpattern, source;\n\n\t// Function to be called when pattern loads\n\tfunction onload() {\n\t\t// Create pattern\n\t\tpattern = ctx.createPattern(img, params.repeat);\n\t\t// Run callback function if defined\n\t\tif (params.load) {\n\t\t\tparams.load.call($canvases[0], pattern);\n\t\t}\n\t}\n\n\tctx = _getContext($canvases[0]);\n\tif (ctx) {\n\n\t\tparams = new jCanvasObject(args);\n\n\t\t// Cache the given source\n\t\tsource = params.source;\n\n\t\t// Draw when image is loaded (if load() callback function is defined)\n\n\t\tif (isFunction(source)) {\n\t\t\t// Draw pattern using function if given\n\n\t\t\timg = $('<canvas />')[0];\n\t\t\timg.width = params.width;\n\t\t\timg.height = params.height;\n\t\t\timgCtx = _getContext(img);\n\t\t\tsource.call(img, imgCtx);\n\t\t\tonload();\n\n\t\t} else {\n\t\t\t// Otherwise, draw pattern using source image\n\n\t\t\timgCtx = source.getContext;\n\t\t\tif (source.src || imgCtx) {\n\t\t\t\t// Use image element if given\n\t\t\t\timg = source;\n\t\t\t} else {\n\t\t\t\t// Use URL if given to get the image\n\t\t\t\timg = new Image();\n\t\t\t\t// If source URL is not a data URL\n\t\t\t\tif (!source.match(/^data:/i)) {\n\t\t\t\t\t// Set crossOrigin for this image\n\t\t\t\t\timg.crossOrigin = params.crossOrigin;\n\t\t\t\t}\n\t\t\t\timg.src = source;\n\t\t\t}\n\n\t\t\t// Create pattern if already loaded\n\t\t\tif (img.complete || imgCtx) {\n\t\t\t\tonload();\n\t\t\t} else {\n\t\t\t\timg.onload = onload;\n\t\t\t\t// Fix onload() bug in IE9\n\t\t\t\timg.src = img.src;\n\t\t\t}\n\n\t\t}\n\n\t} else {\n\n\t\tpattern = null;\n\n\t}\n\treturn pattern;\n};\n\n// Creates a canvas gradient object\n$.fn.createGradient = function createGradient(args) {\n\tvar $canvases = this, ctx,\n\t\tparams,\n\t\tgradient,\n\t\tstops = [], nstops,\n\t\tstart, end,\n\t\ti, a, n, p;\n\n\tparams = new jCanvasObject(args);\n\tctx = _getContext($canvases[0]);\n\tif (ctx) {\n\n\t\t// Gradient coordinates must be defined\n\t\tparams.x1 = params.x1 || 0;\n\t\tparams.y1 = params.y1 || 0;\n\t\tparams.x2 = params.x2 || 0;\n\t\tparams.y2 = params.y2 || 0;\n\n\t\tif (params.r1 !== null && params.r2 !== null) {\n\t\t\t// Create radial gradient if chosen\n\t\t\tgradient = ctx.createRadialGradient(params.x1, params.y1, params.r1, params.x2, params.y2, params.r2);\n\t\t} else {\n\t\t\t// Otherwise, create a linear gradient by default\n\t\t\tgradient = ctx.createLinearGradient(params.x1, params.y1, params.x2, params.y2);\n\t\t}\n\n\t\t// Count number of color stops\n\t\tfor (i = 1; params['c' + i] !== undefined; i += 1) {\n\t\t\tif (params['s' + i] !== undefined) {\n\t\t\t\tstops.push(params['s' + i]);\n\t\t\t} else {\n\t\t\t\tstops.push(null);\n\t\t\t}\n\t\t}\n\t\tnstops = stops.length;\n\n\t\t// Define start stop if not already defined\n\t\tif (stops[0] === null) {\n\t\t\tstops[0] = 0;\n\t\t}\n\t\t// Define end stop if not already defined\n\t\tif (stops[nstops - 1] === null) {\n\t\t\tstops[nstops - 1] = 1;\n\t\t}\n\n\t\t// Loop through color stops to fill in the blanks\n\t\tfor (i = 0; i < nstops; i += 1) {\n\t\t\t// A progression, in this context, is defined as all of the color stops between and including two known color stops\n\n\t\t\tif (stops[i] !== null) {\n\t\t\t\t// Start a new progression if stop is a number\n\n\t\t\t\t// Number of stops in current progression\n\t\t\t\tn = 1;\n\t\t\t\t// Current iteration in current progression\n\t\t\t\tp = 0;\n\t\t\t\tstart = stops[i];\n\n\t\t\t\t// Look ahead to find end stop\n\t\t\t\tfor (a = (i + 1); a < nstops; a += 1) {\n\t\t\t\t\tif (stops[a] !== null) {\n\t\t\t\t\t\t// If this future stop is a number, make it the end stop for this progression\n\t\t\t\t\t\tend = stops[a];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Otherwise, keep looking ahead\n\t\t\t\t\t\tn += 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Ensure start stop is not greater than end stop\n\t\t\t\tif (start > end) {\n\t\t\t\t\tstops[a] = stops[i];\n\t\t\t\t}\n\n\t\t\t} else if (stops[i] === null) {\n\t\t\t\t// Calculate stop if not initially given\n\t\t\t\tp += 1;\n\t\t\t\tstops[i] = start + (p * ((end - start) / n));\n\t\t\t}\n\t\t\t// Add color stop to gradient object\n\t\t\tgradient.addColorStop(stops[i], params['c' + (i + 1)]);\n\t\t}\n\n\t} else {\n\t\tgradient = null;\n\t}\n\treturn gradient;\n};\n\n// Manipulates pixels on the canvas\n$.fn.setPixels = function setPixels(args) {\n\tvar $canvases = this,\n\t\tcanvas, e, ctx, canvasData,\n\t\tparams,\n\t\tpx,\n\t\timgData, pixelData, i, len;\n\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\tcanvas = $canvases[e];\n\t\tctx = _getContext(canvas);\n\t\tcanvasData = _getCanvasData($canvases[e]);\n\t\tif (ctx) {\n\n\t\t\tparams = new jCanvasObject(args);\n\t\t\t_addLayer(canvas, params, args, setPixels);\n\t\t\t_transformShape($canvases[e], ctx, params, params.width, params.height);\n\n\t\t\t// Use entire canvas of x, y, width, or height is not defined\n\t\t\tif (params.width === null || params.height === null) {\n\t\t\t\tparams.width = canvas.width;\n\t\t\t\tparams.height = canvas.height;\n\t\t\t\tparams.x = params.width / 2;\n\t\t\t\tparams.y = params.height / 2;\n\t\t\t}\n\n\t\t\tif (params.width !== 0 && params.height !== 0) {\n\t\t\t\t// Only set pixels if width and height are not zero\n\n\t\t\t\timgData = ctx.getImageData(\n\t\t\t\t\t(params.x - (params.width / 2)) * canvasData.pixelRatio,\n\t\t\t\t\t(params.y - (params.height / 2)) * canvasData.pixelRatio,\n\t\t\t\t\tparams.width * canvasData.pixelRatio,\n\t\t\t\t\tparams.height * canvasData.pixelRatio\n\t\t\t\t);\n\t\t\t\tpixelData = imgData.data;\n\t\t\t\tlen = pixelData.length;\n\n\t\t\t\t// Loop through pixels with the \"each\" callback function\n\t\t\t\tif (params.each) {\n\t\t\t\t\tfor (i = 0; i < len; i += 4) {\n\t\t\t\t\t\tpx = {\n\t\t\t\t\t\t\tr: pixelData[i],\n\t\t\t\t\t\t\tg: pixelData[i + 1],\n\t\t\t\t\t\t\tb: pixelData[i + 2],\n\t\t\t\t\t\t\ta: pixelData[i + 3]\n\t\t\t\t\t\t};\n\t\t\t\t\t\tparams.each.call(canvas, px, params);\n\t\t\t\t\t\tpixelData[i] = px.r;\n\t\t\t\t\t\tpixelData[i + 1] = px.g;\n\t\t\t\t\t\tpixelData[i + 2] = px.b;\n\t\t\t\t\t\tpixelData[i + 3] = px.a;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// Put pixels on canvas\n\t\t\t\tctx.putImageData(\n\t\t\t\t\timgData,\n\t\t\t\t\t(params.x - (params.width / 2)) * canvasData.pixelRatio,\n\t\t\t\t\t(params.y - (params.height / 2)) * canvasData.pixelRatio\n\t\t\t\t);\n\t\t\t\t// Restore transformation\n\t\t\t\tctx.restore();\n\n\t\t\t}\n\n\t\t}\n\t}\n\treturn $canvases;\n};\n\n// Retrieves canvas image as data URL\n$.fn.getCanvasImage = function getCanvasImage(type, quality) {\n\tvar $canvases = this, canvas,\n\t\tdataURL = null;\n\tif ($canvases.length !== 0) {\n\t\tcanvas = $canvases[0];\n\t\tif (canvas.toDataURL) {\n\t\t\t// JPEG quality defaults to 1\n\t\t\tif (quality === undefined) {\n\t\t\t\tquality = 1;\n\t\t\t}\n\t\t\tdataURL = canvas.toDataURL('image/' + type, quality);\n\t\t}\n\t}\n\treturn dataURL;\n};\n\n// Scales canvas based on the device's pixel ratio\n$.fn.detectPixelRatio = function detectPixelRatio(callback) {\n\tvar $canvases = this,\n\t\tcanvas, e, ctx,\n\t\tdevicePixelRatio, backingStoreRatio, ratio,\n\t\toldWidth, oldHeight,\n\t\tdata;\n\n\tfor (e = 0; e < $canvases.length; e += 1) {\n\t\t// Get canvas and its associated data\n\t\tcanvas = $canvases[e];\n\t\tctx = _getContext(canvas);\n\t\tdata = _getCanvasData($canvases[e]);\n\n\t\t// If canvas has not already been scaled with this method\n\t\tif (!data.scaled) {\n\n\t\t\t// Determine device pixel ratios\n\t\t\tdevicePixelRatio = window.devicePixelRatio || 1;\n\t\t\tbackingStoreRatio = ctx.webkitBackingStorePixelRatio ||\n\t\t\t\tctx.mozBackingStorePixelRatio ||\n\t\t\t\tctx.msBackingStorePixelRatio ||\n\t\t\t\tctx.oBackingStorePixelRatio ||\n\t\t\t\tctx.backingStorePixelRatio || 1;\n\n\t\t\t// Calculate general ratio based on the two given ratios\n\t\t\tratio = devicePixelRatio / backingStoreRatio;\n\n\t\t\tif (ratio !== 1) {\n\t\t\t\t// Scale canvas relative to ratio\n\n\t\t\t\t// Get the current canvas dimensions for future use\n\t\t\t\toldWidth = canvas.width;\n\t\t\t\toldHeight = canvas.height;\n\n\t\t\t\t// Resize canvas relative to the determined ratio\n\t\t\t\tcanvas.width = oldWidth * ratio;\n\t\t\t\tcanvas.height = oldHeight * ratio;\n\n\t\t\t\t// Scale canvas back to original dimensions via CSS\n\t\t\t\tcanvas.style.width = oldWidth + 'px';\n\t\t\t\tcanvas.style.height = oldHeight + 'px';\n\n\t\t\t\t// Scale context to counter the manual scaling of canvas\n\t\t\t\tctx.scale(ratio, ratio);\n\n\t\t\t}\n\n\t\t\t// Set pixel ratio on canvas data object\n\t\t\tdata.pixelRatio = ratio;\n\t\t\t// Ensure that this method can only be called once for any given canvas\n\t\t\tdata.scaled = true;\n\n\t\t\t// Call the given callback function with the ratio as its only argument\n\t\t\tif (callback) {\n\t\t\t\tcallback.call(canvas, ratio);\n\t\t\t}\n\n\t\t}\n\n\t}\n\treturn $canvases;\n};\n\n// Clears the jCanvas cache\njCanvas.clearCache = function clearCache() {\n\tvar cacheName;\n\tfor (cacheName in caches) {\n\t\tif (Object.prototype.hasOwnProperty.call(caches, cacheName)) {\n\t\t\tcaches[cacheName] = {};\n\t\t}\n\t}\n};\n\n// Enable canvas feature detection with $.support\n$.support.canvas = ($('<canvas />')[0].getContext !== undefined);\n\n// Export jCanvas functions\nextendObject(jCanvas, {\n\tdefaults: defaults,\n\tsetGlobalProps: _setGlobalProps,\n\ttransformShape: _transformShape,\n\tdetectEvents: _detectEvents,\n\tclosePath: _closePath,\n\tsetCanvasFont: _setCanvasFont,\n\tmeasureText: _measureText\n});\n$.jCanvas = jCanvas;\n$.jCanvasObject = jCanvasObject;\n\n}));\n","<template>\r\n  <!-- 标注页面 -->\r\n  <div id=\"TagImage\">\r\n    <!--弹窗 标注是弹出 -->\r\n    <el-dialog\r\n      title=\"标签名\"\r\n      :visible.sync=\"dialogVisible\"\r\n      :close-on-click-modal=\"false\"\r\n      width=\"30%\"\r\n      :before-close=\"cancel\"\r\n      ><el-autocomplete\r\n        class=\"inline-input\"\r\n        v-model=\"tagName\"\r\n        :fetch-suggestions=\"querySearch\"\r\n        placeholder=\"请输入内容\"\r\n        @select=\"handleSelect\"\r\n      ></el-autocomplete>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"cancel\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"determine\">确 定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n    <!-- 弹窗 标注标签管理弹窗 -->\r\n    <el-dialog\r\n      title=\"标签管理\"\r\n      :visible.sync=\"dialogVisible2\"\r\n      :close-on-click-modal=\"false\"\r\n      width=\"30%\"\r\n    >\r\n      <el-tag\r\n        :key=\"tag\"\r\n        v-for=\"tag in dynamicTags\"\r\n        closable\r\n        :disable-transitions=\"false\"\r\n        @close=\"handleClose(tag)\"\r\n      >\r\n        {{ tag }}\r\n      </el-tag>\r\n      <el-input\r\n        class=\"input-new-tag\"\r\n        v-if=\"inputVisible\"\r\n        v-model=\"inputValue\"\r\n        ref=\"saveTagInput\"\r\n        size=\"small\"\r\n        @keyup.enter.native=\"handleInputConfirm\"\r\n        @blur=\"handleInputConfirm\"\r\n      >\r\n      </el-input>\r\n      <el-button v-else class=\"button-new-tag\" size=\"small\" @click=\"showInput\"\r\n        >+ New Tag</el-button\r\n      >\r\n\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"cancelManage\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"determineManage\">确 定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n    <!-- 标题 -->\r\n    <el-row>\r\n      <el-col :span=\"24\"\r\n        ><div class=\"grid-content bg-purple-dark\" id=\"first\">\r\n          <el-button type=\"primary\" @click=\"lastPage\">返回</el-button>\r\n\r\n          <span>数据集:{{ paramList.dataSetName }}</span>\r\n        </div></el-col\r\n      >\r\n    </el-row>\r\n    <!-- 功能按钮 -->\r\n    <!-- <el-row>\r\n      <el-col :span=\"24\"\r\n        ><div\r\n          class=\"grid-content bg-purple\"\r\n          id=\"second\"\r\n          v-show=\"isTaged == false\"\r\n        >\r\n          <el-button @click=\"startTag\" class=\"startTag untrainedBtn\"\r\n            >开启标注</el-button\r\n          >\r\n          <el-button @click=\"stopTag\" class=\"stopTag untrainedBtn\"\r\n            >关闭标注</el-button\r\n          >\r\n          <el-button @click=\"unTarget\" class=\"untrainedBtn\">无目标</el-button>\r\n          <el-button @click=\"removeOne\" class=\"removeOne untrainedBtn\"\r\n            >删除上一个标注</el-button\r\n          >\r\n          <el-button @click=\"managerTag\" class=\"managerTag untrainedBtn\"\r\n            >标注管理</el-button\r\n          >\r\n          <el-button @click=\"saveData\" class=\"managerTag untrainedBtn\"\r\n            >保存</el-button\r\n          >\r\n        </div>\r\n        <div\r\n          class=\"grid-content bg-purple\"\r\n          id=\"second\"\r\n          v-show=\"isTaged == true\"\r\n        >\r\n          <el-button\r\n            @click=\"removeTag(curImage, curImageIndex)\"\r\n            class=\"removeOne untrainedBtn\"\r\n            >删除全部标注</el-button\r\n          >\r\n        </div>\r\n      </el-col>\r\n    </el-row> -->\r\n    <!-- 内容部分 -->\r\n    <el-row class=\"el_row_three\">\r\n      <!-- 图片列表部分 -->\r\n      <el-col class=\"noEmpty\" :span=\"4\">\r\n        <div id=\"TagManage\">\r\n          <!-- 标题 -->\r\n          <div class=\"title\">图片列表</div>\r\n          <!-- 已标注未标注按钮盒子 -->\r\n          <div class=\"btnList\">\r\n            <div\r\n              class=\"btnItem\"\r\n              :style=\"isTaged ? '' : 'background:#85CE61;'\"\r\n              @click=\"setIsTaged(false)\"\r\n            >\r\n              未标注\r\n            </div>\r\n            <div\r\n              class=\"btnItem\"\r\n              :style=\"isTaged ? 'background:#85CE61;' : ''\"\r\n              @click=\"setIsTaged(true)\"\r\n            >\r\n              已标注\r\n            </div>\r\n          </div>\r\n          <!-- 图片盒子 -->\r\n          <div class=\"imgBtnList\" @click=\"selectImg($event.target.dataset)\">\r\n            <div class=\"listEmpty\" v-show=\"total_pics == 0\">\r\n              <div>\r\n                <img src=\"~assets/images/kong.png\" alt=\"\" />\r\n                <div>暂无图片</div>\r\n              </div>\r\n            </div>\r\n            <div\r\n              class=\"imgBtn\"\r\n              v-for=\"(value, index) in isTagImgList\"\r\n              :key=\"value.imagename\"\r\n              :data-index=\"index\"\r\n            >\r\n              <el-image :src=\"value.image\" :data-index=\"index\"></el-image>\r\n              <!-- Array.isArray(value['labelBoxes']) || value.unTag -->\r\n              <div\r\n                class=\"imgTag\"\r\n                v-show=\"Array.isArray(value['labelBoxes']) || value.unTag\"\r\n              >\r\n                已标注\r\n              </div>\r\n              <!-- <div\r\n                class=\"imgTag\"\r\n                v-show=\"\r\n                  Array.isArray(value['labelBoxes']) &&\r\n                  value['labelBoxes'].length == 0 &&\r\n                  value.unTag\r\n                \"\r\n              >\r\n                无目标\r\n              </div> -->\r\n            </div>\r\n          </div>\r\n          <!--分页按钮  -->\r\n          <div class=\"pageBtn\">\r\n            <el-button\r\n              :disabled=\"\r\n                isNextPage == 'unLast' || isNextPage == 'unAll' ? true : false\r\n              \"\r\n              @click=\"getPage(-1)\"\r\n              >上一批</el-button\r\n            >\r\n            <el-button\r\n              :disabled=\"\r\n                isNextPage == 'unNext' || isNextPage == 'unAll' ? true : false\r\n              \"\r\n              @click=\"getPage(1)\"\r\n              >下一批</el-button\r\n            >\r\n          </div>\r\n        </div>\r\n      </el-col>\r\n      <!-- 中间部分 -->\r\n      <el-col class=\"noEmpty\" :span=\"16\">\r\n        <!-- <div class=\"Empty\" v-show=\"total_pics == 0\"> -->\r\n        <!-- 图表为空时 -->\r\n        <div class=\"Empty\" v-show=\"total_pics == 0\">\r\n          <div>\r\n            <img src=\"~assets/images/kong.png\" alt=\"\" />\r\n            <div>暂无图片</div>\r\n          </div>\r\n        </div>\r\n        <!-- 图表不为空时 -->\r\n        <div id=\"total\">\r\n          <div class=\"command\">\r\n            <div v-if=\"isTaged == false\" class=\"btns\">\r\n              <span class=\"iconfont icon-kuangxuan1\" @click=\"startTag\">\r\n                <i class=\"tip\">标注</i>\r\n              </span>\r\n              <span class=\"iconfont icon-wancheng-copy\" @click=\"saveData\"\r\n                ><i class=\"tip\">保存</i></span\r\n              >\r\n              <span\r\n                class=\"icon iconfont icon-icon_common_region\"\r\n                @click=\"unTarget\"\r\n                ><i class=\"tips\">无包含目标</i></span\r\n              >\r\n              <span class=\"icon iconfont icon-shanchu\" @click=\"removeOne\"\r\n                ><i class=\"tips\">删除上一个</i>\r\n              </span>\r\n            </div>\r\n            <div v-if=\"isTaged == true\" class=\"btns\">\r\n              <span\r\n                class=\"icon iconfont icon-shanchu\"\r\n                @click=\"removeTag(curImage, curImageIndex)\"\r\n              ></span>\r\n            </div>\r\n          </div>\r\n          <div\r\n            v-show=\"total_pics != 0\"\r\n            class=\"grid-content bg-purple\"\r\n            id=\"three\"\r\n            ref=\"three\"\r\n          >\r\n            <div id=\"threeTag\" ref=\"threeTag\"></div>\r\n            <img\r\n              id=\"biaoZu\"\r\n              :src=\"imgPath\"\r\n              alt=\"暂无图片\"\r\n              @load=\"resizeImgV2(curImage)\"\r\n              ref=\"biaoZu\"\r\n            />\r\n            <canvas id=\"myCanvas\" ref=\"myCanvas\"></canvas>\r\n          </div>\r\n          <div class=\"info\">\r\n            <span>title</span>\r\n            <span\r\n              ><el-button\r\n                size=\"mini\"\r\n                round\r\n                @click=\"up\"\r\n                v-show=\"curImageIndex != 0\"\r\n                >上一张</el-button\r\n              ><el-button\r\n                size=\"mini\"\r\n                round\r\n                @click=\"down\"\r\n                v-show=\"curImageIndex != isTagImgList.length - 1\"\r\n                >下一张</el-button\r\n              ></span\r\n            >\r\n          </div>\r\n        </div>\r\n      </el-col>\r\n      <!-- 标签列表部分 -->\r\n      <!-- class=\"labels\" -->\r\n      <el-col :span=\"4\">\r\n        <div id=\"labelManage\">\r\n          <!-- 标题 -->\r\n          <div class=\"labelsList\">\r\n            <el-row class=\"title\">检测标签</el-row>\r\n            <el-row class=\"searchtag\">\r\n              <el-col :span=\"21\">\r\n                <el-input\r\n                  class=\"searchs\"\r\n                  ref=\"inlineInput\"\r\n                  type=\"text\"\r\n                  v-model=\"search\"\r\n                  placeholder=\"请输入内容\"\r\n                  prefix-icon=\"el-icon-search\"\r\n                  clearable\r\n                  @clear=\"clearList()\"\r\n                  @change=\"searchAction()\"\r\n                  @focus=\"handleSearch()\"\r\n                  @blur=\"clear()\"\r\n                >\r\n                </el-input>\r\n              </el-col>\r\n              <el-col :span=\"3\">\r\n                <el-button class=\"addtag\" size=\"small\" @click=\"managerTag()\"\r\n                  >+</el-button\r\n                >\r\n              </el-col>\r\n            </el-row>\r\n            <el-row>\r\n              <el-scrollbar ref=\"scrollList\" class=\"scrollList\">\r\n                <ul\r\n                  v-infinite-scroll=\"load\"\r\n                  :infinite-scroll-disabled=\"disabled\"\r\n                  :infinite-scroll-immediate=\"false\"\r\n                  :infinite-scroll-delay=\"500\"\r\n                  class=\"labelList\"\r\n                  v-for=\"(item, index) in dynamicTags\"\r\n                  :key=\"item + index\"\r\n                >\r\n                  <li class=\"labelitem\">{{ item }}</li>\r\n                </ul>\r\n              </el-scrollbar>\r\n            </el-row>\r\n            <el-row class=\"page\">\r\n              <el-pagination small layout=\"prev, pager, next\" :total=\"50\">\r\n              </el-pagination>\r\n            </el-row>\r\n          </div>\r\n          <div class=\"labelRecord\">\r\n            <el-row class=\"title\">标注记录</el-row>\r\n\r\n            <el-row v-if=\"isTaged\" class=\"labelList\">\r\n              <!-- <el-col\r\n                class=\"labelitem\"\r\n                v-for=\"(item, index) in dynamicTags\"\r\n                :key=\"item + index\"\r\n                >{{ item }}</el-col\r\n              > -->\r\n              <el-table\r\n                :data=\"tableList\"\r\n                class=\"labels\"\r\n                max-height=\"220px\"\r\n                max-width=\"160px\"\r\n                :row-style=\"{ height: '34px' }\"\r\n                :cell-style=\"{ padding: '0' }\"\r\n              >\r\n                <el-table-column\r\n                  prop=\"date\"\r\n                  label=\"类别\"\r\n                  width=\"90\"\r\n                ></el-table-column>\r\n                <el-table-column\r\n                  prop=\"name\"\r\n                  label=\"数量\"\r\n                  width=\"50\"\r\n                ></el-table-column>\r\n              </el-table>\r\n            </el-row>\r\n            <el-row v-if=\"!isTaged\"></el-row>\r\n          </div>\r\n        </div>\r\n        <!-- 标注记录盒子 -->\r\n      </el-col>\r\n    </el-row>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport jcanvas from \"jcanvas\";\r\njcanvas($, window);\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      // 未标注图片路径\r\n      // imgPathList: [],\r\n      //已经标注的图片\r\n      // ImgPathListed: [],\r\n      // 未标注 当前图片的下标\r\n      // imgPathListIndex: 0,\r\n      //已标注图片的下标\r\n      // imgTagIndex: 0,\r\n      //当前图片路径\r\n      imgPath: \"\",\r\n      //当前图片的宽高\r\n      imgWH: { width: 0, height: 0 },\r\n      //标志现在是在查看已标注的图片还是未标注的图片, false是未标注\r\n      looking: false,\r\n      tagImg: [],\r\n      // 标注时:保存一张图片的全部标注信息（左上角、右下角、标注名）\r\n      msgList: [],\r\n      //标注时：保存一张图片的标注名称\r\n      tagName: \"\",\r\n      trained: 10,\r\n      untrained: 20,\r\n      //一张图片的标注个数\r\n      layer: 0,\r\n\r\n      // 发送时: 一张图片的全部标注\r\n      imgTagDist: {\r\n        folder: \"\",\r\n        version: \"\",\r\n        imgName: \"\",\r\n        imgWidth: \"\",\r\n        imgHeight: \"\",\r\n        TagList: [{ tagName: \"\", leftUp: [], rightDown: [] }],\r\n        ratio: \"\",\r\n        action: \"\",\r\n      },\r\n      // 控制弹窗显隐\r\n      dialogVisible: false,\r\n      //输入框提示列表\r\n      restaurants: [],\r\n      //缩放 标志\r\n      ratio: 1,\r\n      //控制标签弹窗的显隐\r\n      dialogVisible2: false,\r\n      dynamicTags: [],\r\n      inputVisible: false,\r\n      inputValue: \"\",\r\n\r\n      // pageShow: {\r\n      //   version: \"\",\r\n      //   modelName: \"\",\r\n      //   trained: \"\",\r\n      //   untrained: \"\",\r\n      // },\r\n      //控制遮罩层,isLoading为2 则加载完成\r\n      isLoading: 0,\r\n      loading: \"\",\r\n      /**\r\n       * 新的变量\r\n       */\r\n      //   图片列表 [{ imagename:图片名,image:图片,imagesize:\"宽,高\" }]\r\n      isTagImgList: [],\r\n      pagenumber: 1, //页数\r\n      pagesize: 12, //页面数量\r\n      total_pics: 0, //图片总数\r\n      total_pages: 1, //图片总页数\r\n      isTaged: false, // 是否标注,默认未标注\r\n      curImage: {}, //当前选中的图片\r\n      ratioHeight: 680, //缩放的高度\r\n      ratioWidth: 1200, //缩放的宽度\r\n      curImageIndex: 0,\r\n      // layer: 0,一张图片的标注个数\r\n      // 获取后台数据入参 保存在vuex中\r\n      paramList: {\r\n        dataSetName: \"\", //   页面展示\r\n        pagenumber: 1, //页数\r\n        pagesize: 12,\r\n        tagStatus: 0, //后台参数 未标注\r\n        scaleHeight: 240,\r\n      },\r\n      disabled: false,\r\n      tableList: [], //表格数据\r\n      currentPage: 1,\r\n      pageSize: 12,\r\n      search: \"\", //搜索关键字\r\n    };\r\n  },\r\n  computed: {\r\n    //当前图片路径TagImage\r\n    imgUrl() {\r\n      const that = this;\r\n      return that.imgPath;\r\n    },\r\n    // 选中数据集版本信息\r\n    itemDate() {\r\n      return this.$store.state.ItemDetails.itemDate;\r\n    },\r\n    //已标注图片列表 和 未标注列表的长度,looking\r\n    twoListLength() {\r\n      //   return [this.ImgPathListed.length, this.imgPathList.length, this.looking]\r\n      return [1, 1, this.looking];\r\n    },\r\n    // isPageShow() {\r\n    //   return this.pageShow;\r\n    // },\r\n    //监听标注状态和当前页数\r\n    imgParam() {\r\n      let param = {};\r\n      param.isTaged = this.isTaged; //是否标注\r\n      param.pageNum = this.pagenumber; //页数\r\n      console.log(param);\r\n      return param;\r\n    },\r\n    // 监听是否有下一页或上一页\r\n    isNextPage() {\r\n      let isNext = \"ok\";\r\n      if (\r\n        this.pagenumber * this.pagesize >= this.total_pics &&\r\n        this.pagenumber == 1\r\n      ) {\r\n        isNext = \"unAll\";\r\n      } else if (this.pagenumber * this.pagesize > this.total_pics) {\r\n        isNext = \"unNext\";\r\n      } else if (this.pagenumber <= 1) {\r\n        isNext = \"unLast\";\r\n      }\r\n      return isNext;\r\n    },\r\n  },\r\n  watch: {\r\n    twoListLength: {\r\n      handler(newVal, oldVal) {\r\n        //   [已标注长度,未标注长度]\r\n        console.log(newVal);\r\n        if (newVal[0] === 0 && this.looking) {\r\n          console.log(\"已标注图片为零,隐藏界面\");\r\n          $(\".Empty\").css({ display: \"flex\" });\r\n          $(\".noEmpty\").css({ display: \"none\" });\r\n        } else if (newVal[1] === 0 && !this.looking) {\r\n          console.log(\"未标注图片为零,隐藏界面\");\r\n          $(\".Empty\").css({ display: \"flex\" });\r\n          $(\".noEmpty\").css({ display: \"none\" });\r\n        } else if (newVal[0] !== 0 && this.looking) {\r\n          $(\".Empty\").css({ display: \"none\" });\r\n          $(\".noEmpty\").css({ display: \"table\" });\r\n          this.drawPen();\r\n        } else if (newVal[1] !== 0 && !this.looking) {\r\n          $(\".Empty\").css({ display: \"none\" });\r\n          $(\".noEmpty\").css({ display: \"table\" });\r\n          this.drawPen();\r\n        }\r\n      },\r\n      deep: true,\r\n    },\r\n    // isPageShow: {\r\n    //   handler(newVal, oldVal) {\r\n    //     this.$store.commit(\"setImgNum\", newVal.trained);\r\n    //   },\r\n    //   deep: true,\r\n    // },\r\n    //当isloading为2时,将遮罩层取消\r\n    isLoading: {\r\n      handler(newVal, oldVal) {\r\n        if (newVal == 2) {\r\n          this.loading.close();\r\n        }\r\n      },\r\n    },\r\n    // 监听是已标注还是未标注\r\n    imgParam: {\r\n      handler(newVal) {\r\n        // this.createLoading();\r\n        console.log(this.pagenumber);\r\n        this.paramList.pageNum = this.pagenumber;\r\n        if (newVal.isTaged) {\r\n          //已标注\r\n          this.getTagedImage();\r\n        } else {\r\n          //未标注\r\n          this.getUnTagImage();\r\n          //   this.imgPath = require('assets/images/kong.png')\r\n        }\r\n      },\r\n    },\r\n  },\r\n  methods: {\r\n    up() {\r\n      // if (this.curImageIndex != 0) {\r\n      //  this.isTagImgList[this.curImageIndex-1]\r\n      this.curImageIndex -= 1;\r\n      console.log(this.curImageIndex);\r\n      this.curImage = this.isTagImgList[this.curImageIndex];\r\n      this.resizeImgV2(this.curImage);\r\n      // console.log(this.curImage);\r\n      // }\r\n    },\r\n    down() {\r\n      if (this.curImageIndex < this.isTagImgList.length - 1) {\r\n        //  this.isTagImgList[this.curImageIndex-1]\r\n        this.curImageIndex += 1;\r\n        console.log(this.curImageIndex);\r\n        this.curImage = this.isTagImgList[this.curImageIndex];\r\n        this.resizeImgV2(this.curImage);\r\n      }\r\n    },\r\n    // 滚动加载\r\n    load() {\r\n      this.getTagName();\r\n    },\r\n    clearList() {},\r\n    searchAction() {},\r\n    handleSearch() {},\r\n    clear() {},\r\n    //  添加窗口尺寸改变监听:发生改变时重新调用drawPen()\r\n    resizeWindow() {\r\n      const that = this;\r\n      $(function () {\r\n        console.log(\"刷新\");\r\n        $(window).resize(() => {\r\n          that.stopTag();\r\n          that.startTag();\r\n\r\n          //   setTimeout(() => {\r\n          //     that.startTag()\r\n          //   }, 1000)\r\n        });\r\n      });\r\n    },\r\n    //初始化,获取标签管理信息\r\n    getTagName() {\r\n      const that = this;\r\n      console.log(this.$store.state.ItemDetails.itemDate);\r\n      that.paramList.dataSetName = this.$store.state.ItemDetails.itemDate;\r\n      this.$api\r\n        .showLabel({\r\n          dataSetName: that.paramList.dataSetName,\r\n        })\r\n        .then((res) => {\r\n          console.log(res);\r\n          if (Array.isArray(res.voc_classes) && res.voc_classes) {\r\n            that.restaurants = res.voc_classes;\r\n            this.dynamicTags = [];\r\n            that.restaurants.forEach((res) => {\r\n              that.dynamicTags.push(res.value);\r\n            });\r\n          } else {\r\n            that.$message({\r\n              type: \"info\",\r\n              message: \"标签集为空,请先打开标注管理输入标签\",\r\n            });\r\n          }\r\n        })\r\n        .catch((err) => {\r\n          console.log(err);\r\n        });\r\n    },\r\n    //展示数据集名称\r\n    showData() {\r\n      this.paramList.dataSetName = this.$store.state.ItemDetails.itemDate;\r\n      // sessionStorage.setItem(\r\n      //   \"store\",\r\n      //   JSON.stringify(this.paramList.dataSetName)\r\n      // );\r\n      this.getTagName();\r\n    },\r\n    //返回上一个页面\r\n    lastPage() {\r\n      // this.$router.go(-1);\r\n      this.$router.push({ name: \"image\" });\r\n      // });\r\n      this.isTagImgList[0] = \"\";\r\n      this.curImage = \"\";\r\n      this.isTagImgList = [];\r\n      this.msgList = [];\r\n      this.tagImg = [];\r\n      this.tagName = \"\";\r\n      // this.paramList.dataSetName = \"\";\r\n      this.clearCanvas();\r\n    },\r\n\r\n    // 暂停标注\r\n    stopTag() {\r\n      $(\"#myCanvas\")[0].onmousedown = undefined;\r\n      $(\"#myCanvas\")[0].onmouseup = undefined;\r\n      $(\"#myCanvas\")[0].onmousemove = undefined;\r\n    },\r\n    //开始标注\r\n    startTag() {\r\n      this.stopTag();\r\n      this.drawPen();\r\n    },\r\n    // 重置画笔\r\n    drawPen() {\r\n      let color = \"red\";\r\n      let width = 1;\r\n      this.stopTag();\r\n      this.drawRect(\"myCanvas\", color, width);\r\n    },\r\n    // 画框\r\n    drawRect(canvasId, penColor, strokeWidth) {\r\n      let that = this;\r\n      let penWidth = strokeWidth;\r\n      let result = { leftUp: [], rightDown: [], tagName: \"\" };\r\n      let canvas = document.getElementById(canvasId);\r\n      //canvas 的矩形框\r\n      let canvasRect = canvas.getBoundingClientRect();\r\n      //矩形框的左上角坐标\r\n      let canvasLeft = canvasRect.left;\r\n      let canvasTop = canvasRect.top;\r\n      let x = 0;\r\n      let y = 0;\r\n      let layerName = \"layer\";\r\n      //鼠标点击按下事件，画图准备\r\n      canvas.onmousedown = function (e) {\r\n        //设置画笔颜色和宽度\r\n        let color = penColor;\r\n        that.layer += 1;\r\n        layerName = `layer${that.layer}`;\r\n        x = e.clientX - canvasLeft;\r\n        y = e.clientY - canvasTop;\r\n        // 左顶点\r\n        console.log(\"左上顶点\");\r\n        console.log(x, y);\r\n        // 缩放还原\r\n        let x1 = parseInt(x / that.ratio);\r\n        let y1 = parseInt(y / that.ratio);\r\n        result.leftUp = [x1, y1];\r\n        $(\"#\" + canvasId).addLayer({\r\n          type: \"rectangle\",\r\n          strokeStyle: color,\r\n          strokeWidth: penWidth,\r\n          name: layerName,\r\n          fromCenter: false,\r\n          x: x,\r\n          y: y,\r\n          width: 1,\r\n          height: 1,\r\n        });\r\n\r\n        $(\"#\" + canvasId).drawLayers();\r\n        $(\"#\" + canvasId).saveCanvas();\r\n        //鼠标移动事件，画图\r\n        canvas.onmousemove = function (e) {\r\n          let width = e.clientX - canvasLeft - x;\r\n          let height = e.clientY - canvasTop - y;\r\n\r\n          $(\"#\" + canvasId).removeLayer(layerName);\r\n\r\n          $(\"#\" + canvasId).addLayer({\r\n            type: \"rectangle\",\r\n            strokeStyle: color,\r\n            strokeWidth: penWidth,\r\n            name: layerName,\r\n            fromCenter: false,\r\n            x: x,\r\n            y: y,\r\n            width: width,\r\n            height: height,\r\n          });\r\n\r\n          $(\"#\" + canvasId).drawLayers();\r\n        };\r\n      };\r\n      //鼠标点击抬起事件\r\n      canvas.onmouseup = function (e) {\r\n        let color = penColor;\r\n        let penWidth = penWidth;\r\n        canvas.onmousemove = null;\r\n        let width = e.clientX - canvasLeft - x;\r\n        let height = e.clientY - canvasTop - y;\r\n\r\n        // 计算相对原图大小\r\n        let canvasX = parseInt((e.clientX - canvasLeft) / that.ratio);\r\n        let canvasY = parseInt((e.clientY - canvasTop) / that.ratio);\r\n        $(\"#\" + canvasId).removeLayer(layerName);\r\n        if (width > 10 && height > 10) {\r\n          //   画的矩形宽高都不为0\r\n          //   result.rightDown = [e.clientX - canvasLeft, e.clientY - canvasTop]\r\n          //   右下顶点\r\n          result.rightDown = [canvasX, canvasY];\r\n          //   标注名\r\n          result.tagName = that.tagName;\r\n          $(\"#\" + canvasId).addLayer({\r\n            type: \"rectangle\",\r\n            strokeStyle: color,\r\n            strokeWidth: penWidth,\r\n            name: layerName,\r\n            fromCenter: false,\r\n            x: x,\r\n            y: y,\r\n            width: width,\r\n            height: height,\r\n          });\r\n          //   将标注信息添加到msgList\r\n          that.msgList.push(result);\r\n          console.log(that.msgList);\r\n          that.dialogVisible = true;\r\n          that.createTag(...[x, y]);\r\n        } else {\r\n          that.layer -= 1;\r\n        }\r\n        result = {};\r\n        $(\"#\" + canvasId).drawLayers();\r\n        $(\"#\" + canvasId).saveCanvas();\r\n      };\r\n    },\r\n    //标注完后生成标签\r\n    createTag(canvasX, canvasY) {\r\n      //   console.log(canvasX, canvasY)\r\n      const that = this;\r\n      let div = $(`<div id=\"layer${that.layer}\"></div>`);\r\n      div.css({\r\n        position: \"absolute\",\r\n        background: \"#99a9bf\",\r\n        left: `${canvasX}px`,\r\n        top: `${canvasY}px`,\r\n        color: \"yellow\",\r\n        \"z-index\": 1000,\r\n      });\r\n      $(\"#threeTag\").append(div);\r\n    },\r\n\r\n    //弹窗输入框 下拉列表\r\n    querySearch(queryString, cb) {\r\n      const that = this;\r\n      let restaurants = that.restaurants;\r\n      console.log(restaurants);\r\n      cb(restaurants);\r\n    },\r\n    // 监听input改变值\r\n    handleSelect(item) {\r\n      console.log(item);\r\n      this.tagImg = item;\r\n    },\r\n    // 将标注信息添加到未标注列表中\r\n    addLabelBoxes(tagList, curImageIndex) {\r\n      let labelBoxes = [];\r\n      if (!Array.isArray(tagList) || tagList.length <= 0) {\r\n        return;\r\n      }\r\n      tagList.forEach((item, index) => {\r\n        let labItem = {};\r\n        labItem.label = item.tagName;\r\n        labItem.xmin = item.leftUp[0];\r\n        labItem.ymin = item.leftUp[1];\r\n        labItem.xmax = item.rightDown[0];\r\n        labItem.ymax = item.rightDown[1];\r\n        labelBoxes.push(labItem);\r\n      });\r\n      console.log(labelBoxes);\r\n      this.isTagImgList[curImageIndex].labelBoxes = labelBoxes;\r\n      console.log(curImageIndex, this.isTagImgList[curImageIndex].labelBoxes);\r\n      this.isTagImgList[curImageIndex].ratio = this.ratio;\r\n      console.log(this.isTagImgList);\r\n      // this.saveData();\r\n      this.sendTagList();\r\n    },\r\n    //将标注数据发送给服务器\r\n    sendTagList() {\r\n      const that = this;\r\n      console.log(this.isTagImgList);\r\n      let msg = this.isTagImgList\r\n        .filter((item) => item.isClick && Array.isArray(item.labelBoxes))\r\n        .map((item) => {\r\n          // item.image = \"\";\r\n          // item.imagename = \"\";\r\n          return item;\r\n        });\r\n\r\n      console.log(msg);\r\n      let imgname = {};\r\n      let b = msg.forEach((item) => {\r\n        imgname = item.imagename;\r\n      });\r\n      console.log(imgname);\r\n      let imgItem = {};\r\n      let a = msg.forEach((item) => {\r\n        imgItem = item;\r\n      });\r\n      console.log(imgItem);\r\n      console.log(imgItem[\"imagesize\"]);\r\n\r\n      let imgWidth = parseInt(imgItem[\"imagesize\"].split(\",\")[0]);\r\n      let imgHeight = parseInt(imgItem[\"imagesize\"].split(\",\")[1]);\r\n\r\n      let params = {};\r\n      params.dataset = this.paramList.dataSetName;\r\n      params.imgName = imgname;\r\n      params.imgWidth = imgWidth;\r\n      params.imgHeight = imgHeight;\r\n      params.TagList = this.msgList;\r\n      params.ratio = this.ratio;\r\n      that.$api\r\n        .createTag(params)\r\n        .then((res) => {\r\n          console.log(res);\r\n        })\r\n        .catch((err) => {\r\n          console.log(err);\r\n        });\r\n    },\r\n    // 弹出窗的取消按钮\r\n    cancel() {\r\n      this.removeOne();\r\n      this.dialogVisible = false;\r\n    },\r\n    // 弹出窗的确定按钮\r\n    determine() {\r\n      const that = this;\r\n      //如果输入框为空,则确定按钮不能关闭弹窗\r\n      if (that.tagName == \"\") {\r\n        return;\r\n      }\r\n      // 给dom标签赋值\r\n      $(`#layer${that.layer}`).text(that.tagName);\r\n      //给msgList赋值\r\n      that.msgList[that.msgList.length - 1].tagName = that.tagName;\r\n      this.dialogVisible = false;\r\n    },\r\n    // 删除上一个标注\r\n    removeOne() {\r\n      const that = this;\r\n      let index = that.layer;\r\n      console.log(that.msgList);\r\n      //删除msgList最后一项\r\n      that.msgList.pop();\r\n      //删除canvas 图层\r\n      $(\"#myCanvas\").removeLayer(`layer${index}`);\r\n      //删除dom标签\r\n      $(`#layer${index}`).remove();\r\n      $(`#layer${index}`).empty();\r\n      $(\"#myCanvas\").drawLayers();\r\n      $(\"#myCanvas\").saveCanvas();\r\n      that.layer = that.layer === 0 ? 0 : index - 1;\r\n    },\r\n    removeTag(curImage, curImageIndex) {\r\n      console.log(curImage, curImageIndex, this.isTagImgList[curImageIndex]);\r\n      const that = this;\r\n      let index = that.layer;\r\n      console.log(index);\r\n      for (let i = index; i >= 1; i--) {\r\n        //删除canvas 图层\r\n        console.log(\"开始删除\" + i);\r\n        $(\"#myCanvas\").removeLayer(`layer${i}`);\r\n        //删除dom标签\r\n        $(`#layer${i}`).remove();\r\n        $(`#layer${i}`).empty();\r\n        $(\"#myCanvas\").drawLayers();\r\n        $(\"#myCanvas\").saveCanvas();\r\n        that.layer = that.layer === 0 ? 0 : i - 1;\r\n      }\r\n      let imgWidth = parseInt(curImage[\"imagesize\"].split(\",\")[0]);\r\n      let imgHeight = parseInt(curImage[\"imagesize\"].split(\",\")[1]);\r\n      let params = {};\r\n      params.dataset = this.paramList.dataSetName;\r\n      params.imgName = curImage.imagename;\r\n      params.imgWidth = imgWidth;\r\n      params.imgHeight = imgHeight;\r\n      params.ratio = this.ratio;\r\n      this.$api\r\n        .deleteTag(params)\r\n        .then((res) => {\r\n          console.log(res);\r\n          // console.log(curImageIndex);\r\n          console.log(that.isTagImgList[curImageIndex].labelBoxes);\r\n          delete that.isTagImgList[curImageIndex].labelBoxes;\r\n          that.isTagImgList[curImageIndex].del = true;\r\n          console.log(that.isTagImgList[curImageIndex]);\r\n          that.stopTag();\r\n        })\r\n        .catch((err) => {\r\n          console.log(err);\r\n        });\r\n      // if (curImage.isClick && that.isTagImgList[curImageIndex].del === true) {\r\n      //   this.stopTag();\r\n      // }\r\n    },\r\n    //加载新图片前,应该执行的清理动作\r\n    clearAll() {\r\n      const that = this;\r\n      that.msgList = [];\r\n      //清理标签\r\n      $(\"#threeTag\").empty();\r\n      let index = that.layer;\r\n      that.layer = 0;\r\n      that.imgTagDist = {};\r\n      that.ratio = 1;\r\n      //删除canvas 的矩形\r\n      while (index > 0) {\r\n        $(\"#myCanvas\").removeLayer(`layer${index}`);\r\n        $(\"#myCanvas\").drawLayers();\r\n        $(\"#myCanvas\").saveCanvas();\r\n        index -= 1;\r\n      }\r\n      $(\"#myCanvas\").drawLayers();\r\n      $(\"#myCanvas\").saveCanvas();\r\n    },\r\n    //计算图片缩放的比例\r\n    imgRatio(imgUrl) {\r\n      if (typeof imgUrl == \"string\") {\r\n        console.log(imgUrl);\r\n        let img = new Image();\r\n        img.src = imgUrl;\r\n        //一定要等图片加载完成后才能访问图片的宽高\r\n        img.onload = () => {\r\n          that.imgWH.width = img.width;\r\n          that.imgWH.height = img.height;\r\n          let ratio = 480 / img.height;\r\n          that.ratio = ratio;\r\n          let width = parseInt(ratio * img.width);\r\n          let height = parseInt(ratio * img.height);\r\n          $(\"#biaoZu\").css({\r\n            height: `${height}px`,\r\n            width: `${width}px`,\r\n          });\r\n          that.imgPath = imgUrl;\r\n        };\r\n      }\r\n      const that = this;\r\n    },\r\n    //标注标签管理\r\n    managerTag() {\r\n      this.dialogVisible2 = true;\r\n      const that = this;\r\n      this.dynamicTags = [];\r\n      that.restaurants.forEach((res) => {\r\n        that.dynamicTags.push(res.value);\r\n      });\r\n      console.log(\"打开标注管理\");\r\n    },\r\n    // 关闭标签管理弹窗\r\n    handleClose(tag) {\r\n      this.dynamicTags.splice(this.dynamicTags.indexOf(tag), 1);\r\n    },\r\n    // 标注管理中input聚焦\r\n    showInput() {\r\n      this.inputVisible = true;\r\n      this.$nextTick((_) => {\r\n        this.$refs.saveTagInput.$refs.input.focus();\r\n      });\r\n    },\r\n    // 标注管理中input失焦\r\n    handleInputConfirm() {\r\n      let inputValue = this.inputValue;\r\n      if (inputValue) {\r\n        this.dynamicTags.push(inputValue);\r\n      }\r\n      this.inputVisible = false;\r\n      this.inputValue = \"\";\r\n    },\r\n    //取消按钮 隐藏弹窗\r\n    cancelManage() {\r\n      this.dialogVisible2 = false;\r\n    },\r\n    //确定按钮 隐藏添加标签\r\n    determineManage() {\r\n      this.dialogVisible2 = false;\r\n      this.restaurants = [];\r\n      this.dynamicTags.forEach((item) => {\r\n        this.restaurants.push({ value: item });\r\n      });\r\n      // 上传新建标签\r\n      this.postTagList();\r\n    },\r\n    //上传标签组\r\n    postTagList() {\r\n      const that = this;\r\n      that.$api\r\n        .uploadLabel({\r\n          dataSetName: this.paramList.dataSetName,\r\n          voc_classes: this.restaurants,\r\n        })\r\n        .then((res) => {\r\n          console.log(res);\r\n          // that.restaurants = res.voc_classes;\r\n          that.$message({\r\n            type: \"success\",\r\n            message: \"标签保存成功\",\r\n          });\r\n        })\r\n        .catch((error) => {\r\n          console.log(error);\r\n          that.$message({\r\n            type: \"error\",\r\n            message: \"标签保存失败\",\r\n          });\r\n        });\r\n    },\r\n    //无目标\r\n    unTarget() {\r\n      this.isTagImgList[this.curImageIndex].labelBoxes = [];\r\n      this.isTagImgList[this.curImageIndex].unTag = true;\r\n      this.isTagImgList[this.curImageIndex].ratio = 1;\r\n      // this.isTagImgList[this.curImageIndex].tagText = \"无目标\";\r\n      this.sendTagList();\r\n    },\r\n    // 保存\r\n    saveData() {\r\n      this.addLabelBoxes(this.msgList, this.curImageIndex);\r\n      // this.isTagImgList[this.curImageIndex].labelBoxes ;\r\n      this.stopTag();\r\n    },\r\n\r\n    /*  图片列表 */\r\n\r\n    //触发遮罩层\r\n    createLoading() {\r\n      this.loading = this.$loading({\r\n        lock: true,\r\n        text: \"正在加载图片...\",\r\n        spinner: \"el-icon-loading\",\r\n        background: \"rgba(0, 0, 0, 0.7)\",\r\n      });\r\n    },\r\n    // 未标注图片 分页获取\r\n    getUnTagImage() {\r\n      console.log(\"未标注\");\r\n      const that = this;\r\n      that.curImageIndex = 0;\r\n      // this.paramList.dataSetName = this.itemDate;\r\n      this.paramList.dataSetName = this.$store.state.ItemDetails.itemDate;\r\n      this.$store.commit(\r\n        \"ItemDetails/unTagImgList\",\r\n        this.paramList.dataSetName\r\n      );\r\n      // console.log(this.itemDate);\r\n      // this.$store.commit(\"ItemDetails/paramList\", that.paramList);\r\n      // sessionStorage.getItem(\"store\");\r\n\r\n      this.$api\r\n        .ImageList({\r\n          dataSetName: this.paramList.dataSetName,\r\n          pageNum: this.paramList.pagenumber,\r\n          pageSize: this.paramList.pagesize,\r\n          tagStatus: this.paramList.tagStatus,\r\n          scaleHeight: this.paramList.scaleHeight,\r\n        })\r\n        .then((res) => {\r\n          console.log(res);\r\n          console.log(this.paramList.dataSetName);\r\n          this.$store.commit(\"ItemDetails/unTagImgList\", this.paramList);\r\n          if (res.code == 200) {\r\n            that.total_pics = res.images.total_pics;\r\n            that.total_pages = res.images.total_pages;\r\n            that.isTagImgList = res.images.imgs;\r\n            // this.$store.commit(\"ItemDetails/isTagImgList\", that.isTagImgList);\r\n            if (that.isTagImgList.length > 0) {\r\n              that.isTagImgList[0].isClick = true;\r\n              that.curImage = that.isTagImgList[0];\r\n              // this.$store.commit(\"ItemDetails/curImage\", that.curImage);\r\n              // console.log(that.curImage);\r\n\r\n              that.resizeImgV2(that.isTagImgList[0]);\r\n\r\n              that.imgPath = that.isTagImgList[0].image;\r\n              // 需图片加载完成后画布才能被确定大小生成\r\n              // that.startTag();\r\n            }\r\n          } else if (res.code == 402) {\r\n            this.total_pics = res.image_msg.length;\r\n            that.$message({\r\n              type: \"\",\r\n              message: \"未标注图片列表为空\",\r\n            });\r\n          } else {\r\n            that.$message({\r\n              type: \"error\",\r\n              message: \"图片列表获取失败\",\r\n            });\r\n          }\r\n          // that.loading.close();\r\n        })\r\n        .catch((err) => {\r\n          // that.loading.close();\r\n          console.log(err);\r\n        });\r\n    },\r\n    // 已标注图片 分页获取\r\n    getTagedImage() {\r\n      const that = this;\r\n      that.curImageIndex = 0;\r\n      this.$api\r\n        .ImageList({\r\n          dataSetName: this.paramList.dataSetName,\r\n          pageNum: this.paramList.pagenumber,\r\n          pageSize: this.paramList.pagesize,\r\n          tagStatus: this.paramList.tagStatus,\r\n          scaleHeight: this.paramList.scaleHeight,\r\n        })\r\n        .then((res) => {\r\n          if (res.code == 200) {\r\n            this.$store.commit(\"ItemDetails/isTagImgList\", this.paramList);\r\n            console.log(res);\r\n            that.total_pics = res.images.total_pics;\r\n            that.total_pages = res.images.total_pages;\r\n            that.isTagImgList = res.images.imgs;\r\n\r\n            if (that.isTagImgList.length > 0) {\r\n              // that.startTag();\r\n              that.isTagImgList[0].isClick = true;\r\n              that.curImage = that.isTagImgList[0];\r\n              // this.$store.commit(\"ItemDetails/curImage\", that.curImage);\r\n              // console.log(that.curImage);\r\n              that.resizeImgV2(that.isTagImgList[0]);\r\n              console.log(that.isTagImgList[0]);\r\n              that.imgPath = that.isTagImgList[0].image;\r\n            }\r\n            //   console.log();\r\n          } else if (res.code == 402) {\r\n            this.total_pics = res.image_msg.length;\r\n            that.$message({\r\n              type: \"\",\r\n              message: \"已标注图片列表为空\",\r\n            });\r\n          } else {\r\n            that.$message({\r\n              type: \"error\",\r\n              message: \"图片列表获取失败\",\r\n            });\r\n          }\r\n          // that.loading.close();\r\n        })\r\n        .catch((err) => {\r\n          console.log(err);\r\n          // that.loading.close();\r\n        });\r\n    },\r\n    //改变已标注和未标注按钮\r\n    setIsTaged(tf) {\r\n      console.log(tf);\r\n      // false 未标注,true 已标注\r\n\r\n      // 页数重置为一\r\n      this.pagenumber = 1;\r\n      this.paramList.pagenumber = 1;\r\n      this.isTaged = tf;\r\n      if (this.isTaged === false) {\r\n        this.paramList.tagStatus = 0;\r\n      } else {\r\n        this.paramList.tagStatus = 1;\r\n      }\r\n\r\n      console.log(\"按钮改变了\" + tf);\r\n\r\n      //   发送数据\r\n      this.addLabelBoxes(this.msgList, this.curImageIndex);\r\n      $(\"#threeTag\").empty();\r\n      // 清空画布和标签\r\n      this.clearCanvas();\r\n      // 清空标签列表数据\r\n      this.msgList = [];\r\n    },\r\n    // 上一批 , 下一批 页数加一或减一\r\n    getPage(num) {\r\n      //   发送数据\r\n      // this.sendTagList();\r\n      this.pagenumber += num;\r\n      this.paramList.pagenumber = this.pagenumber;\r\n      if (this.isTaged) {\r\n        this.getTagName();\r\n      } else {\r\n        this.getUnTagImage();\r\n      }\r\n    },\r\n    // 选中图片\r\n    selectImg(e) {\r\n      this.addLabelBoxes(this.msgList, this.curImageIndex);\r\n      this.msgList = [];\r\n      this.curImage = this.isTagImgList[e.index];\r\n      //   添加点击标志\r\n      this.isTagImgList[e.index].isClick = true;\r\n      this.curImageIndex = e.index;\r\n      console.log(e.index);\r\n      this.resizeImgV2(this.curImage);\r\n      console.log(this.curImage);\r\n    },\r\n    //操作选中图片 imgItem图片信息\r\n    resizeImgV2(imgItem) {\r\n      const that = this;\r\n      console.log(this.curImage);\r\n      // 清理标签和画布\r\n      $(\"#threeTag\").empty();\r\n      that.clearCanvas();\r\n\r\n      let imgHeight = parseInt(imgItem[\"imagesize\"].split(\",\")[1]);\r\n      let imgWidth = parseInt(imgItem[\"imagesize\"].split(\",\")[0]);\r\n\r\n      console.log(imgHeight, imgWidth);\r\n      let ratio = \"\";\r\n      let width = \"\";\r\n      let height = \"\";\r\n      ratio = that.ratioWidth / imgWidth;\r\n      that.ratio = ratio;\r\n      if (ratio < 0.8) {\r\n        ratio = that.ratioWidth / imgWidth;\r\n        that.ratio = ratio;\r\n        console.log(\"按宽比例缩放\" + ratio);\r\n        width = parseInt(ratio * imgWidth);\r\n        height = parseInt(that.ratio * imgHeight);\r\n      } else if (ratio > 0.8) {\r\n        ratio = that.ratioHeight / imgHeight;\r\n        that.ratio = ratio;\r\n        console.log(\"按高比例缩放\" + ratio);\r\n        width = parseInt(ratio * imgWidth);\r\n        height = parseInt(ratio * imgHeight);\r\n      }\r\n      // let height = parseInt(that.ratio * imgHeight);\r\n      // let height = parseInt(ratio * imgHeight);\r\n      //图片\r\n      this.$refs[\"biaoZu\"].style.height = `${height}px`;\r\n      this.$refs[\"biaoZu\"].style.width = `${width}px`;\r\n      // 画布\r\n      this.$refs[\"myCanvas\"].setAttribute(\"width\", `${width}px`);\r\n      this.$refs[\"myCanvas\"].setAttribute(\"height\", `${height}px`);\r\n      this.$refs[\"threeTag\"].style.height = `${height}px`;\r\n      this.$refs[\"threeTag\"].style.width = `${width}px`;\r\n      this.imgPath = imgItem.image;\r\n      // that.stopTag();\r\n      // that.drawPen();\r\n      that.startTag();\r\n      if (Array.isArray(imgItem[\"labelBoxes\"])) {\r\n        that.layer = imgItem[\"labelBoxes\"].length;\r\n        // 已标注的图片不能更改 可以删除标注\r\n        this.stopTag();\r\n        this.addTagRect(imgItem[\"labelBoxes\"]);\r\n      } else if (imgItem[\"del\"] === true) {\r\n        this.stopTag();\r\n      }\r\n    },\r\n    // 添加方框和标注\r\n    addTagRect(labelBoxes) {\r\n      const that = this;\r\n      let ratio = this.ratio;\r\n      that.layer = 0;\r\n      //重置画笔\r\n      labelBoxes.forEach((item, index) => {\r\n        let x = parseInt(item.xmin * ratio);\r\n        let y = parseInt(item.ymin * ratio);\r\n        let width = parseInt((item.xmax - item.xmin) * ratio);\r\n        let height = parseInt((item.ymax - item.ymin) * ratio);\r\n        let tagName = item.label;\r\n        that.layer += 1;\r\n        // 添加标注标签\r\n        let div = $(\r\n          `<div id=\"layer${that.layer}\" class=\"isShowLayer\">${tagName}</div>`\r\n        );\r\n        div.css({\r\n          position: \"absolute\",\r\n          background: \"rgb(107,124,152)\",\r\n          left: `${x}px`,\r\n          top: `${y}px`,\r\n          color: \"yellow\",\r\n          \"z-index\": 1000,\r\n        });\r\n        // 添加方框\r\n        $(\"#myCanvas\").addLayer({\r\n          type: \"rectangle\",\r\n          strokeStyle: \"red\",\r\n          strokeWidth: 1,\r\n          name: `layer${that.layer}`,\r\n          fromCenter: false,\r\n          x: x,\r\n          y: y,\r\n          width: width,\r\n          height: height,\r\n        });\r\n        $(\"#myCanvas\").drawLayers();\r\n        $(\"#myCanvas\").saveCanvas();\r\n        $(\"#threeTag\").append(div);\r\n      });\r\n    },\r\n    // 清理画布\r\n    clearCanvas() {\r\n      const that = this;\r\n      //清理标签\r\n      //   $('#threeTag').empty()\r\n      let index = that.layer;\r\n      that.layer = 0;\r\n      that.imgTagDist = {};\r\n      that.ratio = 1;\r\n      //删除canvas 的矩形\r\n      while (index > 0) {\r\n        $(\"#myCanvas\").removeLayer(`layer${index}`);\r\n        $(\"#myCanvas\").drawLayers();\r\n        $(\"#myCanvas\").saveCanvas();\r\n        index -= 1;\r\n      }\r\n      $(\"#myCanvas\").drawLayers();\r\n      $(\"#myCanvas\").saveCanvas();\r\n    },\r\n  },\r\n\r\n  created() {\r\n    // this.getUnTagImage();\r\n  },\r\n  mounted() {\r\n    //窗口刷新\r\n    this.resizeWindow();\r\n    this.getUnTagImage();\r\n    this.getTagName();\r\n  },\r\n  activated() {\r\n    this.getUnTagImage();\r\n    this.getTagName();\r\n  },\r\n  beforeDestroy() {\r\n    this.cancelListening();\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import \"~assets/scss/Navigation/Details/tagImage.scss\";\r\n</style>\r\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"TagImage\"}},[_c('el-dialog',{attrs:{\"title\":\"标签名\",\"visible\":_vm.dialogVisible,\"close-on-click-modal\":false,\"width\":\"30%\",\"before-close\":_vm.cancel},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[_c('el-autocomplete',{staticClass:\"inline-input\",attrs:{\"fetch-suggestions\":_vm.querySearch,\"placeholder\":\"请输入内容\"},on:{\"select\":_vm.handleSelect},model:{value:(_vm.tagName),callback:function ($$v) {_vm.tagName=$$v},expression:\"tagName\"}}),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":_vm.cancel}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.determine}},[_vm._v(\"确 定\")])],1)],1),_c('el-dialog',{attrs:{\"title\":\"标签管理\",\"visible\":_vm.dialogVisible2,\"close-on-click-modal\":false,\"width\":\"30%\"},on:{\"update:visible\":function($event){_vm.dialogVisible2=$event}}},[_vm._l((_vm.dynamicTags),function(tag){return _c('el-tag',{key:tag,attrs:{\"closable\":\"\",\"disable-transitions\":false},on:{\"close\":function($event){return _vm.handleClose(tag)}}},[_vm._v(\" \"+_vm._s(tag)+\" \")])}),(_vm.inputVisible)?_c('el-input',{ref:\"saveTagInput\",staticClass:\"input-new-tag\",attrs:{\"size\":\"small\"},on:{\"blur\":_vm.handleInputConfirm},nativeOn:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.handleInputConfirm($event)}},model:{value:(_vm.inputValue),callback:function ($$v) {_vm.inputValue=$$v},expression:\"inputValue\"}}):_c('el-button',{staticClass:\"button-new-tag\",attrs:{\"size\":\"small\"},on:{\"click\":_vm.showInput}},[_vm._v(\"+ New Tag\")]),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":_vm.cancelManage}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.determineManage}},[_vm._v(\"确 定\")])],1)],2),_c('el-row',[_c('el-col',{attrs:{\"span\":24}},[_c('div',{staticClass:\"grid-content bg-purple-dark\",attrs:{\"id\":\"first\"}},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.lastPage}},[_vm._v(\"返回\")]),_c('span',[_vm._v(\"数据集:\"+_vm._s(_vm.paramList.dataSetName))])],1)])],1),_c('el-row',{staticClass:\"el_row_three\"},[_c('el-col',{staticClass:\"noEmpty\",attrs:{\"span\":4}},[_c('div',{attrs:{\"id\":\"TagManage\"}},[_c('div',{staticClass:\"title\"},[_vm._v(\"图片列表\")]),_c('div',{staticClass:\"btnList\"},[_c('div',{staticClass:\"btnItem\",style:(_vm.isTaged ? '' : 'background:#85CE61;'),on:{\"click\":function($event){return _vm.setIsTaged(false)}}},[_vm._v(\" 未标注 \")]),_c('div',{staticClass:\"btnItem\",style:(_vm.isTaged ? 'background:#85CE61;' : ''),on:{\"click\":function($event){return _vm.setIsTaged(true)}}},[_vm._v(\" 已标注 \")])]),_c('div',{staticClass:\"imgBtnList\",on:{\"click\":function($event){return _vm.selectImg($event.target.dataset)}}},[_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.total_pics == 0),expression:\"total_pics == 0\"}],staticClass:\"listEmpty\"},[_c('div',[_c('img',{attrs:{\"src\":require(\"assets/images/kong.png\"),\"alt\":\"\"}}),_c('div',[_vm._v(\"暂无图片\")])])]),_vm._l((_vm.isTagImgList),function(value,index){return _c('div',{key:value.imagename,staticClass:\"imgBtn\",attrs:{\"data-index\":index}},[_c('el-image',{attrs:{\"src\":value.image,\"data-index\":index}}),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(Array.isArray(value['labelBoxes']) || value.unTag),expression:\"Array.isArray(value['labelBoxes']) || value.unTag\"}],staticClass:\"imgTag\"},[_vm._v(\" 已标注 \")])],1)})],2),_c('div',{staticClass:\"pageBtn\"},[_c('el-button',{attrs:{\"disabled\":_vm.isNextPage == 'unLast' || _vm.isNextPage == 'unAll' ? true : false},on:{\"click\":function($event){return _vm.getPage(-1)}}},[_vm._v(\"上一批\")]),_c('el-button',{attrs:{\"disabled\":_vm.isNextPage == 'unNext' || _vm.isNextPage == 'unAll' ? true : false},on:{\"click\":function($event){return _vm.getPage(1)}}},[_vm._v(\"下一批\")])],1)])]),_c('el-col',{staticClass:\"noEmpty\",attrs:{\"span\":16}},[_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.total_pics == 0),expression:\"total_pics == 0\"}],staticClass:\"Empty\"},[_c('div',[_c('img',{attrs:{\"src\":require(\"assets/images/kong.png\"),\"alt\":\"\"}}),_c('div',[_vm._v(\"暂无图片\")])])]),_c('div',{attrs:{\"id\":\"total\"}},[_c('div',{staticClass:\"command\"},[(_vm.isTaged == false)?_c('div',{staticClass:\"btns\"},[_c('span',{staticClass:\"iconfont icon-kuangxuan1\",on:{\"click\":_vm.startTag}},[_c('i',{staticClass:\"tip\"},[_vm._v(\"标注\")])]),_c('span',{staticClass:\"iconfont icon-wancheng-copy\",on:{\"click\":_vm.saveData}},[_c('i',{staticClass:\"tip\"},[_vm._v(\"保存\")])]),_c('span',{staticClass:\"icon iconfont icon-icon_common_region\",on:{\"click\":_vm.unTarget}},[_c('i',{staticClass:\"tips\"},[_vm._v(\"无包含目标\")])]),_c('span',{staticClass:\"icon iconfont icon-shanchu\",on:{\"click\":_vm.removeOne}},[_c('i',{staticClass:\"tips\"},[_vm._v(\"删除上一个\")])])]):_vm._e(),(_vm.isTaged == true)?_c('div',{staticClass:\"btns\"},[_c('span',{staticClass:\"icon iconfont icon-shanchu\",on:{\"click\":function($event){return _vm.removeTag(_vm.curImage, _vm.curImageIndex)}}})]):_vm._e()]),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.total_pics != 0),expression:\"total_pics != 0\"}],ref:\"three\",staticClass:\"grid-content bg-purple\",attrs:{\"id\":\"three\"}},[_c('div',{ref:\"threeTag\",attrs:{\"id\":\"threeTag\"}}),_c('img',{ref:\"biaoZu\",attrs:{\"id\":\"biaoZu\",\"src\":_vm.imgPath,\"alt\":\"暂无图片\"},on:{\"load\":function($event){return _vm.resizeImgV2(_vm.curImage)}}}),_c('canvas',{ref:\"myCanvas\",attrs:{\"id\":\"myCanvas\"}})]),_c('div',{staticClass:\"info\"},[_c('span',[_vm._v(\"title\")]),_c('span',[_c('el-button',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.curImageIndex != 0),expression:\"curImageIndex != 0\"}],attrs:{\"size\":\"mini\",\"round\":\"\"},on:{\"click\":_vm.up}},[_vm._v(\"上一张\")]),_c('el-button',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.curImageIndex != _vm.isTagImgList.length - 1),expression:\"curImageIndex != isTagImgList.length - 1\"}],attrs:{\"size\":\"mini\",\"round\":\"\"},on:{\"click\":_vm.down}},[_vm._v(\"下一张\")])],1)])])]),_c('el-col',{attrs:{\"span\":4}},[_c('div',{attrs:{\"id\":\"labelManage\"}},[_c('div',{staticClass:\"labelsList\"},[_c('el-row',{staticClass:\"title\"},[_vm._v(\"检测标签\")]),_c('el-row',{staticClass:\"searchtag\"},[_c('el-col',{attrs:{\"span\":21}},[_c('el-input',{ref:\"inlineInput\",staticClass:\"searchs\",attrs:{\"type\":\"text\",\"placeholder\":\"请输入内容\",\"prefix-icon\":\"el-icon-search\",\"clearable\":\"\"},on:{\"clear\":function($event){return _vm.clearList()},\"change\":function($event){return _vm.searchAction()},\"focus\":function($event){return _vm.handleSearch()},\"blur\":function($event){return _vm.clear()}},model:{value:(_vm.search),callback:function ($$v) {_vm.search=$$v},expression:\"search\"}})],1),_c('el-col',{attrs:{\"span\":3}},[_c('el-button',{staticClass:\"addtag\",attrs:{\"size\":\"small\"},on:{\"click\":function($event){return _vm.managerTag()}}},[_vm._v(\"+\")])],1)],1),_c('el-row',[_c('el-scrollbar',{ref:\"scrollList\",staticClass:\"scrollList\"},_vm._l((_vm.dynamicTags),function(item,index){return _c('ul',{directives:[{name:\"infinite-scroll\",rawName:\"v-infinite-scroll\",value:(_vm.load),expression:\"load\"}],key:item + index,staticClass:\"labelList\",attrs:{\"infinite-scroll-disabled\":_vm.disabled,\"infinite-scroll-immediate\":false,\"infinite-scroll-delay\":500}},[_c('li',{staticClass:\"labelitem\"},[_vm._v(_vm._s(item))])])}),0)],1),_c('el-row',{staticClass:\"page\"},[_c('el-pagination',{attrs:{\"small\":\"\",\"layout\":\"prev, pager, next\",\"total\":50}})],1)],1),_c('div',{staticClass:\"labelRecord\"},[_c('el-row',{staticClass:\"title\"},[_vm._v(\"标注记录\")]),(_vm.isTaged)?_c('el-row',{staticClass:\"labelList\"},[_c('el-table',{staticClass:\"labels\",attrs:{\"data\":_vm.tableList,\"max-height\":\"220px\",\"max-width\":\"160px\",\"row-style\":{ height: '34px' },\"cell-style\":{ padding: '0' }}},[_c('el-table-column',{attrs:{\"prop\":\"date\",\"label\":\"类别\",\"width\":\"90\"}}),_c('el-table-column',{attrs:{\"prop\":\"name\",\"label\":\"数量\",\"width\":\"50\"}})],1)],1):_vm._e(),(!_vm.isTaged)?_c('el-row'):_vm._e()],1)])])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TagImage.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TagImage.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./TagImage.vue?vue&type=template&id=1d9daacd&scoped=true&\"\nimport script from \"./TagImage.vue?vue&type=script&lang=js&\"\nexport * from \"./TagImage.vue?vue&type=script&lang=js&\"\nimport style0 from \"./TagImage.vue?vue&type=style&index=0&id=1d9daacd&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1d9daacd\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}